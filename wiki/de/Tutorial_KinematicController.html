<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Tutorial KinematicController/de</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="de">Deutsch</span></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Tutorial_KinematicController.html" lang="en" title="Tutorial KinematicController (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Tutorial_KinematicController.html" lang="fr" title="Assembly3 Tutoriel de contrôleur cinématique (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Tutorial_KinematicController.html" lang="pl" title="Poradnik: Sterownik kinematyczny (100% translated)">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img decoding="async" height="32" src="../File/Freecad.svg" width="32"/></span></span> Tutorial
</td></tr>
<tr>
<th class="ctOdd">Topic
</th></tr>
<tr>
<td class="ctEven">Kinematisteuerung erstellt mit Python
</td></tr>
<tr>
<th class="ctOdd">Level
</th></tr>
<tr>
<td class="ctEven">Pythongrundkentnisse sind hilfreich
</td></tr>
<tr>
<th class="ctOdd">Time to complete
</th></tr>
<tr>
<td class="ctEven">1 Stunde
</td></tr>
<tr>
<th class="ctOdd">Authors
</th></tr>
<tr>
<td class="ctEven"><a href="User;FBXL5.html" title="User:FBXL5">FBXL5</a>
</td></tr>
<tr>
<th class="ctOdd">FreeCAD version
</th></tr>
<tr>
<td class="ctEven">0.20 und später
</td></tr>
<tr>
<th class="ctOdd">Example files
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Einleitung"><span class="tocnumber">1</span> <span class="toctext">Einleitung</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Makroabschnitte"><span class="tocnumber">2</span> <span class="toctext">Makroabschnitte</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Grundstruktur"><span class="tocnumber">2.1</span> <span class="toctext">Grundstruktur</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Randbedingungen_zum_Antreiben_finden"><span class="tocnumber">2.2</span> <span class="toctext">Randbedingungen zum Antreiben finden</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Steuerungsfenster"><span class="tocnumber">2.3</span> <span class="toctext">Steuerungsfenster</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Hauptfenster"><span class="tocnumber">2.3.1</span> <span class="toctext">Hauptfenster</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Parameter_setzen"><span class="tocnumber">2.3.2</span> <span class="toctext">Parameter setzen</span></a>
<ul>
<li class="toclevel-4 tocsection-8"><a href="#Methode_getDriverType()"><span class="tocnumber">2.3.2.1</span> <span class="toctext">Methode getDriverType()</span></a></li>
<li class="toclevel-4 tocsection-9"><a href="#Fenstereigenschaften"><span class="tocnumber">2.3.2.2</span> <span class="toctext">Fenstereigenschaften</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-10"><a href="#Weitere_Parameter_setzen"><span class="tocnumber">2.3.3</span> <span class="toctext">Weitere Parameter setzen</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Label"><span class="tocnumber">2.3.4</span> <span class="toctext">Label</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Schieberegler"><span class="tocnumber">2.3.5</span> <span class="toctext">Schieberegler</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Texteingabefelder"><span class="tocnumber">2.3.6</span> <span class="toctext">Texteingabefelder</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#Bewegung"><span class="tocnumber">2.4</span> <span class="toctext">Bewegung</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Vorwärts-_und_Rückwärts-Schaltflächen"><span class="tocnumber">2.4.1</span> <span class="toctext">Vorwärts- und Rückwärts-Schaltflächen</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Anzahl_der_Schritte"><span class="tocnumber">2.4.2</span> <span class="toctext">Anzahl der Schritte</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Bildfolge"><span class="tocnumber">2.4.3</span> <span class="toctext">Bildfolge</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Ein_paar_Schwachstellen"><span class="tocnumber">3</span> <span class="toctext">Ein paar Schwachstellen</span></a></li>
</ul>
</div>
</td></tr></tbody></table>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Einleitung">Einleitung</span></h2>
<p>Diese Anleitung beschreibt, wie man eine einfache Kinematiksteuerung aus ein paar Zeilen Python-Kode erstellt, die mit Baugruppen des Arbeitsbereiches <a href="Assembly3_Workbench.html" title="Assembly3 Workbench">Assembly3</a> verwendet werden kann.
</p><p>Jeder Texteditor kann zum Erstellen von Kode genutzt werden. Mein Favorit ist Atom, aber FreeCADs eingebauter Editor funktioniert auch bestens.
</p><p>Die folgenden Kode-Beispiele können kopiert, in eine leere Textdatei eingefügt und dann unter einem selbstgewählten Namen als <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">*.py</span> oder *<span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">*.FCMacro</span> abgespeichert werden.
</p><p><span id="Macro_sections"></span>
</p>
<h2><span class="mw-headline" id="Makroabschnitte">Makroabschnitte</span></h2>
<p><span id="Basic_structure"></span>
</p>
<h3><span class="mw-headline" id="Grundstruktur">Grundstruktur</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2022 Your name LGPL</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Die Grundstruktur besteht aus einer Hauptfunktion <code>main()</code> und einer Weiche, an der überprüft wird, ob das Makro als Behälter für Klassen, Methoden usw. verwendet wird oder ob es eigenständig läuft. Nur die zweite Möglichkeit startet die Hauptfunktion <code>main()</code>. Noch ist diese Funktion leer.
</p><p><span id="Find_driving_constraints"></span>
</p>
<h3><span class="mw-headline" id="Randbedingungen_zum_Antreiben_finden">Randbedingungen zum Antreiben finden</span></h3>
<p>Die Randbedingungen zum Antreiben (Antriebe) sind Objekte in einem FreeCAD-Dokument. Sie müssen markiert sein, um gefunden zu werden.
</p><p>Für diese Steuerung muss das Suffix <code>"Driver"</code> an das Label eines Antriebs  angehängt werden. Es kann zur Verdeutlichung mit einem <code>"."</code> oder <code>"-"</code> abgetrennt werden, da nur geprüft wird ob das Label auf <code>"Driver"</code> endet.
</p><p>Eine Funktion, der das Dokumentobjekt übergeben wird und die eine Liste von Antrieben zurück gibt, wird diese Arbeit erledigen.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>
</pre></div>
<p>Die Hauptfunktion <code>main()</code> lädt das aktive Dokument in die Variable <code>kin_doc</code> und ruft im Anschluss die Funktion <code>findTheDrivingConstraints()</code>  (Antriebs-Randbedingungen finden) auf und übergibt den Inhalt von <code>kin_doc</code>. Die zurückgegebene Liste wird in die Variable <code>drivers</code> abgelegt, die dann überprüft wird, ob sie wenigstens ein Element enthält. Wenn das der Fall ist, wird die Liste im <a href="Report_view.html" title="Report view">Ausgabefenster</a> angezeigt.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span>
</pre></div>
<div class="mw-collapsible mw-collapsed">
<p><b>Das Makro bis hierhin...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Anfang</a></p>
<p><span id="Control_panel"></span>
</p>
<h3><span class="mw-headline" id="Steuerungsfenster">Steuerungsfenster</span></h3>
<p>Das Steuerungsfenster ist aus Qt-Widgets (<b>wi</b>ndow ga<b>dgets</b> ~ Fenstergelöt) aufgebaut, einem Hauptfenster und einigen Ein- und Ausgabe-Widgets.
</p><p>Alle Widgets müssen importiert werden, bevor sie verwendet werden können, aber sie können als ein kompletter Satz importiert werden.
</p><p><span id="Main_window"></span>
</p>
<h4><span class="mw-headline" id="Hauptfenster">Hauptfenster</span></h4>
<p>Für das Hauptfenster sieht die Import-Zeile so aus:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">)</span>
</pre></div>
<p>Das Hauptfenster, <code>ControlPanel</code> genannt, ist ein Klassenobjekt, das eine Instanz des <code>QDialog</code>-Widgets ist.
</p><p>Es enthält zwei init-Methoden. <code>__init__()</code> initialisiert das neue Klassenobjekt, verarbeitet eingehende Variablen und startet <code>initUI()</code>, die alle Widgets innerhalb des Hauptfensters verwaltet.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<p>Um ein einzelnes Steuerungsfenster zu starten, wird eine Instanz dieser Klasse namens <code>panel</code> erstellt, mit <code>kin_doc</code> (dem Dokumentobjekt) und <code>drivers[0]</code> (dem ersten Element auf der Liste der Antriebe), die an diese Instanz übergeben wurden. Schließlich öffnet die Methode <code>exec_()</code> der Klasse das Dialogfenster.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">drivers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</pre></div>
<p>Um mehr als eine Antrieb zu verwenden, muss die Liste der Antriebe durchgesehen werden und für jedes Element der Liste eine Instanz erstellt werden, der das jeweilige Element übergeben wird.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
    <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
    <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
<span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</pre></div>
<p>Diese Zeilen ersetzen den Ausgabebefehl <code>print()</code> im else-Abschnitt der Hauptfunktion <code>main()</code>.
</p><p>Hinweis: Das Zusammenstellen einer <code>panel_list</code> (Fensterliste) erlaubt es alle Fenster auf einmal zu starten. (Ich kann dieses Verhalten bisher nicht erklären...)
</p><p>Lässt man das Makro laufen, erstellt es ein sauberes, leeres Dialogfenster, das auf Widgets wartet.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-01.png" title="Ein leeres Dialogfenster"><img alt="Ein leeres Dialogfenster" decoding="async" height="225" src="../File/Tutorial_KinCon-01.png" srcset="/images/thumb/6/62/Tutorial_KinCon-01.png/450px-Tutorial_KinCon-01.png 1.5x, /images/thumb/6/62/Tutorial_KinCon-01.png/600px-Tutorial_KinCon-01.png 2x" width="300"/></a></span>
</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Das Makro bis hierhin...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Anfang</a></p>
<p><span id="Setting_parameters"></span>
</p>
<h4><span class="mw-headline" id="Parameter_setzen">Parameter setzen</span></h4>
<p>Nun ist es Zeit die Methode <code>initUI()</code> zu befüllen:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
<p><code>self.actuator</code> repräsentiert den Antrieb und <code>self.driver_type</code> Speichert ein Schlüsselwort für die Art des Antriebs. Letztere sorgt dafür, dass jeder Randbedingung die richtige Eigenschaft zugeordnet wird.
</p><p><span id="Method_getDriverType()"></span>
</p>
<h5><span id="Methode_getDriverType.28.29"></span><span class="mw-headline" id="Methode_getDriverType()">Methode getDriverType()</span></h5>
<p>Für spätere Verwendung muss die Art des Antriebs ermittelt werden, Winkel, Abstand oder Länge (Angle, Distance, Length), daher muss eine Methode namens <code>getDriverType()</code> (Finde den Antriebstyp) definiert werden.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>
<span class="o">...</span>
</pre></div>
<p>Diese Methode überprüft, ob die Art der gegebenen Randbedingung in einer der Listen zu finden ist, und gibt zurück, welche Art Maß zu steuern ist
</p><p>Es wird angenommen, dass der Antrieb im Kinematikdokument korrekt markiert wurde und funktioniert, wenn er von Hand geändert wird. In diesem Falle ist es nicht nötig geometrische Randbedingungen wie Colinear oder PointsCoincidence herauszufiltern (aber hier wäre die Stelle es zu tun...)
</p><p><span id="Window_properties"></span>
</p>
<h5><span class="mw-headline" id="Fenstereigenschaften">Fenstereigenschaften</span></h5>
<p>Die Fenstergröße wird über seine Größt- und Kleinstmaße festgelegt. Verwendet man jeweils dieselben Werte, wird eine konstante Größe festgelegt
</p><p>Im Titel findet sich der Name des Antriebs und ob es sich um einen Winkel, einen Abstand oder eine Länge handelt. Schließlich wird das Fenster angewiesen über allen anderen Fenstern (sichtbar) zu bleiben.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>
        <span class="c1"># now make the window visible</span>
<span class="o">...</span>
</pre></div>
<p><a href="#top">Anfang</a></p>
<p><span id="Setting_more_parameters"></span>
</p>
<h4><span class="mw-headline" id="Weitere_Parameter_setzen">Weitere Parameter setzen</span></h4>
<p>Im nächsten Schritt wird der Wert des Antriebs ausgelesen und die Start- und Endwerte abhängig von der Antriebsart gesetzt.
</p><p>Ein Abstand kann nicht negativ sein und exakt null verwirrt den Gleichungslöser, daher wird der Startwert auf 0,001 gesetzt. Winkel akzeptieren negative Werte und erhalten symmetrische Werte. (Ob Längen negative Werte akzeptieren, muss noch abschließend festgestellt werden...)
</p><p>Die Einheiten müssen gespeichert werden, bis die Werte am Ende an die Eigenschaften der Randbedingungen zurückgegeben werden. Abstände und Längen benötigen Werte mit Einheiten.
</p><p>Der Umgang mit Einheiten und die Darstellung der Werte als Zeichenketten in einigen Widgets erfordert es häufig Zahlen in Zeichenketten und wieder zurück zu verwandeln.
</p><p>Um die Parameter zu vervollständigen, wird ein Wert für die Anzahl von Schritten vorgegeben, die berechnet werden solle, wenn die Bewegung automatisch erfolgt; und wenn der Umschalter <code>self.sequence</code> auf <code>True</code> gesetzt ist, wird bei jedem Schritt der Bewegung ein Bild aufgenommen.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p><a href="#top">Anfang</a></p>
<p><span id="Labels"></span>
</p>
<h4><span class="mw-headline" id="Label">Label</span></h4>
<p>Nun werden drei Label(-Widgets) hizugefügt, um Start-, End-, sowie den aktuellen Wert anzuzeigen
</p><p>Zuerst muss die Klasse <code>QLabel</code> importiert werden, d. h. die Import-Liste muss, wie hier gezeigt wird, ergänzt werden:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">)</span>
</pre></div>
<p>Zurück in der Methode <code>initUI()</code> fügt man folgendes ein:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="o">...</span>
</pre></div>
<p>Die Platzierung erfolgt mit der ererbten Methode  <code>setGeometry()</code>. In diesem Falle wird die Beschreibung eines Rechtecks verwendet (X-Position, Y-Position, Breite, Höhe)
</p><p>Die ersten und dritten Zeilen könnten zusammengefasst werden, wird aber aus Gründen der Übersichtlichkeit nicht empfohlen.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>
<p>Startet man das Makro aus einem Kinematikdokument heraus, erhält man ein Dialogfenster wie dieses:
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-02.png" title="Ein Dialogfenster, das den Startwert, den aktuellen Wert und den Endwert anzeigt"><img alt="Ein Dialogfenster, das den Startwert, den aktuellen Wert und den Endwert anzeigt" decoding="async" height="225" src="../File/Tutorial_KinCon-02.png" srcset="/images/thumb/d/dd/Tutorial_KinCon-02.png/450px-Tutorial_KinCon-02.png 1.5x, /images/thumb/d/dd/Tutorial_KinCon-02.png/600px-Tutorial_KinCon-02.png 2x" width="300"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Das Dialogfenster zeigt in der Titelleiste das Label der Randbedingung und die Art des Antriebs an, sowie den Startwert, den aktuellen Wert und den Endwert in der ersten Zeile des Hauptbereiches</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Das Makro bis hierhin...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Anfang</a></p>
<p><span id="Slider"></span>
</p>
<h4><span class="mw-headline" id="Schieberegler">Schieberegler</span></h4>
<p>Um den aktuellen Wert auf jede mögliche Zahl zwischen Start- und Endwert einzustellen, würde ein Schieberegler passen.
</p><p>Zuerst muss die Klasse <code>QSlider</code> importiert werden, d. h. die Import-Liste muss, wie hier gezeigt wird, ergänzt werden:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">)</span>
</pre></div>
<p>Zurück in der Methode <code>initUI()</code> fügt man folgendes direkt nach dem Labels-Abschnitt ein:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Der Schieberknopf wird mit der Methode <code>setValue()</code> platziert. Sein Wert muss aus dem aktuellen Wert und dem Schrittverhältnis berechnet werden. Das Schrittverhältnis muss immer berechnet werden, wenn sich der Start- oder Endwert ändert, daher wird eine weitere Methode hinter der Methode <code>getDriverType()</code> eingefügt.
</p><p>Ein Verhältnis zu verwenden anstatt die Kleinst- und Größtwerte des Schiebereglers zu verändern, hat den Vorteil einer feineren Auflösung für kleinere Werte.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>
<span class="o">...</span>
</pre></div>
<p>Und nach diesem kommt eine weitere Methode, die festlegt, was zu tun ist, wenn sich die Position des Schiebers bzw. der Wert des Schiebereglers ändert. Die Methode <code>onActuatorSlider()</code> wird von der Methode <code>connect()</code> aufgerufen, die auch den Wert des Schhiebereglers als Variable übergibt.
</p><p>Sie berechnet den aktuellen Wert erneut aus der Schieberposition, überschreibt den Text des Labels <code>self.label_current</code> und ändert die Eigenschaft der Randbedingung unter Beachtung der Art des Antriebs.
</p><p>Wird der Befehl <code>"asm3CmdQuickSolve"</code> gestartet, beginnt der Gleichnungslöser die Bestandteile der Baugruppe dem geänderten Wert entsprechend neu anzuordnen.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Das Dialogfenster mit dem Schieberegler sollte so aussehen und ist jetzt bereit eine Bewegung zu steuern.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-03.png" title="Zwei Dialogfenster mit Schieberegler"><img alt="Zwei Dialogfenster mit Schieberegler" decoding="async" height="225" src="../File/Tutorial_KinCon-03.png" srcset="/images/thumb/5/58/Tutorial_KinCon-03.png/450px-Tutorial_KinCon-03.png 1.5x, /images/thumb/5/58/Tutorial_KinCon-03.png/600px-Tutorial_KinCon-03.png 2x" width="300"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Dialogfenster mit dem hinzugefügten Schieberegler, eins für einen Winkelantrieb (Drehantrieb) und eins für einen (Abstands-/) Linearantrieb</p>
<p>Es kann ein Dialogfenster für jedes geöffnete Dokument gestartet werden; sie beeinflussen sich nicht gegenseitig.
</p>
<p><a href="#top">Anfang</a></p>
<p><span id="Text_entry_fields"></span>
</p>
<h4><span class="mw-headline" id="Texteingabefelder">Texteingabefelder</span></h4>
<p>Um Start- und Endwerte zu ändern kann man ein Line-Edit-Widget verwenden.
</p><p>Zuerst muss die Klasse <code>QLineEdit</code> importiert werden, d. h. die Import-Liste muss, wie hier gezeigt wird, ergänzt werden:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">)</span>
</pre></div>
<p>Zurück in der Methode <code>initUI()</code> fügt man folgendes zwischen Labels- und Slider-Abschnitt ein:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Die Eingabefelder zeigen die voreingestellten Start- und Endwerte an. Sie sind aber erst komplett, wenn auch Methoden hinzugefügt werden, die die geänderten Werte verarbeiten. Das erledigen die Methoden  <code>self.onEntryStart()</code> und <code>self.onEntryEnd()</code>, die zwischen den Methoden <code>self.stepRatio()</code> und <code>self.onActuatorSlider()</code> eingefügt werden.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Beide wandeln die erhaltene Zeichenkette in eine Fließkommazahl und ändern den  Startwert <code>self.start_value</code> bzw. Endwert <code>self.end_value</code> und das dazugehörige Label. Danach wird der Schieber aktualisiert.
</p><p>Das Dialogfenster mit den Texteingabefeldern sollte so aussehen und ist jetzt bereit den Bereich einer Bewegung zu ändern:
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-04.png" title="Zwei Dialogfenster mit Texteingabefeldern"><img alt="Zwei Dialogfenster mit Texteingabefeldern" decoding="async" height="225" src="../File/Tutorial_KinCon-04.png" srcset="/images/thumb/6/68/Tutorial_KinCon-04.png/450px-Tutorial_KinCon-04.png 1.5x, /images/thumb/6/68/Tutorial_KinCon-04.png/600px-Tutorial_KinCon-04.png 2x" width="300"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Dialogfenster mit Texteingabefeldern, nochmals für Drehantrieb und Linearantrieb</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Das Makro bis hierhin...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># create some input elements</span>

        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>

        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">slider_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Anfang</a></p>
<p><span id="Motion"></span>
</p>
<h3><span class="mw-headline" id="Bewegung">Bewegung</span></h3>
<p>um einen Zusammenbau in Bewegung zu setzen benötigt man:
</p>
<ul><li>Schaltflächen, die eine Bewegung in die gewünschte Richtung auslösen.</li>
<li>Ein Eingabefeld, um die Anzahl der schritte zu verändern, für schnellere oder fließendere Bewegungen.</li>
<li>Ein Optionsfeld (Checkbox), um das Erstellen einer Bildfolge zu aktivieren.</li></ul>
<p><span id="Forward_and_Backward_buttons"></span>
</p>
<h4><span id="Vorw.C3.A4rts-_und_R.C3.BCckw.C3.A4rts-Schaltfl.C3.A4chen"></span><span class="mw-headline" id="Vorwärts-_und_Rückwärts-Schaltflächen">Vorwärts- und Rückwärts-Schaltflächen</span></h4>
<p>Damit sich die Bauteile automatisch bewegen, werden zwei Schaltflächen benötigt, die die Bewegungen auslösen, eine in Richtung der Startposition und eine in Richtung der Endposition. Diese beiden und eine zum Schließen verwenden das Widget <code>QPushButton</code>.
</p><p>Kleinere Baugruppen werde etwas zu schnell berechnet und zeigen eher Sprünge anstatt einer fließenden Bewegung. Um sie zu verlangsamen wird die Methode <code>sleep()</code> des Moduls <code>time</code> verwendet, das zuerst importiert werden muss.
</p><p>Ein weiterer Import und ein weiteres Widget:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">)</span>
</pre></div>
<p>Zurück in der Methode <code>initUI()</code> fügt man folgendes nach dem Slider-Abschnitt ein:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># forward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&gt;-&gt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onForward</span><span class="p">)</span>
        <span class="c1"># backward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&lt;-&lt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onBackward</span><span class="p">)</span>
        <span class="c1"># close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"Close window"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Die Methoden, die gedrückte Schaltflächen bearbeiten sind <code>self.onForward()</code>, <code>self.onBackward()</code>, und <code>self.onClose()</code>. Sie werden nach der Methode <code>onActuatorSlider()</code> eingefügt.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onBackward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Closed"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
<p>Die Methode <code>self.onClose()</code> ruft die ererbte Methode <code>self.close()</code> auf, die nur das Dialogfenster schließt und damit das Makro beendet.
</p><p>Beide Methoden <code>self.onForward()</code> und <code>self.onBackward()</code> zählen die verbleibenden Schritte, die noch zu gehen sind, bis man die gewünschte Position erreicht und berechnen die Schrittlänge entsprechend der Anzahl der Schritte. Zu diesem Zeitpunkt wird die voreingestellte Anzahl von zehn Schritten beibehalten.
</p><p>Jede Runde in der While-Schleife erhöht/verringert den aktuellen Wert und aktualisiert den Schieber, wodurch im Hintergrund <code>onActuatorSlider()</code> ausgelöst wird (siehe Absatz <a href="#Schieberegler">Schieberegler</a>).
</p><p>Wenn keine Schritte mehr übrig sind, wird der Schieber auf die erste bzw. letzte Position gesetzt, nur für den Fall, dass Rundungsfehler aufgetreten sind.
</p><p>Das Dialogfenster mit den Schalflächen sollte so aussehen und kann jetzt einen Zusammenbau mit 10 Schritten auf die gewünschte Position bewegen:
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-05.png" title="Dialogfenster mit Schaltflächen"><img alt="Dialogfenster mit Schaltflächen" decoding="async" height="225" src="../File/Tutorial_KinCon-05.png" srcset="/images/thumb/e/e0/Tutorial_KinCon-05.png/450px-Tutorial_KinCon-05.png 1.5x, /images/thumb/e/e0/Tutorial_KinCon-05.png/600px-Tutorial_KinCon-05.png 2x" width="300"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Dialogfenster mit Schaltflächen</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Das Makro bis hierhin...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># create some input elements</span>

        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>

        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>

        <span class="c1"># forward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&gt;-&gt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onForward</span><span class="p">)</span>
        <span class="c1"># backward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&lt;-&lt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onBackward</span><span class="p">)</span>
        <span class="c1"># close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"Close window"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span> <span class="c1"># screen update between steps</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onBackward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Closed"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Anfang</a></p>
<p><span id="Number_of_steps"></span>
</p>
<h4><span class="mw-headline" id="Anzahl_der_Schritte">Anzahl der Schritte</span></h4>
<p>Die Voreinstellung ist so gewählt, dass man einen schnellen Eindruck erhält, ob sich der Zusammenbau wie erwartet bewegt, ohne zu viel Rechenzeit zu verbrauchen.
</p><p>Wenn die Bauteile eher springen als sich fließend zu bewegen, oder wenn winkelbasierte Antriebe Problemen bereiten, wenn der Unterschied zwischen zwei Winkeln zu groß ist, dann  kann beides durch das Erhöhen der Anzahl der Schritte behoben werden.
</p><p>Und ein weiteres Line-Edit-Widget wird verwendet, um die Anzahl der Schritte zu ändern (eingesetzt hinter den schon vorhandenen Line-Edit-Widgets):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># text input field - number of steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntrySteps</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Die zugehörige Methode <code>self.onEntrySteps()</code> füllt nur den Parameter <code>self.step_value</code> mit dem eingegebenen Wert. Sie wird nach der Methode <code>onEntryEnd()</code> eingefügt.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onEntrySteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_steps</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_steps</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Das Dialogfenster, das in der Lage ist, die Anzahl der Schritte zu ändern sollte so aussehen:
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-06.png" title="Dialogfenster mit einem weiteren Texteingabefeld"><img alt="Dialogfenster mit einem weiteren Texteingabefeld" decoding="async" height="225" src="../File/Tutorial_KinCon-06.png" srcset="/images/thumb/4/40/Tutorial_KinCon-06.png/450px-Tutorial_KinCon-06.png 1.5x, /images/thumb/4/40/Tutorial_KinCon-06.png/600px-Tutorial_KinCon-06.png 2x" width="300"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Dialogfenster mit einem weiteren Texteingabefeld</p>
<p><a href="#top">Anfang</a></p>
<p><span id="Image_sequence"></span>
</p>
<h4><span class="mw-headline" id="Bildfolge">Bildfolge</span></h4>
<p>Sobald die Bewegung der Bauteile den Erwartungen entspricht, kann bei jedem Schritt ein Bild aufgenommen werden. Aus der entstandenen Bildfolge kann eine kurze GIF-Animation erstellt werden.
</p><p>Um diese Funktionalität einzubauen, wird das Widget <code>QCheckBox</code> und ein Verzeichnis zum Speichern der Bilder gebraucht.
</p><p>Ein weiterer Import und ein weiteres Widget:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">)</span>
</pre></div>
<p>Zurück in der Methode <code>initUI()</code> fügt man folgendes nach dem Slider-Abschnitt ein:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># output check box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Check to record an image sequence"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"checkBoxOutput"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOutputClicked</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Die Methode <code>onOutputClicked()</code> synchronisiert den Parameter <code>self.sequence</code> und die Anzeige des Aktivierungshäkchens.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onOutputClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Um die Ausgabeparameter festzulegen wird die Methode <code>output()</code> verwendet:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="s2">".../FreeCAD/ScreenShots/Sequence"</span>
            <span class="n">file_tag</span> <span class="o">=</span> <span class="s2">".png"</span>
            <span class="n">height</span> <span class="o">=</span> <span class="mi">640</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mi">480</span>
            <span class="n">background</span> <span class="o">=</span> <span class="s2">"Transparent"</span>
            <span class="c1"># dealing with leading zeros</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">999</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Out of Range"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"00"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"0"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="c1"># Screen shot</span>
            <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">image_path</span> <span class="o">+</span> <span class="n">number</span> <span class="o">+</span> <span class="n">file_tag</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Zuerst muss der Pfad zu den Bilddateien an das eigene Betriebssystem angepasst werden; der letzte Teil des Bildnamens bleibt ohne Zählnummer und Dateianhang. Dies muss zur Zeit von Hand gemacht werden.
</p><p>Dann folgt der Dateianhang, um den Bildnamen abzuschließen, Bildhöhe und -Breite sowie eine Angabe, wie der Bildhintergrund gefüllt werden soll (<code>"Current"</code> (aktueller Hintergrund der 3D-Ansicht), <code>"White"</code> (weiß), <code>"Black"</code> (schwarz), oder <code>"Transparent"</code>).
</p><p>Damit immer eine dreistellige Zahl verwendet wird, müssen führende Nullen vor der Zählvariable eingefügt werden.
</p><p>Am Ende wird die Skriptvariante des Befehls <span typeof="mw:File"><a class="mw-file-description" href="../File/Std_ViewScreenShot.svg"><img decoding="async" height="24" src="../File/Std_ViewScreenShot.svg" width="24"/></a></span> <a href="Std_ViewScreenShot.html" title="Std ViewScreenShot/de">Std AnsichtAufnehmen</a> verwendet, um mit Hilfe der genannten Parameter ein Bild aufzunehmen.
</p><p>Es werden noch keine Bilder aufgenommen!?! Kein Problem, da diese Methode noch nicht aufgerufen wird, und daher muss noch ein Aufruf in die While-Schleife von <code>onForward()</code> und <code>onBackward()</code> eingefügt werden. Direkt nach <code>time.sleep(0.2)</code> wird diese Zeile eingefügt:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">steps_left</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Jetzt sollte das Makro bereit sein, einen (kinematischen) Zusammenbau zu steuern und Bilder für ein animiertes GIF-Billd aufzunehmen.
</p><p>Die endgültige Version des Dialogfensters:
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Tutorial_KinCon-07.png" title="Fertiges Dialogfenster"><img alt="Fertiges Dialogfenster" decoding="async" height="225" src="../File/Tutorial_KinCon-07.png" srcset="/images/thumb/8/88/Tutorial_KinCon-07.png/450px-Tutorial_KinCon-07.png 1.5x, /images/thumb/8/88/Tutorial_KinCon-07.png/600px-Tutorial_KinCon-07.png 2x" width="300"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Fertiges Dialogfenster</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Und schließlich das ganze Makro</b>
</p>
<div class="mw-collapsible-content">
<p><b>Nicht vergessen den Pfad in der Ausgabemethode output() anzugeben!</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" °"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># create some input elements</span>

        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>

        <span class="c1"># text input field - number of steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntrySteps</span><span class="p">)</span>

        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>

        <span class="c1"># output check box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Check to record an image sequence"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"checkBoxOutput"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOutputClicked</span><span class="p">)</span>

        <span class="c1"># forward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&gt;-&gt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onForward</span><span class="p">)</span>
        <span class="c1"># backward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&lt;-&lt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onBackward</span><span class="p">)</span>
        <span class="c1"># close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"Close window"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntrySteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_steps</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_steps</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span> <span class="c1"># screen update between steps</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">steps_left</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onBackward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">steps_left</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Closed"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">onOutputClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="s2">".../FreeCAD/ScreenShots/Sequence"</span>
            <span class="n">file_tag</span> <span class="o">=</span> <span class="s2">".png"</span>
            <span class="n">height</span> <span class="o">=</span> <span class="mi">640</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mi">480</span>
            <span class="n">background</span> <span class="o">=</span> <span class="s2">"Transparent"</span>
            <span class="c1"># dealing with leading zeros</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">999</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Out of Range"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"00"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"0"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="c1"># Screen shot</span>
            <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">image_path</span> <span class="o">+</span> <span class="n">number</span> <span class="o">+</span> <span class="n">file_tag</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Anfang</a></p>
<p><span id="Some_imperfections"></span>
</p>
<h2><span class="mw-headline" id="Ein_paar_Schwachstellen">Ein paar Schwachstellen</span></h2>
<ul><li>Die Numerierung der Bildfolge ist umgekehrt, da die Variable steps_left (verbleibende Schritte) heruntergezählt wird.</li>
<li>Das Bildverzeichnis und der Name des Bildes sind im Makro hinterlegt (hard-coded).</li>
<li>Mehrfach geöffnete Steuerungsfenster sind nicht synchronisiert.</li></ul>
<!-- 
NewPP limit report
Cached time: 20241129213220
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.271 seconds
Real time usage: 0.344 seconds
Preprocessor visited node count: 1188/1000000
Post‐expand include size: 8476/2097152 bytes
Template argument size: 47278/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 37/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 221981/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   42.241      1 -total
 47.83%   20.202     37 Template:Code
 11.74%    4.960     75 Template:Incode
  4.91%    2.073     10 Template:Top
  3.90%    1.647      6 Template:Caption
  3.80%    1.605      1 Template:TutorialInfo
  2.32%    0.982      2 Template:FileName
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:287778-0!canonical and timestamp 20241129213220 and revision id 1396652. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
