<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Create a FeaturePython object part II/de</span></h1><?xml encoding="UTF-8"><div class="mw-parser-output"><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--high" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Create_a_FeaturePython_object_part_II.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Create a FeaturePython object part II (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--complete" title="Cr&eacute;er un objet FeaturePython partie II (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--stub" title="Creare un Box FeaturePython, Parte II (8% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--complete" title="Tworzenie obiekt&oacute;w FeaturePython - cz&#281;&#347;&#263; II (100% translated)" lang="pl" dir="ltr">polski</a></li>
<li><a href="../ru/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--low" title="Create a FeaturePython object part II/ru (24% translated)" lang="ru" dir="ltr">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a></li></ul></div>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
    <div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-left.svg" decoding="async" width="16" height="16"></span></span> <a href="../de/Create_a_FeaturePython_object_part_I.html" title="Create a FeaturePython object part I/de">Ein FeaturePython-Objekt erstellen, Teil I</a></div>
    <div style="margin: 4px 0; float: right;"><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="16" height="16"></span></span></div>
    <div style="text-align:center"><a href="../de/Online_Help_Toc.html" title="Online Help Toc/de">Index</a> <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Online_Help_Toc.svg" decoding="async" width="24" height="24"></span></span></div>
</div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Einf%C3%BChrung"><span class="tocnumber">1</span> <span class="toctext">Einf&uuml;hrung</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Hinzuf%C3%BCgen_eines_Kastens"><span class="tocnumber">2</span> <span class="toctext">Hinzuf&uuml;gen eines Kastens</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Festlegen_des_Codes"><span class="tocnumber">3</span> <span class="toctext">Festlegen des Codes</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Writing_a_ViewProvider"><span class="tocnumber">4</span> <span class="toctext">Writing a ViewProvider</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Ereignisfallen"><span class="tocnumber">5</span> <span class="toctext">Ereignisfallen</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Vollst%C3%A4ndiger_Code"><span class="tocnumber">6</span> <span class="toctext">Vollst&auml;ndiger Code</span></a></li>
</ul>
</div>
</div>
<p><span id="Introduction"></span>
</p>
<h2><span id="Einf.C3.BChrung"></span><span class="mw-headline" id="Einf&uuml;hrung">Einf&uuml;hrung</span></h2>
<p>Auf der Seite <a href="../de/Create_a_FeaturePython_object_part_I.html" title="Create a FeaturePython object part I/de">Erstellen eines FeaturePython-Objekts Teil I</a> haben wir uns auf die internen Aspekte einer Python-Klasse konzentriert, die um ein FeaturePython-Objekt herum aufgebaut ist, insbesondere um ein <code>App::FeaturePython</code>-Objekt. Wir haben das Objekt erstellt, einige Eigenschaften definiert und einen Ereignisr&uuml;ckruf auf Dokumentebene hinzugef&uuml;gt, der es unserem Objekt erm&ouml;glicht, auf eine Dokumentneuberechnung mit der Methode <code>execute()</code> zu reagieren. Unser Objekt ist jedoch noch immer nicht in der <a href="../de/3D_view.html" title="3D view/de">3D-Ansicht</a> vorhanden. Beheben wir das, indem wir eine Box hinzuf&uuml;gen.
</p><p><span id="Adding_a_box"></span>
</p>
<h2><span id="Hinzuf.C3.BCgen_eines_Kastens"></span><span class="mw-headline" id="Hinzuf&uuml;gen_eines_Kastens">Hinzuf&uuml;gen eines Kastens</span></h2>
<p>F&uuml;ge zun&auml;chst oben in der Datei <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> unterhalb des vorhandenen Imports Folgendes hinzu:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
</pre></div>
<p>L&ouml;sche dann in <code>execute()</code> die Anweisung <code>print()</code> und f&uuml;ge an ihrer Stelle die folgende Zeile hinzu:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">))</span>
</pre></div>
<figure class="mw-default-size mw-halign-right" typeof="mw:File"><a href="../File/App_featurepython_box.png" class="mw-file-description"><img src="../File/App_featurepython_box.png" decoding="async" width="205" height="180"></a><figcaption></figcaption></figure>
<p>Diese Befehle f&uuml;hren Python-Methoden aus, die standardm&auml;&szlig;ig mit FreeCAD mitgeliefert werden:
</p>
<ul><li>Die Methode <code>Part.makeBox()</code> erzeugt eine Kastenform.</li>
<li>Der umschlie&szlig;ende Aufruf von <code>Part.show()</code> f&uuml;gt die Form dem Dokument hinzu und macht sie sichtbar.</li></ul>
<p>L&ouml;sche alle vorhandenen Objekte, lade das Box-Modul neu und erstelle mit <code>box.create()</code> ein neues Box-Objekt. Beachte, dass sofort eine Box auf dem Bildschirm erscheint. Das liegt daran, dass wir das Dokument am Ende von <code>box.create()</code> zu einer Neuberechnung zwingen, was wiederum die Methode <code>execute()</code> unserer Klasse <code>box</code> ausl&ouml;st.
</p><p>Auf den ersten Blick sieht das Ergebnis vielleicht gut aus, aber es gibt einige Probleme. Das offensichtlichste ist, dass die Box durch ein v&ouml;llig anderes Objekt als unser FeaturePython-Objekt dargestellt wird. <code>Part.show()</code> erstellt einfach ein separates Box-Objekt und f&uuml;gt es dem Dokument hinzu. Schlimmer noch: Wenn du die Abmessungen des FeaturePython-Objekts &auml;nderst, wird eine andere Box-Form erstellt und die alte bleibt an Ort und Stelle. Und wenn du die <a href="../Report_view.html" title="Report view">Berichtsansicht</a> ge&ouml;ffnet hast, ist dir m&ouml;glicherweise ein Fehler mit der Meldung &bdquo;Rekursiver Aufruf von Neuberechnung f&uuml;r Dokument Unbenannt&ldquo; aufgefallen. Dies hat mit der Verwendung der <code>Part.show()</code>-Methode innerhalb eines FeaturePython-Objekts zu tun.
</p>
<div style="clear:both"></div>
<p><a href="#top">Anfang</a>
</p><p><span id="Fixing_the_code"></span>
</p>
<h2><span class="mw-headline" id="Festlegen_des_Codes">Festlegen des Codes</span></h2>
<p>Um diese Probleme zu l&ouml;sen, m&uuml;ssen wir eine Reihe von &Auml;nderungen vornehmen. Bisher haben wir ein <code>App::FeaturePython</code>-Objekt verwendet, das eigentlich nicht f&uuml;r eine visuelle Darstellung in der 3D-Ansicht vorgesehen ist. Stattdessen m&uuml;ssen wir ein <code>Part::FeaturePython</code>-Objekt verwenden. &Auml;ndere in <code>create()</code> die folgende Zeile:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'App::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
</pre></div>
<p>in:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Part::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
</pre></div>
<p>Um das separate Box-Objekt loszuwerden, m&uuml;ssen wir das Ergebnis der Methode <code>makeBox()</code> der Eigenschaft <code>Shape</code> unseres Objekts <code>Part::FeaturePython</code> zuweisen. &Auml;nderne diese Zeile in <code>execute()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">))</span>
</pre></div>
<p>in:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>
</pre></div>
<figure class="mw-default-size mw-halign-right" typeof="mw:File"><a href="../File/Part_featurepython_no_vp.png" class="mw-file-description"><img src="../File/Part_featurepython_no_vp.png" decoding="async" width="201" height="156"></a><figcaption></figcaption></figure>
<p>Save your changes, switch back to FreeCAD, delete any existing objects, reload the box module, and create a new box object. The new result is somewhat disappointing. There no longer is an extra object in the Tree view, and the icon in the Tree view has changed, but our box in the 3D view is also gone (which is why the icon is gray). What happened? Although we've properly created our box shape and assigned it to a <code>Part::FeaturePython</code> object, to make it actually show up in the 3D view we need to assign a <a href="../Viewprovider.html" title="Viewprovider">ViewProvider</a>.
</p>
<div style="clear:both"></div>
<p><a href="#top">Anfang</a>
</p>
<h2><span class="mw-headline" id="Writing_a_ViewProvider">Writing a ViewProvider</span></h2>
<p>A View Provider is the component of an object which allows it to have a visual representation in the 3D view. FreeCAD uses an application structure which is designed to separate the data (the "model") from it's visual representation (the "view"). If you've spent any time working with FreeCAD in Python, you are likely already aware of this through the use of the two core Python modules: <code>FreeCAD</code> and <code>FreeCADGui</code> (often aliased as <code>App</code> and <code>Gui</code> repectively).
</p><p>Our FeaturePython object also requires these elements. Thus far we've focused purely on the "model" portion of the code, now it's time to write the "view" portion. Fortunately most ViewProviders are simple and require little effort to write, at least to get started. Here's an example ViewProvider borrowed and slightly modified from <a rel="nofollow" class="external autonumber" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/Mod/TemplatePyMod/FeaturePython.py">[1]</a>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ViewProviderBox</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set this object to the proxy object of the actual view provider</span>
<span class="sd">        """</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Setup the scene sub-graph of the view provider, this method is mandatory</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If a property of the handled feature has changed we have the chance to handle this here</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return a list of display modes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the name of the default display mode. It must be defined in getDisplayModes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="s2">"Shaded"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Map the display mode defined in attach with those defined in getDisplayModes.</span>
<span class="sd">        Since they have the same names nothing needs to be done.</span>
<span class="sd">        This method is optional.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Print the name of the property that has changed</span>
<span class="sd">        """</span>

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the icon in XMP format which will appear in the tree view. This method is optional and if not defined a default icon is shown.</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "    c None",</span>
<span class="s2">            ".   c #141010",</span>
<span class="s2">            "+   c #615BD2",</span>
<span class="s2">            "@   c #C39D55",</span>
<span class="s2">            "#   c #000000",</span>
<span class="s2">            "$   c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Called during document saving.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Called during document restore.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p>In the code above, we define an XMP icon for this object. Icon design is beyond the scope of this tutorial, but basic design can be managed using open source tools like <a rel="nofollow" class="external text" href="https://www.gimp.org">GIMP</a>, <a rel="nofollow" class="external text" href="https://krita.org/en/">Krita</a>, and <a rel="nofollow" class="external text" href="https://inkscape.org/">Inkscape</a>. The <code>getIcon()</code> method is optional, FreeCAD will use a default icon if this method is not provided.
</p><p>Add the ViewProvider code at the end of <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> and in the <code>create()</code> method insert the following line above the <code>recompute()</code> statement:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">ViewProviderBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
</pre></div>
<p>This instances the custom ViewProvider class and passes the FeaturePython's built-in ViewObject to it. When the ViewProvider class initializes, it saves a reference to itself in the FeaturePython's <code>ViewObject.Proxy</code> attribute. This way, when FreeCAD needs to render our box visually, it can find the ViewProvider class to do that.
</p><p>Now, save the changes and return to FreeCAD. Import or reload the box module and call <code>box.create()</code>. You should now see two things:
</p>
<ul><li>The icon for the box object has changed.</li>
<li>And, more importantly, there is a box in the 3D view. If you do not see it press the <span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;"><span typeof="mw:File"><a href="../File/Std_ViewFitAll.svg" class="mw-file-description"><img src="../File/Std_ViewFitAll.svg" decoding="async" width="16" height="16"></a></span> <a href="../Std_ViewFitAll.html" title="Std ViewFitAll">Std ViewFitAll</a></span> button. You can even alter the dimensions of the box by changing the values in the <a href="../Property_editor.html" title="Property editor">Property editor</a>. Give it a try!</li></ul>
<p><a href="#top">Anfang</a>
</p><p><span id="Trapping_events"></span>
</p>
<h2><span class="mw-headline" id="Ereignisfallen">Ereignisfallen</span></h2>
<p>We have already discussed event trapping. Nearly every method of a FeaturePython class serves as a callback accessible to the FeaturePython object (which gets access to our class instance through the <code>Proxy</code> attribute).
</p><p>Below is a list of the callbacks that may be implemented in the basic FeaturePython object:
</p>
<table class="wikitable" cellpadding="5px" width="100%">
<caption>FeaturePython basic callbacks
</caption>
<tbody><tr>
<td style="width:25%"><code>execute(self, obj)</code>
</td>
<td style="width:25%">Called during document recomputes
</td>
<td style="width:50%">Do not call <code>recompute()</code> from this method (or any method called from <code>execute()</code>) as this causes a nested recompute.
</td></tr>
<tr>
<td><code>onBeforeChange(self, obj, prop)</code>
</td>
<td>Called before a property value is changed
</td>
<td><code>prop</code> is the name of the property to be changed, not the property object itself. Property changes cannot be cancelled.  Previous / next property values are not simultaneously available for comparison.
</td></tr>
<tr>
<td><code>onChanged(self, obj, prop)</code>
</td>
<td>Called after a property is changed
</td>
<td><code>prop</code> is the name of the property to be changed, not the property object itself.
</td></tr>
<tr>
<td><code>onDocumentRestored(self, obj)</code>
</td>
<td>Called after a document is restored or a FeaturePython object is copied.
</td>
<td>Occasionally, references to the FeaturePython object from the class, or the class from the FeaturePython object may be broken, as the class <code>__init__()</code> method is not called when the object is reconstructed. Adding <code>self.Object = obj</code> or <code>obj.Proxy = self</code> often solves these issues.
</td></tr></tbody></table>
<p>For a complete reference of FeaturePython methods available, see <a href="../FeaturePython_methods.html" title="FeaturePython methods">FeaturePython methods</a>.
</p><p>In addition, there are two callbacks in the ViewProvider class that may occasionally prove useful:
</p>
<table class="wikitable" cellpadding="5px" width="100%">
<caption>ViewProvider basic callbacks
</caption>
<tbody><tr>
<td style="width:25%"><code>updateData(self, obj, prop)</code>
</td>
<td style="width:25%">Called after a data (model) property is changed
</td>
<td style="width:50%"><code>obj</code> is a reference to the FeaturePython class instance, not the ViewProvider instance.  <code>prop</code> is the name of the property to be changed, not the property object itself.
</td></tr>
<tr>
<td><code>onChanged(self, vobj, prop)</code>
</td>
<td>Called after a view property is changed
</td>
<td><code>vobj</code> is a reference to the ViewProvider instance.  <code>prop</code> is the name of the view property which was changed.
</td></tr></tbody></table>
<p>It is not uncommon to encounter a situation where the Python callbacks are not being triggered as they should. Beginners in this area can rest assured that the FeaturePython callback system is not fragile or broken. Invariably when callbacks fail to run it is because a reference is lost or undefined in the underlying code. If, however, callbacks appear to be breaking with no explanation, providing object/proxy references in the <code>onDocumentRestored()</code> callback (as noted in the first table above) may alleviate these problems. Until you are comfortable with the callback system, it may be useful to add print statements in each callback to print messages to the console during development.
</p><p><a href="#top">Anfang</a>
</p><p><span id="Complete_code"></span>
</p>
<h2><span id="Vollst.C3.A4ndiger_Code"></span><span class="mw-headline" id="Vollst&auml;ndiger_Code">Vollst&auml;ndiger Code</span></h2>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>
<span class="kn">import</span> <span class="nn">Part</span>

<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">obj_name</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Object creation method</span>
<span class="sd">    """</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Part::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>

    <span class="n">box</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="n">ViewProviderBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>

    <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">obj</span>

<span class="k">class</span> <span class="nc">box</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Default constructor</span>
<span class="sd">        """</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">'box'</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyString'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">,</span> <span class="s1">'Base'</span><span class="p">,</span> <span class="s1">'Box description'</span><span class="p">)</span><span class="o">.</span><span class="n">Description</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box length'</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Width'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box width'</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="s1">'10 mm'</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box height'</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="s1">'1 cm'</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Called on document recompute</span>
<span class="sd">        """</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderBox</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set this object to the proxy object of the actual view provider</span>
<span class="sd">        """</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Setup the scene sub-graph of the view provider, this method is mandatory</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If a property of the handled feature has changed we have the chance to handle this here</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return a list of display modes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the name of the default display mode. It must be defined in getDisplayModes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="s2">"Shaded"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Map the display mode defined in attach with those defined in getDisplayModes.</span>
<span class="sd">        Since they have the same names nothing needs to be done.</span>
<span class="sd">        This method is optional.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Print the name of the property that has changed</span>
<span class="sd">        """</span>

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the icon in XMP format which will appear in the tree view. This method is optional and if not defined a default icon is shown.</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "    c None",</span>
<span class="s2">            ".   c #141010",</span>
<span class="s2">            "+   c #615BD2",</span>
<span class="s2">            "@   c #C39D55",</span>
<span class="s2">            "#   c #000000",</span>
<span class="s2">            "$   c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Called during document saving.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Called during document restore.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p><a href="#top">Anfang</a>
</p>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
    <div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-left.svg" decoding="async" width="16" height="16"></span></span> <a href="../de/Create_a_FeaturePython_object_part_I.html" title="Create a FeaturePython object part I/de">Ein FeaturePython-Objekt erstellen, Teil I</a></div>
    <div style="margin: 4px 0; float: right;"><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="16" height="16"></span></span></div>
    <div style="text-align:center"><a href="../de/Online_Help_Toc.html" title="Online Help Toc/de">Index</a> <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Online_Help_Toc.svg" decoding="async" width="24" height="24"></span></span></div>
</div>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
    <div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><span typeof="mw:File"><a href="../File/Power_user_hub.png" class="mw-file-description"><img src="../File/Power_user_hub.png" decoding="async" width="24" height="24"></a></span> <a href="../de/Power_users_hub.html" title="Power users hub/de">Power user documentation</a>
        <div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>FreeCAD scripting:</b> <a href="../de/Python.html" title="Python/de">Python</a>, <a href="../de/Introduction_to_Python.html" title="Introduction to Python/de">Introduction to Python</a>, <a href="../de/Python_scripting_tutorial.html" title="Python scripting tutorial/de">Python scripting tutorial</a>, <a href="../de/FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/de">FreeCAD Scripting Basics</a></li></ul>
<hr>
<ul><li><b>Modules:</b> <a href="../de/Builtin_modules.html" title="Builtin modules/de">Builtin modules</a>, <a href="../de/Units.html" title="Units/de">Units</a>, <a href="../de/Quantity.html" title="Quantity/de">Quantity</a></li>
<li><b>Workbenches:</b> <a href="../de/Workbench_creation.html" title="Workbench creation/de">Workbench creation</a>, <a href="../de/Gui_Command.html" title="Gui Command/de">Gui Commands</a>, <a href="../de/Command.html" title="Command/de">Commands</a>, <a href="../de/Installing_more_workbenches.html" title="Installing more workbenches/de">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="../de/Mesh_Scripting.html" title="Mesh Scripting/de">Mesh Scripting</a>, <a href="../de/Topological_data_scripting.html" title="Topological data scripting/de">Topological data scripting</a>, <a href="../de/Mesh_to_Part.html" title="Mesh to Part/de">Mesh to Part</a>, <a href="../de/PythonOCC.html" title="PythonOCC/de">PythonOCC</a></li></ul>
<hr>
<ul><li><b>Parametric objects:</b> <a href="../de/Scripted_objects.html" title="Scripted objects/de">Scripted objects</a>, <a href="../de/Viewprovider.html" title="Viewprovider/de">Viewproviders</a> <small>(<a href="../de/Custom_icon_in_tree_view.html" title="Custom icon in tree view/de">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../de/Scenegraph.html" title="Scenegraph/de">Coin (Inventor) scenegraph</a>, <a href="../de/Pivy.html" title="Pivy/de">Pivy</a></li>
<li><b>Graphical interface:</b> <a href="../de/Interface_creation.html" title="Interface creation/de">Interface creation</a>, <a href="../de/Dialog_creation.html" title="Dialog creation/de">Interface creation completely in Python</a> <small>(<a href="../de/Dialog_creation_with_various_widgets.html" title="Dialog creation with various widgets/de">1</a>, <a href="../de/Dialog_creation_reading_and_writing_files.html" title="Dialog creation reading and writing files/de">2</a>, <a href="../de/Dialog_creation_setting_colors.html" title="Dialog creation setting colors/de">3</a>, <a href="../de/Dialog_creation_image_and_animated_GIF.html" title="Dialog creation image and animated GIF/de">4</a>, <a href="../de/PySide_usage_snippets.html" title="PySide usage snippets/de">5</a>)</small>, <a href="../de/PySide.html" title="PySide/de">PySide</a>, PySide examples <a href="../de/PySide_Beginner_Examples.html" title="PySide Beginner Examples/de">beginner</a>, <a href="../de/PySide_Intermediate_Examples.html" title="PySide Intermediate Examples/de">intermediate</a>, <a href="../de/PySide_Advanced_Examples.html" title="PySide Advanced Examples/de">advanced</a></li>
<li><b>Macros:</b> <a href="../de/Macros.html" title="Macros/de">Macros</a>, <a href="../de/How_to_install_macros.html" title="How to install macros/de">How to install macros</a></li>
<li><b>Embedding:</b> <a href="../de/Embedding_FreeCAD.html" title="Embedding FreeCAD/de">Embedding FreeCAD</a>, <a href="../de/Embedding_FreeCADGui.html" title="Embedding FreeCADGui/de">Embedding FreeCADGui</a></li></ul>
<hr>
<ul><li><b>Other:</b> <a href="../de/Expressions.html" title="Expressions/de">Expressions</a>, <a href="../de/Code_snippets.html" title="Code snippets/de">Code snippets</a>, <a href="../de/Line_drawing_function.html" title="Line drawing function/de">Line drawing function</a>, <a href="../de/FreeCAD_vector_math_library.html" title="FreeCAD vector math library/de">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr>
<ul><li><b>Hubs:</b> <a href="../de/User_hub.html" title="User hub/de">User hub</a>, <a href="../de/Power_users_hub.html" title="Power users hub/de">Power users hub</a>, <a href="../de/Developer_hub.html" title="Developer hub/de">Developer hub</a></li></ul></div>
    </div></div>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241225161931
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc, no&#8208;toc&#8208;conversion]
CPU time usage: 0.071 seconds
Real time usage: 0.094 seconds
Preprocessor visited node count: 595/1000000
Post&#8208;expand include size: 10514/2097152 bytes
Template argument size: 9523/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 9/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 24110/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   19.791      1 -total
 21.17%    4.190      2 Template:Docnav/de
 17.61%    3.486      9 Template:Code
 12.81%    2.535      1 Template:Powerdocnavi/de
 11.77%    2.330     48 Template:Incode
  6.50%    1.286      1 Template:Navigation_menu_2
  5.82%    1.152      1 Template:TOCright
  5.02%    0.993      2 Template:FileName
  3.43%    0.679      1 Template:Button
  3.07%    0.607      3 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:210163-0!canonical and timestamp 20241225161931 and revision id 1523611. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>