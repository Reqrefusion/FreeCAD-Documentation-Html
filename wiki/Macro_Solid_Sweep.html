<link href="site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro Solid Sweep</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="de\Macro_Solid_Sweep.html" lang="de" title="Makro Solid Sweep (100% translated)">Deutsch</a></li>
<li><span class="mw-pt-languages-ui mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="en">English</span></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="es\Macro_Solid_Sweep.html" lang="es" title="Macro Solid Sweep (82% translated)">español</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="fr\Macro_Solid_Sweep.html" lang="fr" title="Macro Solid Sweep (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="it\Macro_Solid_Sweep.html" lang="it" title="Macro Solid Sweep (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="pl\Macro_Solid_Sweep.html" lang="pl" title="Makrodefinicja: Solid Sweep (9% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="cs\Macro_Solid_Sweep.html" lang="cs" title="Makro Těleso vlečením profilu (82% translated)">čeština</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="File/Macro_Solid_Sweep.png"><img decoding="async" height="32" src="File/Macro_Solid_Sweep.png" width="32"/></a></span><span> </span>
Solid Sweep
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Creates a solid by sweeping a profile from a trajectory.<br/><br/>Macro version: 1.0<br/>Last modified: 2011-12-03<br/>FreeCAD version: All<br/>Download: <a class="external text" href="https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png" rel="nofollow">ToolBar Icon</a><br/>Author: Normandc<br/>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="User;Normandc.html" title="User:Normandc">Normandc</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png" rel="nofollow">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes">Macros recipes</a><br/><a href="How_to_install_macros.html" title="How to install macros">How to install macros</a><br/><a href="Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2011-12-03
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Supported_2D_elements"><span class="tocnumber">3</span> <span class="toctext">Supported 2D elements</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Tips"><span class="tocnumber">4</span> <span class="toctext">Tips</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Script"><span class="tocnumber">5</span> <span class="toctext">Script</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Credits"><span class="tocnumber">6</span> <span class="toctext">Credits</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>This macro creates a solid by sweeping a 2D profile along a trajectory previously selected in the 3D view. The 2D elements can be created through the regular tools in FreeCAD's GUI.
</p><p>It should be noted that the resulting solid will <b>not</b> be parametric. If you decide to change your profile or trajectory, you'll need to run the macro again.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="File/Solid_sweep.png" title="A few examples of sweeping all using the same oblong section and three kinds of trajectory."><img alt="A few examples of sweeping all using the same oblong section and three kinds of trajectory." decoding="async" height="331" src="File/Solid_sweep.png" width="500"/></a></span>
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<ol><li>Create two 2D elements, one for the section and one for the trajectory, of the types listed below.</li>
<li>Select, either in the <a href="Tree_view.html" title="Tree view">Tree view</a> or in the <a href="3D_view.html" title="3D view">3D view</a> (<b>The order is important!</b>):
<ol><li>The trajectory</li>
<li>Then the profile</li></ol></li>
<li>Open the <a href="Macros.html" title="Macros">Macro manager</a></li>
<li>Select the <b>Solid Sweep</b> macro</li>
<li>Click <span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;">Execute</span></li></ol>
<p><b>Result:</b> A <b>Sweep</b> object will be created in the Project tree.
</p>
<h2><span class="mw-headline" id="Supported_2D_elements">Supported 2D elements</span></h2>
<ul><li>Wires</li>
<li><span typeof="mw:File"><a class="mw-file-description" href="File/Sketcher_NewSketch.svg"><img decoding="async" height="24" src="File/Sketcher_NewSketch.svg" width="24"/></a></span> <a href="Sketcher_Workbench.html" title="Sketcher Workbench">Sketches</a></li>
<li><span typeof="mw:File"><a class="mw-file-description" href="File/Draft_BSpline.svg"><img decoding="async" height="24" src="File/Draft_BSpline.svg" width="24"/></a></span> <a href="Draft_BSpline.html" title="Draft BSpline">Draft BSpline</a></li>
<li>2D primitives from the <i>Part → <span typeof="mw:File"><a class="mw-file-description" href="File/Part_Primitives.svg"><img decoding="async" height="24" src="File/Part_Primitives.svg" width="24"/></a></span> <a href="Part_Primitives.html" title="Part Primitives">Create Primitives</a> ...</i> menu (circle, helix)</li></ul>
<h2><span class="mw-headline" id="Tips">Tips</span></h2>
<ul><li>The section has to be a closed profile or the result will not be a solid.</li>
<li>The section does not need to be located on the trajectory, but it's preferable that it be normal (perpendicular) to the trajectory.</li>
<li>The trajectory can either be an open or closed profile (circle, or line and arc segments) but all elements need to be tangent or the resulting shape will be unexpected. For example, a trajectory with straight corners like a rectangle will not produce a solid.</li>
<li>If the solid gets twisted, edit the macro to change the <i>isFrenet</i> value to 0 (zero) and try again.</li>
<li>Setting the <i>makeSolid</i> variable to 0 (zero) in the macro will produce a set of surfaces with open ends.</li></ul>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="File/Macro_Solid_Sweep.png"><img decoding="async" height="64" src="File/Macro_Solid_Sweep.png" width="64"/></a></span>
</p><p><b>Macro_Solid_Sweep.FCMacro</b>
</p>
<pre>import Part, FreeCAD, math, PartGui, FreeCADGui
from FreeCAD import Base

# get the selected objects, with first selection for the trajectory and second for the section
s = FreeCADGui.Selection.getSelection()
try:
     shape1=s[0].Shape
     shape2=s[1].Shape
except:
     print "Wrong selection"

traj = Part.Wire([shape1])
section = Part.Wire([shape2])

# create Part objec in the current document
myObject=App.ActiveDocument.addObject("Part::Feature","Sweep")

# variable makeSolid = 1 to create solid, 0 to create surfaces
makeSolid = True #1
isFrenet = True #1

# create a 3D shape and assigh it to the current document
Sweep = Part.Wire(traj).makePipeShell([section],makeSolid,isFrenet)
myObject.Shape = Sweep</pre>
<p><br/>
</p>
<h2><span class="mw-headline" id="Credits">Credits</span></h2>
<p>Thanks to <a href="User;Wmayer.html" title="User:Wmayer">Wmayer</a> for his help in writing this script.
</p><p>Two examples of uses can be found in <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=8&amp;t=1222&amp;start=50#p11120" rel="nofollow">this forum topic</a>, along with download links to the FCStd files. Using a helix as trajectory, a solid sweep can be used to create a bolt thread.
</p>
<!-- 
NewPP limit report
Cached time: 20241214202841
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.078 seconds
Real time usage: 0.130 seconds
Preprocessor visited node count: 117/1000000
Post‐expand include size: 2211/2097152 bytes
Template argument size: 1151/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2037/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   10.953      1 -total
 49.38%    5.409      1 Template:MacroCode
 31.63%    3.465      1 Template:Macro
 17.13%    1.876      1 Template:Button
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:1850-0!canonical and timestamp 20241214202841 and revision id 794521. Rendering was triggered because: api-parse
 -->
</div></div><script src="script.js"></script>
