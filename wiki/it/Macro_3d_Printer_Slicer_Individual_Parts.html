<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro 3d Printer Slicer Individual Parts/it</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_3d_Printer_Slicer_Individual_Parts.html" lang="en" title="Macro 3d Printer Slicer Individual Parts (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_3d_Printer_Slicer_Individual_Parts.html" lang="fr" title="Macro 3d Printer Slicer Individual Parts (100% translated)">français</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="it">italiano</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Macro_3d_Printer_Slicer_Individual_Parts.html" lang="pl" title="Makrodefinicja: Druk 3d krajalnica, poszczególne części (14% translated)">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg"><img decoding="async" height="32" src="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg" width="32"/></a></span><span> </span>
Macro 3d Printer Slicer Individual Parts
</p>
</td></tr>
<tr>
<th class="ctOdd">Descrizione
</th></tr>
<tr>
<td class="ctEven left macro-description">Esporta in un software di slicing per stampanti 3D basato su una macro simile di cae2100. Esporta un singolo file STL per ogni parte visibile nella stessa directory del file di disegno originale, quindi lo apre nel software di slicing. <br/> Questo codice, una volta eseguito, esporterà il disegno attualmente aperto in diversi file STL, denominati in base alle etichette delle parti e aprirlo nel software di slicing che utilizzi. La macro sta cercando <i> '<a class="external text" href="http://wiki.ultimaker.com/Cura" rel="nofollow">Cura</a>' </i> nel percorso ma è possibile aggiungere qualsiasi altra suddivisione modificando la stringa nella macro.<br/><br/>Versione macro: 1.1<br/>Ultima modifica: 2020-10-30<br/>Versione FreeCAD: All<br/>Download: <a class="external text" href="https://wiki.freecadweb.org/images/3/3d/Macro_3d_Printer_Slicer_Individual_Parts.svg" rel="nofollow">ToolBar Icon</a><br/>Autore: WayofWood<br/>
</td></tr>
<tr>
<th class="ctOdd">Autore
</th></tr>
<tr>
<td class="ctEven macro-author"><a class="new" href="index.php?title=User;WayofWood&amp;action=edit&amp;redlink=1.html" title="User:WayofWood (page does not exist)">WayofWood</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://wiki.freecadweb.org/images/3/3d/Macro_3d_Printer_Slicer_Individual_Parts.svg" rel="nofollow">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Link
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes/it">Raccolta di macro</a><br/><a href="How_to_install_macros.html" title="How to install macros/it">Come installare le macro</a><br/><a href="Customize_Toolbars.html" title="Customize Toolbars/it">Personalizzare la  toolbar</a>
</td></tr>
<tr>
<th class="ctOdd">Versione macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.1
</td></tr>
<tr>
<th class="ctOdd">Data ultima modifica
</th></tr>
<tr>
<td class="ctEven macro-date">2020-10-30
</td></tr>
<tr>
<th class="ctOdd">Versioni di FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Scorciatoia
</th></tr>
<tr>
<td class="ctEven"><i>Nessuna</i>
</td></tr>
<tr>
<th class="ctOdd">Vedere anche
</th></tr>
<tr>
<td class="ctEven"><a href="Macro_3d_Printer_Slicer.html" title="Macro 3d Printer Slicer/it">Macro 3d Printer Slicer</a> <span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_3d_Printer_Slicer.png"><img decoding="async" height="24" src="../File/Macro_3d_Printer_Slicer.png" srcset="/images/thumb/9/96/Macro_3d_Printer_Slicer.png/36px-Macro_3d_Printer_Slicer.png 1.5x, /images/thumb/9/96/Macro_3d_Printer_Slicer.png/48px-Macro_3d_Printer_Slicer.png 2x" width="24"/></a></span>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Descrizione"><span class="tocnumber">1</span> <span class="toctext">Descrizione</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Script"><span class="tocnumber">2</span> <span class="toctext">Script</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Crediti"><span class="tocnumber">3</span> <span class="toctext">Crediti</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<p><br/>
</p>
<h2><span class="mw-headline" id="Descrizione">Descrizione</span></h2>
<p>Questo codice, quando viene eseguito, esporterà i corpi visibili al livello superiore (i corpi più in profondità nell'albero verranno ignorati) del progetto attualmente aperto in singoli file STL e li aprirà nel software di slicing che usi. Questa macro cercherà <b><a class="external text" href="http://wiki.ultimaker.com/Cura" rel="nofollow">Cura</a></b> come impostazione predefinita, ma puoi cambiarla con qualsiasi altro cursore modificando la variabile SLICERAPP nel codice sorgente. 
</p><p>Viene utilizzato al meglio creando un collegamento alla macro sulla barra degli strumenti e quando sei pronto per tagliare l'oggetto, fai clic su di esso e gli oggetti, come appaiono sullo schermo in FreeCAD, appariranno sull'interfaccia del tuo software di taglio, pronti per tagliare . Creerà anche diversi file STL con lo stesso nome file del file di disegno e l'etichetta della parte nella stessa directory del file di disegno.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Screenshot_Cura_Example.png"><img decoding="async" height="349" src="../File/Screenshot_Cura_Example.png" srcset="/images/thumb/e/ee/Screenshot_Cura_Example.png/720px-Screenshot_Cura_Example.png 1.5x, /images/thumb/e/ee/Screenshot_Cura_Example.png/960px-Screenshot_Cura_Example.png 2x" width="480"/></a></span>
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>La variabile SLICERAPP può essere modificata in qualsiasi software di slicing di tua scelta. Se un oggetto specifico non viene esportato, potrebbe essere necessario aggiungere il rispettivo tipo all'array doexport.
</p><p>ToolBar Icon <span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg"><img decoding="async" height="64" src="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg" width="64"/></a></span>
</p><p><b>Macro_3d_Printer_Slicer_Individual_Parts.py</b>
</p>
<pre>import FreeCAD
import Mesh
import sys
import math
import os
import subprocess

SLICERAPP= "cura"		 			# Put your Slicer program here

# some fuctions
def getPlacement(quat,vect,obj):
  if quat[3] &gt; -1  and quat[3] &lt; 1:
    delta = math.acos(quat[3])*2.0
    scale = math.sin(delta/2)
    rx = quat[0]/scale
    ry = quat[1]/scale
    rz = quat[2]/scale
  else:
    delta = 0
    rx = 0
    ry = 0
    rz = 1
  info0 = "translation "+str(vect.x)+" "+str(vect.y)+" "+str(vect.z)
  info1 = "rotation "+str(rx)+" "+str(ry)+" "+str(rz)+" "+str(delta)
  return info0+" "+info1
# some definitions
placement = App.Placement(App.Vector(0,0,0),App.Rotation(0,0,0,1))
# user need to set this directory where slicing software is located
OutDir = FreeCAD.ActiveDocument.FileName.replace(".FCStd", "--")
visible_objs = []
# Get Objects in document
doc = App.ActiveDocument
objs = doc.Objects
stlFile = ""
stlFiles = [ SLICERAPP ]
# hide all
for obj in objs:
   print(obj.Label + "//" + obj.TypeId)
   print(len(obj.InList))
   if obj.ViewObject.isVisible() and hasattr(obj, 'Shape') and (len(obj.InList) &lt;= 1):
      visible_objs.append(obj)
for obj in visible_objs:
  stlFile = OutDir+str(obj.Label)+".stl"
  Mesh.export([obj],stlFile)
  stlFiles.append(stlFile)
  print ("Exporting " + stlFile + "\n")
print ("Calling subprocess: " + str(stlFiles)+"\n")
subprocess.Popen(stlFiles)</pre>
<h2><span class="mw-headline" id="Crediti">Crediti</span></h2>
<p>Grazie a cae2100 per aver sviluppato il codice macro originale - <a href="Macro_3d_Printer_Slicer.html" title="Macro 3d Printer Slicer/it">also available here</a>.<br/> 
Thanks to <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686" rel="nofollow">Wmayer</a> for his help in writing this script.<br/>
Original forum topic: <a class="external free" href="http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686" rel="nofollow">http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686</a>
</p>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241129212451
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.046 seconds
Real time usage: 0.066 seconds
Preprocessor visited node count: 95/1000000
Post‐expand include size: 2802/2097152 bytes
Template argument size: 2579/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2332/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.744      1 -total
 45.97%    2.181      1 Template:Macro/it
 30.63%    1.453      1 Template:MacroCode
 17.88%    0.848      1 Template:Clear
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:222041-0!canonical and timestamp 20241129212451 and revision id 800562. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
