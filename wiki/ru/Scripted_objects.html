<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Scripted objects/ru</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="id" title="Scripted objects (1% translated)">Bahasa Indonesia</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Scripted_objects.html" lang="de" title="Skriptgenerierte Objekte (83% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Scripted_objects.html" lang="en" title="Scripted objects (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="tr" title="Scripted objects (1% translated)">Türkçe</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="es" title="Scripted objects (5% translated)">español</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Scripted_objects.html" lang="fr" title="Objets créés par script (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Scripted_objects.html" lang="it" title="Oggetti creati da script (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Scripted_objects.html" lang="pl" title="Obiekty tworzone skryptami (100% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="pt" title="Scripted objects (1% translated)">português</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="pt-BR" title="Objetos com Script (3% translated)">português do Brasil</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="ro" title="Obiecte create prin script-programare (8% translated)">română</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="fi" title="Scripted objects (1% translated)">suomi</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="sv" title="Scripted objects (5% translated)">svenska</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="cs" title="Skriptované objekty (5% translated)">čeština</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" dir="ltr" lang="ru">русский</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Scripted_objects.html" lang="zh-Hans-CN" title="脚本化物体 (4% translated)">中文（中国大陆）</a></li></ul></div>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
<div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Arrow-left.svg" width="16"/></span></span> <a href="Topological_data_scripting.html" title="Topological data scripting/ru">Программирование топологических данных</a></div>
<div style="margin: 4px 0; float: right;"><a href="Scenegraph.html" title="Scenegraph/ru">Граф сцены</a>
<span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Arrow-right.svg" width="16"/></span></span></div>
<div style="text-align:center"><a href="Online_Help_Toc.html" title="Online Help Toc/ru">Оглавление</a> <span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="24" src="../File/Online_Help_Toc.svg" width="24"/></span></span></div>
</div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Введение"><span class="tocnumber">1</span> <span class="toctext">Введение</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Простой_пример"><span class="tocnumber">2</span> <span class="toctext">Простой пример</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Что_необходимо_отметить"><span class="tocnumber">2.1</span> <span class="toctext">Что необходимо отметить</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Другой_более_сложный_пример"><span class="tocnumber">3</span> <span class="toctext">Другой более сложный пример</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Создание_выделяемых_объектов"><span class="tocnumber">4</span> <span class="toctext">Создание выделяемых объектов</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Работа_с_простыми_формами"><span class="tocnumber">5</span> <span class="toctext">Работа с простыми формами</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Структура_графа_сцены"><span class="tocnumber">6</span> <span class="toctext">Структура графа сцены</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Программируемый_объект_Part_Design"><span class="tocnumber">7</span> <span class="toctext">Программируемый объект Part Design</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Available_object_types"><span class="tocnumber">8</span> <span class="toctext">Available object types</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Доступные_методы"><span class="tocnumber">9</span> <span class="toctext">Доступные методы</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Доступные_свойства"><span class="tocnumber">10</span> <span class="toctext">Доступные свойства</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Property_attributes"><span class="tocnumber">10.1</span> <span class="toctext">Property attributes</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Available_extensions"><span class="tocnumber">11</span> <span class="toctext">Available extensions</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Дополнительная_информация"><span class="tocnumber">12</span> <span class="toctext">Дополнительная информация</span></a></li>
</ul>
</div>
</div>
<p><span id="Introduction"></span>
</p>
<h2><span id=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Введение">Введение</span></h2>
<p>Кроме стандартных типов объектов, таких как аннотации, полигональные сетки и детали, FreeCAD также предлагает удивительную возможность создавать параметрические объекты, 100% написанные на Python, такие объекты называются (<a href="App_FeaturePython.html" title="App FeaturePython/ru">Python Features</a>). Они ведут себя точно так же, как любой другой объект FreeCAD, автоматически сохраняются и восстанавливаются при сохранении или загрузке файла.
</p>
<div class="mw-translate-fuzzy">
<p>Должна быть понята одна особенность, эти объекты сохраняются в файлах FreeCAD FcStd вместе с модулем  pythonа <a class="external text" href="https://docs.python.org/3/library/json.html" rel="nofollow">json</a>. Этот модуль превращает объект pythonа в строку, позволяя его добавление в сохраняемый файл. При загрузке, модуль json использует эту строку для пересоздания оригинального объекта, обеспечивает его доступ к исходному коду, создавшему объект. Это значит, что если Вы сохранили этот пользовательский объект и открыли его на машине, где код python, который сгенерировал объект, отсутствует, объект не может быть восстановлен. Если Вы распространяете эти объекты среди других друзей, Вам нужно передавать вместе с ними скрипт pythonа, который его создал.
</p>
</div>
<p><b>Примечание</b>: Имеется возможность упаковки python кода внутрь FreeCAD файла, используя json сериализацию с помощью App::PropertyPythonObject, но этот код в конечном счете нельзя будет запустить напрямую, поэтому это мало подходит для наших целей.
</p><p><a href="App_FeaturePython.html" title="App FeaturePython/ru">Python Features</a> следуют тому же правилу что и все остальные FreeCAD features: они разделены на App и GUI части. App часть, Объект Документ (Document Object), определяет геометрию нашего объекта, тогда как его GUI часть, Объект Визуального Представления (View Provider Object) определяет, как объект будет отображаться на экране. Объект View Provider, как и любая другая FreeCAD feature, доступен только при запуске FreeCAD в его собственном графическом интерфейсе.  Существует несколько свойств и методов, доступных для создания вашего объекта. Свойства должны принадлежать к любому из предопределенных типов свойств, предлагаемых FreeCAD, и отображаться в окне просмотра свойств, чтобы пользователь мог их редактировать. Таким образом, объекты Feature Python полностью параметричны. Вы можете задать свойства как Данных, так и свойства Вида.
</p><p><span id="Basic_example"></span>
</p>
<h2><span id=".D0.9F.D1.80.D0.BE.D1.81.D1.82.D0.BE.D0.B9_.D0.BF.D1.80.D0.B8.D0.BC.D0.B5.D1.80"></span><span class="mw-headline" id="Простой_пример">Простой пример</span></h2>
<p>Следующий пример можно найти в файле <a class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/Mod/TemplatePyMod/FeaturePython.py" rel="nofollow">src/Mod/TemplatePyMod/FeaturePython.py</a> вместе с несколькими другими примерами:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="sd">'''Examples for a feature class and its view provider.'''</span>

<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="k">class</span> <span class="nc">Box</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Add some custom properties to our box feature'''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Length"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Length of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Width"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Width of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Height"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Height of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''Do something when a property has changed'''</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">'''Do something when doing a recomputation, this method is mandatory'''</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Recompute Python Box feature</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderBox</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Set this object to the proxy object of the actual view provider'''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyColor"</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Color of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Setup the scene sub-graph of the view provider, this method is mandatory'''</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoScale</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>

        <span class="n">data</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoCube</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="p">,</span> <span class="s2">"Shaded"</span><span class="p">);</span>
        <span class="n">style</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="p">()</span>
        <span class="n">style</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="o">.</span><span class="n">LINES</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="p">,</span> <span class="s2">"Wireframe"</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onChanged</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''If a property of the handled feature has changed we have the chance to handle this here'''</span>
        <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Length"</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Width"</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Height"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">scaleFactor</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Return a list of display modes.'''</span>
        <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Shaded"</span><span class="p">)</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Wireframe"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">modes</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the name of the default display mode. It must be defined in getDisplayModes.'''</span>
        <span class="k">return</span> <span class="s2">"Shaded"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="sd">'''Map the display mode defined in attach with those defined in getDisplayModes.\</span>
<span class="sd">                Since they have the same names nothing needs to be done. This method is optional'''</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''Here we can do something when a single property got changed'''</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"Color"</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">vp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Color"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the icon in XPM format which will appear in the tree view. This method is\</span>
<span class="sd">                optional and if not defined a default icon is shown.'''</span>
        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "   c None",</span>
<span class="s2">            ".  c #141010",</span>
<span class="s2">            "+  c #615BD2",</span>
<span class="s2">            "@  c #C39D55",</span>
<span class="s2">            "#  c #000000",</span>
<span class="s2">            "$  c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''When saving the document this object gets stored using Python's json module.\</span>
<span class="sd">                Since we have some un-serializable parts here -- the Coin stuff -- we must define this method\</span>
<span class="sd">                to return a tuple of all serializable objects or None.'''</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">'''When restoring the serialized object from document we have the chance to set some internals here.\</span>
<span class="sd">                Since no data were serialized nothing needs to be done here.'''</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">makeBox</span><span class="p">():</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">)</span>
    <span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ViewProviderBox</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>

<span class="n">makeBox</span><span class="p">()</span>
</pre></div>
<p><span id="Things_to_note"></span>
</p>
<h3><span id=".D0.A7.D1.82.D0.BE_.D0.BD.D0.B5.D0.BE.D0.B1.D1.85.D0.BE.D0.B4.D0.B8.D0.BC.D0.BE_.D0.BE.D1.82.D0.BC.D0.B5.D1.82.D0.B8.D1.82.D1.8C"></span><span class="mw-headline" id="Что_необходимо_отметить">Что необходимо отметить</span></h3>
<p>Если Ваш объект полагается на то, что будет пересчитан во время создания, Вы должны сделать это вручную в функции <code>__init__</code>, поскольку пересчёт не вызывается автоматически. Этот пример не требует этого поскольку метод <code>onChanged</code> класса <code>Box</code> имеет тот же эффект, что и функция <code>execute</code>, но пример ниже полагается на то, что будет пересчитан перед тем как будет показан в окне трёхмерного просмотра. В этих примерах это делается вручную с помощью <code>ActiveDocument.recompute()</code>, но в более сложных сценариях Вы должны решить, где пересчитать либо весь документ, или объект FeaturePython.
</p><p>Этот пример создаёт несколько исключений трасс стека в окне отчётов. Это поскольку метод  <code>onChanged</code> класса <code>Box</code> вызывается каждый раз как свойство добавляется в <code>__init__</code>. Когда первое было добавлено, параметры Width и Height и потому попытки доступа к ним безуспешны.
</p>
<div class="mw-translate-fuzzy">
<p>Описание <code>__getstate__</code> и <code>__setstate__</code> находится в теме форума <a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=18&amp;t=44009&amp;start=10#p377892" rel="nofollow">obj.Proxy.Type is a dict, not a string</a>.
</p>
</div>
<p><code>obj.addProperty(...)</code> returns <code>obj</code>, so that the value of the property can be set on the same line:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Length"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Length of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
<p>Which is equivalent to:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Length"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Length of the box"</span><span class="p">)</span>
<span class="n">obj</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
<p><span id="Other_more_complex_example"></span>
</p>
<h2><span id=".D0.94.D1.80.D1.83.D0.B3.D0.BE.D0.B9_.D0.B1.D0.BE.D0.BB.D0.B5.D0.B5_.D1.81.D0.BB.D0.BE.D0.B6.D0.BD.D1.8B.D0.B9_.D0.BF.D1.80.D0.B8.D0.BC.D0.B5.D1.80"></span><span class="mw-headline" id="Другой_более_сложный_пример">Другой более сложный пример</span></h2>
<p>Данный пример использует <a href="Part_Workbench.html" title="Part Workbench/ru">верстак Part</a> для создания октаэдра, затем создает собственное Coin представление с помощью Pivy.
</p><p>Сначала сам Документированный Объект:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span><span class="o">,</span> <span class="nn">Part</span>
<span class="kn">import</span> <span class="nn">pivy</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="k">class</span> <span class="nc">Octahedron</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Add some custom properties to our box feature"</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Length"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span><span class="s2">"Length of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span><span class="o">=</span><span class="mf">1.0</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Width"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span><span class="s2">"Width of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span><span class="o">=</span><span class="mf">1.0</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Height"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span> <span class="s2">"Height of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span><span class="o">=</span><span class="mf">1.0</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"Part::PropertyPartShape"</span><span class="p">,</span><span class="s2">"Shape"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span> <span class="s2">"Shape of the octahedron"</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
     <span class="c1"># Define six vetices for the shape</span>
     <span class="n">v1</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v2</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v3</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v4</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v5</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
     <span class="n">v6</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

     <span class="c1"># Make the wires/faces</span>
     <span class="n">f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v4</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">f7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="n">v4</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">f8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">shell</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeShell</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span><span class="p">,</span><span class="n">f5</span><span class="p">,</span><span class="n">f6</span><span class="p">,</span><span class="n">f7</span><span class="p">,</span><span class="n">f8</span><span class="p">])</span>
     <span class="n">solid</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeSolid</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
     <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">solid</span>

  <span class="c1"># helper mehod to create the faces</span>
  <span class="k">def</span> <span class="nf">make_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">):</span>
     <span class="n">wire</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makePolygon</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v1</span><span class="p">])</span>
     <span class="n">face</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Face</span><span class="p">(</span><span class="n">wire</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">face</span>
</pre></div>
<p>Теперь , мы обладаем визуальным представлением объекта, ответственного за отображение объекта в 3D сцене:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ViewProviderOctahedron</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Set this object to the proxy object of the actual view provider"</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyColor"</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span><span class="s2">"Color of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Color</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Setup the scene sub-graph of the view provider, this method is mandatory"</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoScale</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>

     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoIndexedFaceSet</span><span class="p">()</span>

     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="p">,</span><span class="s2">"Shaded"</span><span class="p">);</span>
     <span class="n">style</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="p">()</span>
     <span class="n">style</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="o">.</span><span class="n">LINES</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="p">,</span><span class="s2">"Wireframe"</span><span class="p">);</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">onChanged</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
     <span class="s2">"If a property of the handled feature has changed we have the chance to handle this here"</span>
     <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
     <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"Shape"</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Shape"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setNum</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
           <span class="n">cnt</span><span class="o">=</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Return a list of display modes."</span>
     <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
     <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Shaded"</span><span class="p">)</span>
     <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Wireframe"</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">modes</span>

  <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="s2">"Return the name of the default display mode. It must be defined in getDisplayModes."</span>
     <span class="k">return</span> <span class="s2">"Shaded"</span>

  <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
     <span class="k">return</span> <span class="n">mode</span>

  <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
     <span class="s2">"Here we can do something when a single property got changed"</span>
     <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
     <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"Color"</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">vp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Color"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">        /* XPM */</span>
<span class="s2">        static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">        "16 16 6 1",</span>
<span class="s2">        "    c None",</span>
<span class="s2">        ".   c #141010",</span>
<span class="s2">        "+   c #615BD2",</span>
<span class="s2">        "@   c #C39D55",</span>
<span class="s2">        "#   c #000000",</span>
<span class="s2">        "$   c #57C355",</span>
<span class="s2">        "        ........",</span>
<span class="s2">        "   ......++..+..",</span>
<span class="s2">        "   .@@@@.++..++.",</span>
<span class="s2">        "   .@@@@.++..++.",</span>
<span class="s2">        "   .@@  .++++++.",</span>
<span class="s2">        "  ..@@  .++..++.",</span>
<span class="s2">        "###@@@@ .++..++.",</span>
<span class="s2">        "##$.@@$#.++++++.",</span>
<span class="s2">        "#$#$.$$$........",</span>
<span class="s2">        "#$$#######      ",</span>
<span class="s2">        "#$$#$$$$$#      ",</span>
<span class="s2">        "#$$#$$$$$#      ",</span>
<span class="s2">        "#$$#$$$$$#      ",</span>
<span class="s2">        " #$#$$$$$#      ",</span>
<span class="s2">        "  ##$$$$$#      ",</span>
<span class="s2">        "   #######      "};</span>
<span class="s2">        """</span>

  <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">return</span> <span class="kc">None</span>

  <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
     <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p>Наконец, когда определен наш объект и его визуальный объект, нам просто нужно вызвать их:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">)</span>
<span class="n">Octahedron</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">ViewProviderOctahedron</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
</pre></div>
<p><span id="Making_objects_selectable"></span>
</p>
<h2><span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B2.D1.8B.D0.B4.D0.B5.D0.BB.D1.8F.D0.B5.D0.BC.D1.8B.D1.85_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Создание_выделяемых_объектов">Создание выделяемых объектов</span></h2>
<p>Если вы хотите чтобы ваш объект можно было выбрать, или по крайней мере его часть, щелкнув по нему в окне, вы должны включить его Coin геометрию внутрь узла SoFCSelection. Если ваш объект обладает сложным представлением, с виджетами, аннотациями, и т.д, вам может потребоваться только часть его в SoFCSelection. Всё, что находится в SoFCSelection постоянно сканируется FreeCAD для обнаружения выделения/предварительного отбора, так что имеет смысл попробовать не перегружать его ненужным сканированием.
</p><p>Как только части графа сцены, которые должны быть выбраны, оказываются внутри узлов SoFCSelection, вам необходимо предоставить два метода для обработки пути выбора. Путь выбора может принимать форму строки, содержащей имена каждого элемента в пути, или массива объектов графа сцены. Вы предоставляете два метода: <code>getDetailPath</code>, который преобразует путь строки в массив объектов scenegraph (графа сцены), и <code>getElementPicked</code>, который принимает элемент, по которому щелкнули в графе сцены, и возвращает его строковое имя (примечание, а не его строковый путь).
</p><p>Вот вышеприведённый пример с молекулой, адаптированный для выбора элементов молекулы:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">Molecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Add two point properties '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p1"</span> <span class="ow">or</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p2"</span><span class="p">:</span>
            <span class="sd">''' Print the name of the property that has changed '''</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">''' Print a short message when doing a recomputation, this method is mandatory '''</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderMolecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Set this object to the proxy object of the actual view provider '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="n">sep1</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
        <span class="n">sel1</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="c1"># sel1.policy.setValue(coin.SoSelection.SHIFT)</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span>
        <span class="n">sep1</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sel1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trl1</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoTranslation</span><span class="p">()</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trl1</span><span class="p">)</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSphere</span><span class="p">())</span>
        <span class="n">sep2</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
        <span class="n">sel2</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span>
        <span class="n">sep2</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sel2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trl2</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoTranslation</span><span class="p">()</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trl2</span><span class="p">)</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSphere</span><span class="p">())</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">RootNode</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sep1</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">RootNode</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sep2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateData</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="s1">'p2'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel1</span> <span class="o">=</span> <span class="n">sel1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel2</span> <span class="o">=</span> <span class="n">sel2</span>

    <span class="k">def</span> <span class="nf">getDetailPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subname</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span>
        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">RootNode</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="p">)</span>

            <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">whichChild</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">splitSubname</span><span class="p">(</span><span class="n">subname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom1'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom2'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">getElementPicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom1'</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom2'</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="s2">"If a property of the handled feature has changed we have the chance to handle this here"</span>
        <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p1"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p1"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trl1</span><span class="o">.</span><span class="n">translation</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p2"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p2"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trl2</span><span class="o">.</span><span class="n">translation</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">makeMolecule</span><span class="p">():</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::FeaturePython"</span><span class="p">,</span><span class="s2">"Molecule"</span><span class="p">)</span>
    <span class="n">Molecule</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ViewProviderMolecule</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><span id="Working_with_simple_shapes"></span>
</p>
<h2><span id=".D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81_.D0.BF.D1.80.D0.BE.D1.81.D1.82.D1.8B.D0.BC.D0.B8_.D1.84.D0.BE.D1.80.D0.BC.D0.B0.D0.BC.D0.B8"></span><span class="mw-headline" id="Работа_с_простыми_формами">Работа с простыми формами</span></h2>
<p>Если ваш параметрический объект - это просто геометрическая форма, то вам не нужно использовать view provider объект. Форма будет отображаться стандартными способами представления форм FreeCAD:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="kn">import</span> <span class="nn">Part</span>
<span class="k">class</span> <span class="nc">Line</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''"App two point properties" '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">'''"Print a short message when doing a recomputation, this method is mandatory" '''</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

<span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::FeaturePython"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span>
<span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="o">.</span><span class="n">Proxy</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># just set it to something different from None (this assignment is needed to run an internal notification)</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p>Тот же код с применением <b>ViewProviderLine</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="kn">import</span> <span class="nn">Part</span>

<span class="k">class</span> <span class="nc">Line</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
         <span class="sd">'''"App two point properties" '''</span>
         <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
         <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">'''"Print a short message when doing a recomputation, this method is mandatory" '''</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderLine</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
      <span class="sd">''' Set this object to the proxy object of the actual view provider '''</span>
      <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

   <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">''' Return the name of the default display mode. It must be defined in getDisplayModes. '''</span>
      <span class="k">return</span> <span class="s2">"Flat Lines"</span>

<span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::FeaturePython"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span>
<span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">ViewProviderLine</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><span id="Scenegraph_Structure"></span>
</p>
<h2><span id=".D0.A1.D1.82.D1.80.D1.83.D0.BA.D1.82.D1.83.D1.80.D0.B0_.D0.B3.D1.80.D0.B0.D1.84.D0.B0_.D1.81.D1.86.D0.B5.D0.BD.D1.8B"></span><span class="mw-headline" id="Структура_графа_сцены">Структура графа сцены</span></h2>
<p>You may have noticed that the examples above construct their scenegraphs in slightly different ways.  Some use <code>obj.addDisplayMode(node, "modename")</code> while others use <code>obj.SwitchNode.getChild(x).addChild(y)</code>.
</p><p>Each feature in a FreeCAD document is based the following scenegraph structure:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">RootNode</span>
 \<span class="o">-</span> <span class="n">SwitchNode</span>
     \<span class="o">-</span> <span class="n">Shaded</span>
      <span class="o">-</span> <span class="n">Wireframe</span>
      <span class="o">-</span> <span class="n">etc</span>
</pre></div>
<p>The <code>SwitchNode</code> displays only one of its children, depending on which display mode is selection in FreeCAD.
</p><p>The examples which use <code>addDisplayMode</code> are constructing their scenegraphs solely out of coin3d scenegraph elements.  Under the covers, <code>addDisplayMode</code> adds a new child to the <code>SwitchNode</code>; the name of that node will match the display mode it was passed.
</p><p>The examples which use <code>SwitchNode.getChild(x).addChild</code> also construct part of their geometry using functions from the Part workbench, such as <code>fp.Shape = Part.makeLine(fp.p1,fp.p2)</code>.  This constructs the different display mode scenegraphs under the <code>SwitchNode</code>; when we later come to add coin3d elements to the scenegraph, we need to add them to the existing display mode scenegraphs using <code>addChild</code> rather than creating a new child of the <code>SwitchNode</code>.
</p><p>When using <code>addDisplayMode()</code> to add geometry to the scenegraph, each display mode should have its own node which is passed to <code>addDisplayMode()</code>; don't reuse the same node for this.  Doing so will confuse the selection mechanism.  It's okay if each display mode's node has the same geometry nodes added below it, just the root of each display mode needs to be distinct.
</p><p>Here is the above molecule example, adapted to be drawn only with Coin3D scenegraph objects instead of using objects from the Part workbench:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="k">class</span> <span class="nc">Molecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Add two point properties '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">''' Print a short message when doing a recomputation, this method is mandatory '''</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">ViewProviderMolecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Set this object to the proxy object of the actual view provider '''</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constructed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">material</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoMaterial</span><span class="p">()</span>
        <span class="n">material</span><span class="o">.</span><span class="n">diffuseColor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">material</span><span class="o">.</span><span class="n">emissiveColor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">drawStyle</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="p">()</span>
        <span class="n">drawStyle</span><span class="o">.</span><span class="n">pointSize</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">drawStyle</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="o">.</span><span class="n">LINES</span>
        <span class="n">wireframe</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">shaded</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span> <span class="o">=</span> <span class="n">wireframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span> <span class="o">=</span> <span class="n">shaded</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">drawStyle</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">material</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">drawStyle</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">material</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">sel1</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">'EMISSIVE_DIFFUSE'</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoIndexedPointSet'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">p1</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">sel1</span> <span class="o">+=</span> <span class="n">p1</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">sel1</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">g</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">g</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">sel2</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">'EMISSIVE_DIFFUSE'</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoIndexedPointSet'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">p2</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sel2</span> <span class="o">+=</span> <span class="n">p2</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">sel2</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">g</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">g</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">sel3</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel3</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">'EMISSIVE_DIFFUSE'</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoIndexedLineSet'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">p3</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">sel3</span> <span class="o">+=</span> <span class="n">p3</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">sel3</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">g</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">g</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="n">wireframe</span><span class="p">,</span> <span class="s1">'Wireframe'</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="n">shaded</span><span class="p">,</span> <span class="s1">'Shaded'</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sel1</span> <span class="o">=</span> <span class="n">sel1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel2</span> <span class="o">=</span> <span class="n">sel2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel3</span> <span class="o">=</span> <span class="n">sel3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constructed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateData</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="s1">'p2'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getDetailPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subname</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span>
        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">RootNode</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="p">)</span>

            <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">whichChild</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">"getDetailPath: mode </span><span class="si">{}</span><span class="s2"> is active</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">splitSubname</span><span class="p">(</span><span class="n">subname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom1'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom2'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Line'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">getElementPicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom1'</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom2'</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel3</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Line'</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="s2">"If a property of the handled feature has changed we have the chance to handle this here"</span>
        <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructed</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p1"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p1"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p2"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p2"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">'Wireframe'</span><span class="p">,</span> <span class="s1">'Shaded'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">'Shaded'</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">makeMolecule</span><span class="p">():</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span><span class="s2">"Molecule"</span><span class="p">)</span>
    <span class="n">Molecule</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">b</span><span class="o">=</span><span class="n">ViewProviderMolecule</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">touch</span><span class="p">()</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>

<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">makeMolecule</span><span class="p">()</span>
</pre></div>
<p><span id="Part_Design_scripted_objects"></span>
</p>
<h2><span id=".D0.9F.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D1.83.D0.B5.D0.BC.D1.8B.D0.B9_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82_Part_Design"></span><span class="mw-headline" id="Программируемый_объект_Part_Design">Программируемый объект Part Design</span></h2>
<p>When making scripted objects in Part Design the process is similar to the scripted objects discussed above, but with a few additional considerations.  We must handle 2 shape properties, one for the shape we see in the 3D view and another for the shape used by the pattern tools, such as polar pattern features.  The object shapes also needs to be fused to any existing material already in the Body (or cut from it in the case of Subtractive features).  And we must account for the placement and attachment of our objects a little bit differently.
</p><p>Part Design scripted solid object features should be based on either PartDesign::FeaturePython, PartDesign::FeatureAdditivePython, or PartDesign::FeatureSubtractivePython rather than Part::FeaturePython.  Only the Additive and Subtractive variants can be used in pattern features, and if based on Part::FeaturePython when the user drops the object into a Part Design Body it becomes a BaseFeature rather than being treated by the Body as a native Part Design object.  Note: all of these are expected to be solids, so if you are making a non-solid feature it should be based on Part::FeaturePython or else the next feature in the tree will attempt to fuse to as a solid and it will fail.
</p><p>Here is a simple example of making a Tube primitive, similar to the Tube primitive in Part Workbench except this one will be a Part Design solid feature object.  For this we will 2 separate files: pdtube.FCMacro and pdtube.py.  The .FCMacro file will be executed by the user to create the object.  The .py file will hold the class definitions, imported by the .FCMacro.  The reason for doing it this way is to maintain the parametric nature of the object after restarting FreeCAD and opening a document containing one of our Tubes.
</p><p>First, the class definition file:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#classes should go in pdtube.py</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span><span class="o">,</span> <span class="nn">Part</span>
<span class="k">class</span> <span class="nc">PDTube</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Radius1"</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">,</span><span class="s2">"Radius1"</span><span class="p">)</span><span class="o">.</span><span class="n">Radius1</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Radius2"</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">,</span><span class="s2">"Radius2"</span><span class="p">)</span><span class="o">.</span><span class="n">Radius2</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Height"</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">,</span><span class="s2">"Height of tube"</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">makeAttachable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">makeAttachable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Version</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">19</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">addExtension</span><span class="p">(</span><span class="s1">'Part::AttachExtensionPython'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">addExtension</span><span class="p">(</span><span class="s1">'Part::AttachExtensionPython'</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">setEditorMode</span><span class="p">(</span><span class="s1">'Placement'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#non-readonly non-hidden</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fp</span><span class="p">):</span>
        <span class="n">outer_cylinder</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Radius2</span><span class="p">,</span> <span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>
        <span class="n">inner_cylinder</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Radius1</span><span class="p">,</span> <span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius1</span> <span class="o">==</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius2</span><span class="p">:</span> <span class="c1">#just make cylinder</span>
            <span class="n">tube_shape</span> <span class="o">=</span> <span class="n">outer_cylinder</span>
        <span class="k">elif</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius1</span> <span class="o">&lt;</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius2</span><span class="p">:</span>
            <span class="n">tube_shape</span> <span class="o">=</span> <span class="n">outer_cylinder</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">inner_cylinder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#invert rather than error out</span>
            <span class="n">tube_shape</span> <span class="o">=</span> <span class="n">inner_cylinder</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">outer_cylinder</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">"positionBySupport"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">makeAttachable</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">positionBySupport</span><span class="p">()</span>
        <span class="n">tube_shape</span><span class="o">.</span><span class="n">Placement</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">Placement</span>

        <span class="c1">#BaseFeature (shape property of type Part::PropertyPartShape) is provided for us</span>
        <span class="c1">#with the PartDesign::FeaturePython and related classes, but it might be empty</span>
        <span class="c1">#if our object is the first object in the tree.  it's a good idea to check</span>
        <span class="c1">#for its existence in case we want to make type Part::FeaturePython, which won't have it</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">"BaseFeature"</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fp</span><span class="o">.</span><span class="n">BaseFeature</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">"Subtractive"</span> <span class="ow">in</span> <span class="n">fp</span><span class="o">.</span><span class="n">TypeId</span><span class="p">:</span>
                <span class="n">full_shape</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">BaseFeature</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tube_shape</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">full_shape</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">BaseFeature</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">fuse</span><span class="p">(</span><span class="n">tube_shape</span><span class="p">)</span>
            <span class="n">full_shape</span><span class="o">.</span><span class="n">transformShape</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">toMatrix</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span> <span class="c1">#borrowed from gears workbench</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">full_shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">tube_shape</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="s2">"AddSubShape"</span><span class="p">):</span> <span class="c1">#PartDesign::FeatureAdditivePython and</span>
                                      <span class="c1">#PartDesign::FeatureSubtractivePython have this</span>
                                      <span class="c1">#property but PartDesign::FeaturePython does not</span>
                                      <span class="c1">#It is the shape used for copying in pattern features</span>
                                      <span class="c1">#for example in making a polar pattern</span>
            <span class="n">tube_shape</span><span class="o">.</span><span class="n">transformShape</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">toMatrix</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">AddSubShape</span> <span class="o">=</span> <span class="n">tube_shape</span>

<span class="k">class</span> <span class="nc">PDTubeVP</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Set this object to the proxy object of the actual view provider'''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vobj</span> <span class="o">=</span> <span class="n">vobj</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''If a property of the handled feature has changed we have the chance to handle this here'''</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Return a list of display modes.'''</span>
        <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Flat Lines"</span><span class="p">)</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Shaded"</span><span class="p">)</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Wireframe"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">modes</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the name of the default display mode. It must be defined in getDisplayModes.'''</span>
        <span class="k">return</span> <span class="s2">"Flat Lines"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="sd">'''Map the display mode defined in attach with those defined in getDisplayModes.\</span>
<span class="sd">                Since they have the same names nothing needs to be done. This method is optional'''</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''Here we can do something when a single property got changed'''</span>
        <span class="c1">#FreeCAD.Console.PrintMessage("Change property: " + str(prop) + "\n")</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the icon in XPM format which will appear in the tree view. This method is\</span>
<span class="sd">                optional and if not defined a default icon is shown.'''</span>
        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "   c None",</span>
<span class="s2">            ".  c #141010",</span>
<span class="s2">            "+  c #615BD2",</span>
<span class="s2">            "@  c #C39D55",</span>
<span class="s2">            "#  c #000000",</span>
<span class="s2">            "$  c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''When saving the document this object gets stored using Python's json module.\</span>
<span class="sd">                Since we have some un-serializable parts here -- the Coin stuff -- we must define this method\</span>
<span class="sd">                to return a tuple of all serializable objects or None.'''</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">'''When restoring the serialized object from document we have the chance to set some internals here.\</span>
<span class="sd">                Since no data were serialized nothing needs to be done here.'''</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p>And now the macro file to create the object:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">#pdtube.FCMacro</span>
<span class="kn">import</span> <span class="nn">pdtube</span>
<span class="c1">#above line needed if the class definitions above are place in another file: PDTube.py</span>
<span class="c1">#this is needed if the tube object is to remain parametric after restarting FreeCAD and loading</span>
<span class="c1">#a document containing the object</span>

<span class="n">body</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getActiveObject</span><span class="p">(</span><span class="s2">"pdbody"</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">"No active body.</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Additive"</span><span class="p">,</span><span class="s2">"Subtractive"</span><span class="p">,</span><span class="s2">"Neither additive nor subtractive"</span><span class="p">]</span>
    <span class="n">item</span><span class="p">,</span><span class="n">ok</span> <span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="s2">"Select tube type"</span><span class="p">,</span><span class="s2">"Select whether you want additive, subtractive, or neither:"</span><span class="p">,</span><span class="n">items</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="s2">"PartDesign::FeatureAdditivePython"</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="s2">"PartDesign::FeatureSubtractivePython"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="s2">"PartDesign::FeaturePython"</span> <span class="c1">#not usable in pattern features, such as polar pattern</span>

        <span class="n">tube</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">className</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">)</span>
        <span class="n">pdtube</span><span class="o">.</span><span class="n">PDTube</span><span class="p">(</span><span class="n">tube</span><span class="p">)</span>
        <span class="n">pdtube</span><span class="o">.</span><span class="n">PDTubeVP</span><span class="p">(</span><span class="n">tube</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
        <span class="n">body</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">tube</span><span class="p">)</span> <span class="c1">#optionally we can also use body.insertObject() for placing at particular place in tree</span>
</pre></div>
<h2><span class="mw-headline" id="Available_object_types">Available object types</span></h2>
<p>The object types you can create with <code>FreeCAD.ActiveDocument.addObject()</code> depend on the loaded modules. After loading all internal workbenches a complete list can be obtained with <code>FreeCAD.ActiveDocument.supportedTypes()</code>. Only object types with a name ending in <code>Python</code> can be used for scripted objects. These are listed here (for FreeCAD v1.0):
</p>
<ul><li><code>App::DocumentObjectGroupPython</code></li>
<li><code>App::FeaturePython</code></li>
<li><code>App::GeometryPython</code></li>
<li><code>App::LinkElementPython</code></li>
<li><code>App::LinkGroupPython</code></li>
<li><code>App::LinkPython</code></li>
<li><code>App::MaterialObjectPython</code></li>
<li><code>App::PlacementPython</code></li>
<li><code>Fem::ConstraintPython</code></li>
<li><code>Fem::FeaturePython</code></li>
<li><code>Fem::FemAnalysisPython</code></li>
<li><code>Fem::FemMeshObjectPython</code></li>
<li><code>Fem::FemResultObjectPython</code></li>
<li><code>Fem::FemSolverObjectPython</code></li>
<li><code>Measure::MeasurePython</code></li>
<li><code>Mesh::FeaturePython</code></li>
<li><code>Part::CustomFeaturePython</code></li>
<li><code>Part::FeaturePython</code></li>
<li><code>Part::Part2DObjectPython</code></li>
<li><code>PartDesign::FeatureAdditivePython</code></li>
<li><code>PartDesign::FeatureAddSubPython</code></li>
<li><code>PartDesign::FeaturePython</code></li>
<li><code>PartDesign::FeatureSubtractivePython</code></li>
<li><code>PartDesign::SubShapeBinderPython</code></li>
<li><code>Path::FeatureAreaPython</code></li>
<li><code>Path::FeatureAreaViewPython</code></li>
<li><code>Path::FeatureCompoundPython</code></li>
<li><code>Path::FeaturePython</code></li>
<li><code>Path::FeatureShapePython</code></li>
<li><code>Points::FeaturePython</code></li>
<li><code>Sketcher::SketchObjectPython</code></li>
<li><code>Spreadsheet::SheetPython</code></li>
<li><code>TechDraw::DrawBrokenViewPython</code></li>
<li><code>TechDraw::DrawComplexSectionPython</code></li>
<li><code>TechDraw::DrawLeaderLinePython</code></li>
<li><code>TechDraw::DrawPagePython</code></li>
<li><code>TechDraw::DrawRichAnnoPython</code></li>
<li><code>TechDraw::DrawTemplatePython</code></li>
<li><code>TechDraw::DrawTilePython</code></li>
<li><code>TechDraw::DrawTileWeldPython</code></li>
<li><code>TechDraw::DrawViewPartPython</code></li>
<li><code>TechDraw::DrawViewPython</code></li>
<li><code>TechDraw::DrawViewSectionPython</code></li>
<li><code>TechDraw::DrawViewSymbolPython</code></li>
<li><code>TechDraw::DrawWeldSymbolPython</code></li></ul>
<p><span id="Available_methods"></span>
</p>
<h2><span id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BD.D1.8B.D0.B5_.D0.BC.D0.B5.D1.82.D0.BE.D0.B4.D1.8B"></span><span class="mw-headline" id="Доступные_методы">Доступные методы</span></h2>
<p>Полное описание доступно на странице <a href="FeaturePython_methods.html" title="FeaturePython methods/ru">методы FeaturePython</a>.
</p><p><span id="Available_properties"></span>
</p>
<h2><span id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BD.D1.8B.D0.B5_.D1.81.D0.B2.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0"></span><span class="mw-headline" id="Доступные_свойства">Доступные свойства</span></h2>
<div class="mw-translate-fuzzy">
<p>Свойства - это "строительные блоки" объекта FeaturePython. Через них пользователь может взаимодействовать с объектом и вносить изменения в него. После создания нового FeaturePython объекта в вашем документе ( a=FreeCAD.ActiveDocument.addObject("App::FeaturePython","Box") ),вы можете получить список доступных свойств, с помощью:
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">)</span>
<span class="n">obj</span><span class="o">.</span><span class="n">supportedProperties</span><span class="p">()</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Вы получите список доступных свойств, которые более подробно описаны на странице <a href="FeaturePython_Custom_Properties.html" title="FeaturePython Custom Properties/ru">пользовательских свойств объекта FeaturePython</a>:
</p>
</div>
<div class="mw-translate-fuzzy">
<p>При добавлении новых свойств к  пользовательским объектам, позаботьтесь об этом:
</p>
<ul><li>Не используйте символы "&lt;" или "&gt;" в описании свойств (это вызовет поломку xml части .fcstd файла)</li>
<li>Свойства хранятся в .fcstd файле в алфавитном порядке. Если у вас есть форма(shape) в ваших свойствах, любое свойство имя которого идет, в алфавитном порядке, после "Shape" , будет загружено ПОСЛЕ формы, что может привести к странному поведению.</li></ul>
</div>
<p>The properties are defined in the <a class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/App/PropertyStandard.h" rel="nofollow">PropertyStandard C++ header file</a>.
</p>
<h3><span class="mw-headline" id="Property_attributes">Property attributes</span></h3>
<div class="mw-translate-fuzzy">
<p>По умолчанию свойства могут быть обновлены. Имеется возможность сделать свойство только для чтения (read-only), например, в случае если требуется отображать только результат выполнения метода. Также возможно создать скрытое (hidden) свойство. Сам же тип свойства можно задать с помощью:
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">setEditorMode</span><span class="p">(</span><span class="s2">"MyPropertyName"</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>где переменная mode (short int типа) - может иметь следующие значения:
</p>
<pre> 0 -- значение по умолчанию, допускает как чтение, так и запись
 1 -- свойство только для чтения (read-only)
 2 -- скрытое свойство (hidden)
</pre>
</div>
<p>The attributes can also be set using a list of strings, e.g. <code>obj.setEditorMode("Placement", ["ReadOnly", "Hidden"])</code>.
</p><p>Attributes set using <code>setEditorMode</code> can be removed by the user. See <a href="Property_editor.html#Context_menu" title="Property editor">Property editor</a>. Note that read-only properties can still be changed from Python.
</p><p>You can also set these, and more, attributes directly with the <code>addProperty</code> function. Attributes set with that function cannot be changed by the user. An interesting possibility is to mark a property as an output property. This way FreeCAD won't mark the object as touched when changing it (so no need to recompute).
</p><p>Example of output property (see also <a class="external free" href="https://forum.freecad.org/viewtopic.php?t=24928" rel="nofollow">https://forum.freecad.org/viewtopic.php?t=24928</a>):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span> <span class="s2">"MyCustomProperty"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
<p>The attributes that can be set with <code>addProperty</code> are listed below. Multiple attributes can be set by adding values.
</p>
<pre>  0 -- Prop_None, No special property attribute
  1 -- Prop_ReadOnly, Property is read-only in the editor
  2 -- Prop_Transient, Property won't be saved to file
  4 -- Prop_Hidden, Property won't appear in the editor
  8 -- Prop_Output, Modified property doesn't touch its parent container
 16 -- Prop_NoRecompute, Modified property doesn't touch its container for recompute
 32 -- Prop_NoPersist, Property won't be saved to file at all
</pre>
<div class="mw-translate-fuzzy">
<p>Вы можете найти эти различные типы свойств, определённые в <a class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/App/PropertyContainer.h" rel="nofollow">заголовочном файле PropertyContainer исходного кода C++</a>.
</p>
</div>
<p>For <code>Prop_ReadOnly</code> and <code>Prop_Hidden</code> the <code>addProperty</code> function has boolean arguments as well:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span> <span class="s2">"MyCustomProperty"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
<p>Which is equivalent to:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span> <span class="s2">"MyCustomProperty"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
<p><span style="font-size:small;"><a href="Release_notes_1.0.html" title="Release notes 1.0">introduced in version 1.0</a></span>: The full signature of the function is:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="nb">type</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enum_vals</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
<ul><li><code>type</code>: Property type.</li>
<li><code>name</code>: Property name.</li>
<li><code>group</code>: Property subsection (used in the <a href="Property_editor.html" title="Property editor">Property editor</a>).</li>
<li><code>doc</code>: Tooltip (idem).</li>
<li><code>attr</code>: Attribute, see above.</li>
<li><code>read_only</code>: See above.</li>
<li><code>hidden</code>: See above.</li>
<li><code>enum_vals</code>: Enumeration values (list of string), only relevant if type is <code>"App::PropertyEnumeration"</code>.</li></ul>
<h2><span class="mw-headline" id="Available_extensions">Available extensions</span></h2>
<p>The list of available extensions can be obtained with <code>grep -RI EXTENSION_PROPERTY_SOURCE_TEMPLATE</code> in the repository of the source code and is given here (for FreeCAD v0.21).
</p><p>For objects:
</p>
<ul><li><code>App::GeoFeatureGroupExtensionPython</code></li>
<li><code>App::GroupExtensionPython</code></li>
<li><code>App::LinkBaseExtensionPython</code></li>
<li><code>App::LinkExtensionPython</code></li>
<li><code>App::OriginGroupExtensionPython</code></li>
<li><code>Part::AttachExtensionPython</code></li>
<li><code>TechDraw::CosmeticExtensionPython</code></li></ul>
<p>For view objects:
</p>
<ul><li><code>Gui::ViewProviderExtensionPython</code></li>
<li><code>Gui::ViewProviderGeoFeatureGroupExtensionPython</code></li>
<li><code>Gui::ViewProviderGroupExtensionPython</code></li>
<li><code>Gui::ViewProviderOriginGroupExtensionPython</code></li>
<li><code>PartGui::ViewProviderAttachExtensionPython</code></li>
<li><code>PartGui::ViewProviderSplineExtensionPython</code></li></ul>
<p>There exist other extensions but they do not work as-is:
</p>
<ul><li><code>App::ExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderCosmeticExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderDrawingViewExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderPageExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderTemplateExtensionPython</code></li></ul>
<p><span id="Further_information"></span>
</p>
<h2><span id=".D0.94.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.B8.D0.BD.D1.84.D0.BE.D1.80.D0.BC.D0.B0.D1.86.D0.B8.D1.8F"></span><span class="mw-headline" id="Дополнительная_информация">Дополнительная информация</span></h2>
<p>Дополнительные страницы Вики FreeCADа:
</p>
<ul><li><a href="Scripted_objects_saving_attributes.html" title="Scripted objects saving attributes/ru">Scripted objects saving attributes</a></li>
<li><a href="Scripted_objects_migration.html" title="Scripted objects migration/ru">Scripted objects migration</a></li>
<li><a href="Scripted_objects_with_attachment.html" title="Scripted objects with attachment/ru">Scripted objects with attachment</a></li>
<li><a href="Viewprovider.html" title="Viewprovider/ru">Viewproviders</a></li></ul>
<p>Интересные темы форума про создание объектов с помощью скриптов:
</p>
<ul><li><a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=22&amp;t=13740" rel="nofollow">Python object attributes lost at load</a></li>
<li><a class="external text" href="http://forum.freecadweb.org/viewtopic.php?t=12139" rel="nofollow">New FeaturePython is grey</a></li>
<li><a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=18&amp;t=44009" rel="nofollow">Explanation on dumps and loads</a>, <a class="external text" href="https://docs.python.org/3/library/pickle.html#object.__getstate__" rel="nofollow">official documentation</a></li>
<li><a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=18&amp;t=13460&amp;start=20#p109709" rel="nofollow">Eigenmode frequency always 0?</a></li>
<li><a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=22&amp;t=21330" rel="nofollow">how to implement python feature's setEdit properly?</a></li></ul>
<p>В дополнение к представленным примерам, посмотрите FreeCAD <a class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/Mod/TemplatePyMod/FeaturePython.py" rel="nofollow">src/Mod/TemplatePyMod/FeaturePython.py</a>, находящийся в папке с исходными кодами FreeCAD.
</p><p><br/>
</p>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
<div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Arrow-left.svg" width="16"/></span></span> <a class="mw-redirect" href="Creating_a_FeaturePython_Box,_Part_II.html" title="Creating a FeaturePython Box, Part II/ru">Creating a FeaturePython Box, Part_II</a></div>
<div style="margin: 4px 0; float: right;"><a href="Embedding_FreeCAD.html" title="Embedding FreeCAD/ru">Встраивание FreeCAD</a>
<span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Arrow-right.svg" width="16"/></span></span></div>
<div style="text-align:center"><a href="Online_Help_Toc.html" title="Online Help Toc/ru">Оглавление</a> <span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="24" src="../File/Online_Help_Toc.svg" width="24"/></span></span></div>
</div>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
<div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Power_user_hub.png"><img decoding="async" height="24" src="../File/Power_user_hub.png" srcset="/images/thumb/8/8f/Power_user_hub.png/36px-Power_user_hub.png 1.5x, /images/thumb/8/8f/Power_user_hub.png/48px-Power_user_hub.png 2x" width="24"/></a></span> <a href="Power_users_hub.html" title="Power users hub/ru">Power user documentation</a>
<div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>FreeCAD scripting:</b> <a href="Python.html" title="Python/ru">Python</a>, <a href="Introduction_to_Python.html" title="Introduction to Python/ru">Introduction to Python</a>, <a href="Python_scripting_tutorial.html" title="Python scripting tutorial/ru">Python scripting tutorial</a>, <a href="FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/ru">FreeCAD Scripting Basics</a></li></ul>
<hr/>
<ul><li><b>Modules:</b> <a href="Builtin_modules.html" title="Builtin modules/ru">Builtin modules</a>, <a href="Units.html" title="Units/ru">Units</a>, <a class="new" href="index.php?title=Quantity_ru&amp;action=edit&amp;redlink=1.html" title="Quantity/ru (page does not exist)">Quantity</a></li>
<li><b>Workbenches:</b> <a href="Workbench_creation.html" title="Workbench creation/ru">Workbench creation</a>, <a href="Gui_Command.html" title="Gui Command/ru">Gui Commands</a>, <a href="Command.html" title="Command/ru">Commands</a>, <a href="Installing_more_workbenches.html" title="Installing more workbenches/ru">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="Mesh_Scripting.html" title="Mesh Scripting/ru">Mesh Scripting</a>, <a href="Topological_data_scripting.html" title="Topological data scripting/ru">Topological data scripting</a>, <a href="Mesh_to_Part.html" title="Mesh to Part/ru">Mesh to Part</a>, <a href="PythonOCC.html" title="PythonOCC/ru">PythonOCC</a></li></ul>
<hr/>
<ul><li><b>Parametric objects:</b> <a class="mw-selflink selflink">Scripted objects</a>, <a href="Viewprovider.html" title="Viewprovider/ru">Viewproviders</a> <small>(<a class="new" href="index.php?title=Custom_icon_in_tree_view_ru&amp;action=edit&amp;redlink=1.html" title="Custom icon in tree view/ru (page does not exist)">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="Scenegraph.html" title="Scenegraph/ru">Coin (Inventor) scenegraph</a>, <a href="Pivy.html" title="Pivy/ru">Pivy</a></li>
<li><b>Graphical interface:</b> <a href="Interface_creation.html" title="Interface creation/ru">Interface creation</a>, <a href="Dialog_creation.html" title="Dialog creation/ru">Interface creation completely in Python</a> <small>(<a class="new" href="index.php?title=Dialog_creation_with_various_widgets_ru&amp;action=edit&amp;redlink=1.html" title="Dialog creation with various widgets/ru (page does not exist)">1</a>, <a class="new" href="index.php?title=Dialog_creation_reading_and_writing_files_ru&amp;action=edit&amp;redlink=1.html" title="Dialog creation reading and writing files/ru (page does not exist)">2</a>, <a class="new" href="index.php?title=Dialog_creation_setting_colors_ru&amp;action=edit&amp;redlink=1.html" title="Dialog creation setting colors/ru (page does not exist)">3</a>, <a class="new" href="index.php?title=Dialog_creation_image_and_animated_GIF_ru&amp;action=edit&amp;redlink=1.html" title="Dialog creation image and animated GIF/ru (page does not exist)">4</a>, <a class="new" href="index.php?title=PySide_usage_snippets_ru&amp;action=edit&amp;redlink=1.html" title="PySide usage snippets/ru (page does not exist)">5</a>)</small>, <a href="PySide.html" title="PySide/ru">PySide</a>, PySide examples <a href="PySide_Beginner_Examples.html" title="PySide Beginner Examples/ru">beginner</a>, <a href="PySide_Intermediate_Examples.html" title="PySide Intermediate Examples/ru">intermediate</a>, <a href="PySide_Advanced_Examples.html" title="PySide Advanced Examples/ru">advanced</a></li>
<li><b>Macros:</b> <a href="Macros.html" title="Macros/ru">Macros</a>, <a href="How_to_install_macros.html" title="How to install macros/ru">How to install macros</a></li>
<li><b>Embedding:</b> <a href="Embedding_FreeCAD.html" title="Embedding FreeCAD/ru">Embedding FreeCAD</a>, <a href="Embedding_FreeCADGui.html" title="Embedding FreeCADGui/ru">Embedding FreeCADGui</a></li></ul>
<hr/>
<ul><li><b>Other:</b> <a href="Expressions.html" title="Expressions/ru">Expressions</a>, <a href="Code_snippets.html" title="Code snippets/ru">Code snippets</a>, <a href="Line_drawing_function.html" title="Line drawing function/ru">Line drawing function</a>, <a href="FreeCAD_vector_math_library.html" title="FreeCAD vector math library/ru">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr/>
<ul><li><b>Hubs:</b> <a href="User_hub.html" title="User hub/ru">User hub</a>, <a href="Power_users_hub.html" title="Power users hub/ru">Power users hub</a>, <a href="Developer_hub.html" title="Developer hub/ru">Developer hub</a></li></ul></div>
</div></div>
<!-- 
NewPP limit report
Cached time: 20241129212842
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.284 seconds
Real time usage: 2.614 seconds
Preprocessor visited node count: 1105/1000000
Post‐expand include size: 13965/2097152 bytes
Template argument size: 33680/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 19/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 136287/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 2371.576      1 -total
 99.31% 2355.238     19 Template:Code
  0.14%    3.263    110 Template:Incode
  0.11%    2.501      1 Template:Powerdocnavi/ru
  0.06%    1.492      2 Template:Docnav/ru
  0.05%    1.176      1 Template:Navigation_menu_2
  0.03%    0.781      1 Template:Version
  0.02%    0.481      1 Template:TOCright
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:1121-0!canonical and timestamp 20241129212840 and revision id 1499125. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
