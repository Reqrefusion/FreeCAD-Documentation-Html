<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro Airfoil Import &amp; Scale/cs</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--med" dir="ltr" href="../de\Macro_Airfoil_Import_%26_Scale.html" lang="de" title="Macro Airfoil Import &amp; Scale (54% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Macro_Airfoil_Import_%26_Scale.html" lang="en" title="Macro Airfoil Import &amp; Scale (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../fr\Macro_Airfoil_Import_%26_Scale.html" lang="fr" title="Macro Airfoil Import &amp; Scale (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../it\Macro_Airfoil_Import_%26_Scale.html" lang="it" title="Macro Importa &amp; Scala un profilo alare (21% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../pl\Macro_Airfoil_Import_%26_Scale.html" lang="pl" title="Makrodefinicja: Import profili lotniczych i skala (2% translated)">polski</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--stub" dir="ltr" lang="cs">čeština</span></li></ul></div>
<div class="mw-translate-fuzzy">
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Airfoil_Import_%26_Scale.png"><img decoding="async" height="32" src="../File/Macro_Airfoil_Import_%26_Scale.png" width="32"/></a></span><span> </span>
Macro Airfoil Import &amp; Scale
</p>
</td></tr>
<tr>
<th class="ctOdd">Popis
</th></tr>
<tr>
<td class="ctEven left macro-description">Trace the perimeter of a Airfoil from a .dat file.<br/><br/>Version macro : 2.1.2<br/>Date last modification : 2019-07-16<br/>FreeCAD version : All<br/>Download : <a class="external text" href="https://www.freecadweb.org/wiki/images/0/0c/Macro_Airfoil_Import_%26_Scale.png" rel="nofollow">ToolBar Icon</a><br/>Autor: quick61<br/>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Quick61.html" title="User:Quick61">quick61</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://www.freecadweb.org/wiki/images/0/0c/Macro_Airfoil_Import_%26_Scale.png" rel="nofollow">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Odkazy
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../cs\Macros_recipes.html" title="Macros recipes/cs">Makro recepty|</a><br/><a href="../cs\How_to_install_macros.html" title="How to install macros/cs">Jak nainstalovat makra</a><br/><a href="../cs\Customize_Toolbars.html" title="Customize Toolbars/cs">Jak přizpůsobit panely nástrojů</a>
</td></tr>
<tr>
<th class="ctOdd">Verze
</th></tr>
<tr>
<td class="ctEven macro-version">2.1.2
</td></tr>
<tr>
<th class="ctOdd">Datum poslední úpravy
</th></tr>
<tr>
<td class="ctEven macro-date">2019-07-16
</td></tr>
<tr>
<th class="ctOdd">Verze FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Výchozí zástupce
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Viz též
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Popis"><span class="tocnumber">2</span> <span class="toctext">Popis</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Enter_Chord_Length"><span class="tocnumber">2.1</span> <span class="toctext">Enter Chord Length</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Zadejte_délku_chordu"><span class="tocnumber">2.2</span> <span class="toctext">Zadejte délku chordu</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Select_The_File"><span class="tocnumber">2.3</span> <span class="toctext">Select The File</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Airfoil_selected"><span class="tocnumber">2.4</span> <span class="toctext">Airfoil selected</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Airfold_saved"><span class="tocnumber">2.5</span> <span class="toctext">Airfold saved</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Save"><span class="tocnumber">2.6</span> <span class="toctext">Save</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Makra"><span class="tocnumber">3</span> <span class="toctext">Makra</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Old_versions"><span class="tocnumber">4</span> <span class="toctext">Old versions</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Jak_používat_-_verze_1.5"><span class="tocnumber">5</span> <span class="toctext">Jak používat - verze 1.5</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Select_The_File_2"><span class="tocnumber">5.1</span> <span class="toctext">Select The File</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Vyberte_soubor"><span class="tocnumber">5.2</span> <span class="toctext">Vyberte soubor</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#Enter_Chord_Length_2"><span class="tocnumber">5.2.1</span> <span class="toctext">Enter Chord Length</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#How_To_Use_-_Version_2"><span class="tocnumber">5.3</span> <span class="toctext">How To Use - Version 2</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#Jak_používat_-_verze_2"><span class="tocnumber">6</span> <span class="toctext">Jak používat - verze 2</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#The_Macros"><span class="tocnumber">6.1</span> <span class="toctext">The Macros</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Version_1.5"><span class="tocnumber">6.2</span> <span class="toctext">Version 1.5</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#Version_2"><span class="tocnumber">6.2.1</span> <span class="toctext">Version 2</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Version_2.1"><span class="tocnumber">6.2.2</span> <span class="toctext">Version 2.1</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="#Version_2.1.2"><span class="tocnumber">6.3</span> <span class="toctext">Version 2.1.2</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#Odkaz"><span class="tocnumber">7</span> <span class="toctext">Odkaz</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
</div>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Popis">Popis</span></h2>
<p>Toto makro při spuštění nejprve poskytne uživateli souborový prohlížeč, který vyhledá a vybere textový soubor profilu dat .dat. Po zvolení se zadá délka akordů a po stisknutí tlačítka OK se vytvoří správně měřítko profilu. K dispozici jsou zde dvě verze. Verze 1.5 by měla pracovat na verzích FreeCADu, 0.13 stabilních i všech verzích 0.14. Verze 2 by měla být použita pouze s verzemi FreeCAD rovnajícími se nebo vyššími než 0.14 3077 a bude fungovat nejlépe s verzemi vytvořenými s verzemi OCE / OCC verze 6.7 nebo vyšší.
</p>
</div>
<p>See also <a href="../Common_Airfoil_Data_Import.html" title="Common Airfoil Data Import">Common Airfoil Data Import</a>
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Airfoil_Import_%26_Scale_00.png"><img decoding="async" height="423" src="../File/Macro_Airfoil_Import_%26_Scale_00.png" width="480"/></a></span>
</p>
<h3><span class="mw-headline" id="Enter_Chord_Length">Enter Chord Length</span></h3>
<div class="mw-translate-fuzzy">
<h3><span id="Zadejte_d.C3.A9lku_chordu"></span><span class="mw-headline" id="Zadejte_délku_chordu">Zadejte délku chordu</span></h3>
<p>Po výběru souboru profilu se objeví nové dialogové okno s žádostí o délku akordů. Může být zadána libovolná délka, v milimetrech. Po zadání požadované délky vytvoří makro předběžný vodič (DWire) podle bodů popsaných v dříve vybraném souboru profilu .dat v měřítku, které jste zadali pro délku akordy.
</p>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Import_Airfoil_Scale_Enter_V3.png" title="Select the type line"><img alt="Select the type line" decoding="async" height="209" src="../File/Import_Airfoil_Scale_Enter_V3.png" width="352"/></a></span>
</p>
<h3><span class="mw-headline" id="Select_The_File">Select The File</span></h3>
<p>After configuration user with a file browser that will allow you to select the desired airfoil .dat file. Browse to where you have saved the airfoil file, select it and press Open.
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Import_Airfoil_Scale_Open_V3.png" title="Select the file"><img alt="Select the file" decoding="async" height="375" src="../File/Import_Airfoil_Scale_Open_V3.png" width="634"/></a></span>
</p>
<h3><span class="mw-headline" id="Airfoil_selected">Airfoil selected</span></h3>
<p>If the airfoil has been selected in the 3D view, run the macro and the <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #989898; border-radius: 0.2em; padding: 0px 10px 1px 10px; font-weight:normal;"><span typeof="mw:File"><a class="mw-file-description" href="../File/RadioButtonFalse.svg"><img decoding="async" height="16" src="../File/RadioButtonFalse.svg" width="16"/></a></span> Save<span></span></span> is available in the dialog.
</p>
<h3><span class="mw-headline" id="Airfold_saved">Airfold saved</span></h3>
<p>If the <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #989898; border-radius: 0.2em; padding: 0px 10px 1px 10px; font-weight:normal;"><span typeof="mw:File"><a class="mw-file-description" href="../File/RadioButtonTrue.svg"><img decoding="async" height="16" src="../File/RadioButtonTrue.svg" width="16"/></a></span> Save<span></span></span> is checked the file window appear
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Import_Airfoil_Scale_Save_Enter_V3.png" title="Save the file .dat"><img alt="Save the file .dat" decoding="async" height="206" src="../File/Import_Airfoil_Scale_Save_Enter_V3.png" width="351"/></a></span>
</p>
<h3><span class="mw-headline" id="Save">Save</span></h3>
<p>Specify the name of file.
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Import_Airfoil_Scale_Save_V3.png" title="Give the name of file"><img alt="Give the name of file" decoding="async" height="398" src="../File/Import_Airfoil_Scale_Save_V3.png" width="631"/></a></span>
</p><p>The file is saved with 150 points of definition and not verify if the length of the airfoil follow the NACA rulles <i>(length 1 mm)</i>
</p><p>For change the definition value go to:
</p><p><span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;">Tools</span> → <span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;">Edit parameter...</span> "BaseApp/Preferences/Macros/Airfoil_Import_and_Scale" then modify the <b>numberCut</b> value
</p><p>The file is saved in the format "Title and coordinates X Y separate by coma".
</p><p><br/>
<span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Import_Airfoil_Scale_Format.png" title="Format of NACA file"><img alt="Format of NACA file" decoding="async" height="184" src="../File/Import_Airfoil_Scale_Format.png" width="253"/></a></span>
</p><p><span id="The_Macro"></span>
</p>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Makra">Makra</span></h2>
</div>
<p><b>Macro_Airfoil_Import_&amp;_Scale.FCMacro</b>
</p>
<pre># This Macro, when run, will first provide the user with a file browser to
# locate and select a .dat airfoil text file. Once selected, a chord length is
# entered and upon pressing the OK button, a properly scaled airfoil is
# produced. There are two versions provided here. Version 1.5 should work on
# FreeCAD versions, 0.13 stable as well as all 0.14 versions. Version 2 should
# only be used with FreeCAD versions equal to or greater than 0.14 3077 and
# will work best with versions built with OCE/OCC versions 6.7 or greater (See
# the Wiki page for all available version).
#
# (c) quick61

__Name__ = 'Airfoil Import and Scale'
__Comment__ = 'Imports and scales an Airfoil in the form of a Draft Wire (DWire) or Basic Spline (BSpline)'
__Author__ = "quick61"
__Version__ = '3.0.0'
__Date__ = '2024-11-27'
__License__ = ''
__Web__ = "https://forum.freecad.org/viewtopic.php?f=22&amp;t=5554"
__Wiki__ = "https://www.freecad.org/wiki/Macro_Airfoil_Import_%26_Scale"
__Icon__ = 'https://www.freecad.org/wiki/images/0/0c/Macro_Airfoil_Import_%26_Scale.png'
__Help__ = ''
__Naca__ = "http://airfoiltools.com/airfoil/index"
__Status__ = 'stable'
__Requires__ = 'Freecad &gt;= 0.14.3706'
__Communication__ = ''
__Files__ = ''


import FreeCAD as app
import FreeCADGui as Gui
import PySide
from PySide import QtCore, QtGui
from PySide.QtGui import QLineEdit, QRadioButton
import Draft
import importAirfoilDAT
import os

# Select .dat airfoil data file to be imported
# PySide returns a tuple (filename, filter) instead of just a string like in PyQt

global filename
global nameFile

class AirfoilImporterAndScaler():
    def __init__(self):
        self.dialog = None
        self.s1 = None

        # Make dialog box and get the scale size
        self.dialog = QtGui.QDialog()
        self.dialog.resize(350,100)
        self.dialog.setWindowTitle("Airfoil Import &amp; Scale")
        la = QtGui.QVBoxLayout(self.dialog)
        t1 = QtGui.QLabel("Chord Length")
        la.addWidget(t1)

        self.s1 = QtGui.QDoubleSpinBox()
        self.s1.setDecimals(5)
        self.s1.setMinimum(-9999999.9999999)
        self.s1.setMaximum(9999999.9999999)
        self.s1.setSuffix(" mm (Length)")
        self.s1.setValue(1.0)
        la.addWidget(self.s1)

        ####
        self.FreeCAD_ParamGetSet = FreeCAD.ParamGet(u"User parameter:BaseApp/Preferences/Macros/Airfoil_Import_and_Scale")
        self.FreeCAD_ParamGetSet.SetString(u"Version", __Version__ + " (" + __Date__ + ")")
        self.numberCut = self.FreeCAD_ParamGetSet.GetInt("numberCut", 150)       # number of coordinates
        self.FreeCAD_ParamGetSet.SetInt("numberCut", self.numberCut)
        ####
        # Add radio buttons to select between DWire and BSpline
        self.radio1 = QtGui.QRadioButton("Make DWire")
        self.radio2 = QtGui.QRadioButton("Make BSpline")
        self.radio3 = QtGui.QRadioButton("Save")

        # set default to DWire &amp; make radio buttons - Change self.radio1.setChecked(True) to
        # self.radio2.setChecked(True) to set BSpline as default

        self.radio1.setChecked(True)
        la.addWidget(self.radio1)
        self.radio1.setToolTip("Create DWire Airfoil")
        la.addWidget(self.radio2)
        self.radio2.setToolTip("Create BSplinee Airfoil")
        #### save button
        la.addWidget(self.radio3)
        self.numberCut = self.FreeCAD_ParamGetSet.GetInt("numberCut")       # number of coordinates
        self.radio3.setToolTip(u"Only available if one Airfoil to save is selected" + "\n"
                               u"The actual value of definition is " + str(self.numberCut) + " points" + "\n"
                               u"For change this value, go to" + "\n"
                               u"User parameter:BaseApp/Preferences/Macros/Airfoil_Import_and_Scale" + "\n"
                               u"Change the 'numberCut' value")
        self.radio3.setEnabled(False)
        selected = ""
        selected = FreeCADGui.Selection.getSelection()
        if len(selected) != 0:
            self.radio3.setEnabled(True)
        ####
        # Add OK / Cancel buttons
        okbox = QtGui.QDialogButtonBox(self.dialog)
        okbox.setOrientation(QtCore.Qt.Horizontal)
        okbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        la.addWidget(okbox)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("accepted()"), self.proceed)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("rejected()"), self.close)
        QtCore.QMetaObject.connectSlotsByName(self.dialog)
        self.dialog.show()
        self.dialog.exec_()

    def proceed(self):
        global filename
        global nameFile

        param = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macro")# macro path
        macroPath = param.GetString("MacroPath","") + "/"                   # macro path

        filePath = ""
        filePath = self.FreeCAD_ParamGetSet.GetString(u"filePath", filePath)
        filePath = filePath.replace(u"\\","/")      # convert the "\" to "/"

        if filePath == "":
            filePath = self.FreeCAD_ParamGetSet.GetString(u"filePath", macroPath)

        if self.radio1.isChecked() or self.radio2.isChecked():

            OpenName, filefilter = QtGui.QFileDialog.getOpenFileName(None, "Open An Airfoil File", filePath, "*.dat")
            if OpenName != "":
                ####new2
                pathFile      = os.path.dirname(OpenName) + "/"  #1# = C:/Provisoire400/
                racineDrive   = os.path.splitdrive(OpenName)[0]  #2# = C:
                formatFichier = os.path.splitext(OpenName)[1]    #3# = .png
                OpenName      = os.path.splitext(OpenName)[0]    #4# = /home/kubuntu/.FreeCAD/Macro/Texture_007_H #= C:/Provisoire400/image3D
                nameFile      = os.path.basename(OpenName)       #5# = image3D
                SaveNameformatFichier = OpenName + formatFichier #6# = C:/Provisoire400/image3D.png
                pathFileSaveNameformatFichier = pathFile + nameFile + formatFichier #7# = C:/Provisoire400/image3D.png
                ####new2
                self.FreeCAD_ParamGetSet.SetString("filePath", pathFile)

                if self.radio1.isChecked():
                    try:
                        # This produces a scaled Airfoil with a DWire
                        scalefactor=self.s1.value()
                        f1=SaveNameformatFichier
                        importAirfoilDAT.insert(f1,"Unnamed")
                        points = FreeCAD.ActiveDocument.Wire
                        nacaDWire = Draft.scale([points], scale=FreeCAD.Vector(scalefactor,scalefactor,scalefactor), center=FreeCAD.Vector(0.0, 0.0, 0.0), copy=True)
                        nacaDWire.MakeFace = False
                        nacaDWire.Label = nameFile + "_(DWire)(" + str(scalefactor) + ")"
                    except Exception:
                        app.Console.PrintError("Error, not a valid .dat file\n")

                if self.radio2.isChecked():
                    try:
                        # This produces a scaled Airfoil with a BSpline
                        scalefactor=self.s1.value()
                        f1=SaveNameformatFichier
                        importAirfoilDAT.insert(f1,"Unnamed")
                        points = FreeCAD.ActiveDocument.Wire.Points
                        bspline = Draft.make_bspline(points, closed=True)
                        App.getDocument('Unnamed').recompute()
                        nacaBSpline = Draft.scale(bspline, scale=FreeCAD.Vector(scalefactor,scalefactor,scalefactor), center=FreeCAD.Vector(0.0, 0.0, 0.0), copy=True)
                        nacaBSpline.MakeFace = False
                        nacaBSpline.Label = nameFile + "_(BSpline)(" + str(scalefactor) + ")"
                        App.activeDocument().removeObject(bspline.Name)
                    except Exception:
                        app.Console.PrintError("Error, not a valid .dat file\n")

                try:    
                    App.getDocument("Unnamed").getObject(nameFile).removeObjectsFromDocument()
                    App.getDocument('Unnamed').removeObject(nameFile)
                    App.getDocument('Unnamed').recompute()
                except Exception:
                    None

                Gui.SendMsgToActiveView("ViewFit")
            self.close()    # close the window

        if self.radio3.isChecked():

            SaveName, Filter = QtGui.QFileDialog.getSaveFileName(None, "Save An Airfoil File", filePath, "*.dat")
            if SaveName != "":
                ####new2
                pathFile      = os.path.dirname(SaveName) + "/"  #1# = C:/Provisoire400/
                racineDrive   = os.path.splitdrive(SaveName)[0]  #2# = C:
                formatFichier = os.path.splitext(SaveName)[1]    #3# = .png
                SaveName      = os.path.splitext(SaveName)[0]    #4# = /home/kubuntu/.FreeCAD/Macro/Texture_007_H #= C:/Provisoire400/image3D
                nameFile      = os.path.basename(SaveName)       #5# = image3D
                SaveNameformatFichier = SaveName + formatFichier #6# = C:/Provisoire400/image3D.png
                pathFileSaveNameformatFichier = pathFile + nameFile + formatFichier #7# = C:/Provisoire400/image3D.png
                ####new2
                self.FreeCAD_ParamGetSet.SetString("filePath", pathFile)

                if "." in SaveNameformatFichier:
                    None
                else:
                    SaveNameformatFichier += ".dat"    # Mint

                try:
                    selected = FreeCADGui.Selection.getSelection()[0]
                    pointsDirection = []
                    pointsDirection = selected.Shape.discretize(Number=self.numberCut)  # discretize pour calculer la direction (avec un deuxieme point)

                    f = open(SaveNameformatFichier, 'w')     # path to write
                    f.write("NACA" + nameFile + "\n")        # title 

                    for coor in pointsDirection:
                        f.write(" " + str(round(coor.x, 5)) + "  " + str(round(coor.y, 5)) + "\n")

                    f.close()     # close the file
                except Exception:
                    app.Console.PrintError("Error, to Save .dat file\n")
            self.close()  # close the window

    def close(self):
        self.dialog.hide()

AirfoilImporterAndScaler()

</pre>
<div class="toccolours mw-collapsible mw-collapsed">
<h2><span class="mw-headline" id="Old_versions">Old versions</span></h2>
<div class="mw-collapsible-content">
<p><span id="How_To_Use_-_Version_1.5"></span>
</p>
<div class="mw-translate-fuzzy">
<h2><span id="Jak_pou.C5.BE.C3.ADvat_-_verze_1.5"></span><span class="mw-headline" id="Jak_používat_-_verze_1.5">Jak používat - verze 1.5</span></h2>
</div>
<h4><span class="mw-headline" id="Select_The_File_2">Select The File</span></h4>
<div class="mw-translate-fuzzy">
<h3><span class="mw-headline" id="Vyberte_soubor">Vyberte soubor</span></h3>
<p>Spuštění makra nejprve zobrazí uživateli prohlížeč souborů, který vám umožní vybrat požadovaný soubor datového souboru. Projděte si, kam jste uložili soubor profilu, vyberte jej a stiskněte Otevřít.
</p>
</div>
<figure class="mw-default-size mw-halign-center" typeof="mw:File"><a class="mw-file-description" href="../File/File_browser.png" title="File browser window for importing .dat airfoil files"><img alt="File browser window for importing .dat airfoil files" decoding="async" height="496" src="../File/File_browser.png" width="859"/></a><figcaption>File browser window for importing .dat airfoil files</figcaption></figure>
<h4><span class="mw-headline" id="Enter_Chord_Length_2">Enter Chord Length</span></h4>
<p>Once the airfoil file has been selected, a new dialog will appear asking for a chord length. Any length may be entered, in millimeters. Once your desired length is entered, the Macro will produce a Draft Wire (DWire) following the points described in the previously selected .dat airfoil file at the scale you entered for the chord length. 
</p>
<figure class="mw-default-size mw-halign-center" typeof="mw:File"><a class="mw-file-description" href="../File/Chord_length.png" title="Chord length dialog for import and scale macro v1.5"><img alt="Chord length dialog for import and scale macro v1.5" decoding="async" height="146" src="../File/Chord_length.png" width="378"/></a><figcaption>Chord length dialog for import and scale macro v1.5</figcaption></figure>
<p>Křídlový profil, správně měřítko, by nyní měl být ve vašem projektu připraven k použití.
</p>
<h3><span class="mw-headline" id="How_To_Use_-_Version_2">How To Use - Version 2</span></h3>
<div class="mw-translate-fuzzy">
<h2><span id="Jak_pou.C5.BE.C3.ADvat_-_verze_2"></span><span class="mw-headline" id="Jak_používat_-_verze_2">Jak používat - verze 2</span></h2>
<p>Volba souboru je stejná jako verze 1.5. S verzí 2 máte nyní možnost mít buď výsledný profil vytvořený pomocí DWire nebo Basic Spline (BSpline). Stejně jako u verze 1.5 zadáte požadovanou délku. Dále můžete vybrat, který typ fólie chcete. Stačí kliknout na přepínač BSpline nebo nechat jako výchozí DWire.
</p>
</div>
<figure class="mw-default-size mw-halign-center" typeof="mw:File"><a class="mw-file-description" href="../File/V2_scale.png" title="Version 2 Airfoil Import and scale dialog with choice of DWire or BSpline"><img alt="Version 2 Airfoil Import and scale dialog with choice of DWire or BSpline" decoding="async" height="189" src="../File/V2_scale.png" width="378"/></a><figcaption>Version 2 Airfoil Import and scale dialog with choice of DWire or BSpline</figcaption></figure>
<h3><span class="mw-headline" id="The_Macros">The Macros</span></h3>
<p><span id="Version_1.5"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span class="mw-headline" id="Version_1.5">Version 1.5</span></h3>
</div>
<p><b>Macro_Airfoil_Import_&amp;_Scale.FCMacro</b>
</p>
<pre># # # #
#
# AIRFOIL IMPORT &amp; SCALE v1.5
# 
# Imports and scales an Airfoil in the form of a Draft Wire (DWire) 
#
# # # #


from PySide import QtCore, QtGui
from PySide.QtGui import QLineEdit
import FreeCAD, FreeCADGui, Draft
import importAirfoilDAT

# Select .dat airfoil data file to be imported

filename = QtGui.QFileDialog.getOpenFileName(QtGui.qApp.activeWindow(),'Open An Airfoil File','*.dat')

class p():

    def proceed(self):
            try:
                
                # This produces a scaled Airfoil with a DWire

                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
            
            except:
                FreeCAD.Console.PrintError("Error, not a valid .dat file\n")

            self.close()

    def close(self):
        self.dialog.hide()

    def __init__(self):
        self.dialog = None
        self.s1 = None

        # Make dialog box and get the scale size

        self.dialog = QtGui.QDialog()
        self.dialog.resize(350,100)
        self.dialog.setWindowTitle("Airfoil Import &amp; Scale")
        la = QtGui.QVBoxLayout(self.dialog)
        t1 = QtGui.QLabel("Chord Length")
        la.addWidget(t1)
        self.s1 = QtGui.QLineEdit()
        la.addWidget(self.s1)

        # Add OK / Cancel buttons

#ori        okbox = QtGui.QDialogButtonBox(self.dialog)
#ori        okbox.setOrientation(QtCore.Qt.Horizontal)
#ori        okbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel -PIPE- QtGui.QDialogButtonBox.Ok)
#        modify original code for install with addon-install cause -PIPE- 05-12-2016 FC 0.16

        okbox = QtGui.QDialogButtonBox(self.dialog)
        okbox.setOrientation(QtCore.Qt.Horizontal)
        okbox.setStandardButtons(QtGui.QDialogButtonBox.Ok)

        cancelbox = QtGui.QDialogButtonBox(self.dialog)
        cancelbox.setOrientation(QtCore.Qt.Horizontal)
        cancelbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel)
        cancelbox.move(0,62)

        la.addWidget(okbox)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("accepted()"), self.proceed)
        QtCore.QObject.connect(cancelbox, QtCore.SIGNAL("rejected()"), self.close)
        QtCore.QMetaObject.connectSlotsByName(self.dialog)
        self.dialog.show()
        self.dialog.exec_()

p()</pre>
<h4><span class="mw-headline" id="Version_2">Version 2</span></h4>
<pre># # # #
#
# AIRFOIL IMPORT &amp; SCALE v2.
# 
# Imports and scales an Airfoil in the form of a Draft Wire (DWire) or Basic Spline (BSpline)
#
# For FreeCAD Versions = or &gt; 0.14 Revision 3077
#
# Works best with OCC/OCE = or &gt; 6.7
#
# # # #


from PySide import QtCore, QtGui
from PySide.QtGui import QLineEdit, QRadioButton
import FreeCAD, FreeCADGui, Draft
import importAirfoilDAT

# Select .dat airfoil data file to be imported

filename = QtGui.QFileDialog.getOpenFileName(QtGui.qApp.activeWindow(),'Open An Airfoil File','*.dat')

class p():

    def proceed(self):
        if self.radio1.isChecked():
            try:
                
                # This produces a scaled Airfoil with a DWire

                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
            
            except:
                FreeCAD.Console.PrintError("Error, not a valid .dat file\n")

            self.close()

        if self.radio2.isChecked():
            try:

                # This produces a scaled Airfoil with a BSpline

                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                points = FreeCAD.ActiveDocument.ActiveObject.Points
                Draft.makeBSpline(points, closed=True)
                Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
                App.getDocument("Unnamed").removeObject("DWire")

            except:
                FreeCAD.Console.PrintError("Error, not a valid .dat file\n")

            self.close()

    def close(self):
        self.dialog.hide()


    def __init__(self):
        self.dialog = None
        self.s1 = None


        # Make dialog box and get the scale size

        self.dialog = QtGui.QDialog()
        self.dialog.resize(350,100)
        self.dialog.setWindowTitle("Airfoil Import &amp; Scale")
        la = QtGui.QVBoxLayout(self.dialog)
        t1 = QtGui.QLabel("Chord Length")
        la.addWidget(t1)
        self.s1 = QtGui.QLineEdit()
        la.addWidget(self.s1)

        # Add radio buttons to select between DWire and BSpline

        self.radio1 = QRadioButton("Make DWire")
        self.radio2 = QRadioButton("Make BSpline")

            # set default to DWire &amp; make radio buttons - Change self.radio1.setChecked(True) to
            # self.radio2.setChecked(True) to set BSpline as default

        self.radio1.setChecked(True)
        la.addWidget(self.radio1)
        la.addWidget(self.radio2)

        # Add OK / Cancel buttons

        okbox = QtGui.QDialogButtonBox(self.dialog)
        okbox.setOrientation(QtCore.Qt.Horizontal)
        okbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        la.addWidget(okbox)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("accepted()"), self.proceed)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("rejected()"), self.close)
        QtCore.QMetaObject.connectSlotsByName(self.dialog)
        self.dialog.show()
        self.dialog.exec_()

p()
</pre>
<h4><span class="mw-headline" id="Version_2.1">Version 2.1</span></h4>
<p>Updated by mangtronix to use PySide instead of PyQt (used in older versions of FreeCAD).
</p>
<pre># # # #
#
# AIRFOIL IMPORT &amp; SCALE v2.1
# 
# Imports and scales an Airfoil in the form of a Draft Wire (DWire) or Basic Spline (BSpline)
#
# For FreeCAD Versions = or &gt; 0.14 Revision 3703
#
# Works best with OCC/OCE = or &gt; 6.7
#
# # # #
 
 
from PySide import QtCore, QtGui
from PySide.QtGui import QLineEdit, QRadioButton
import FreeCAD, FreeCADGui, Draft
import importAirfoilDAT
 
# Select .dat airfoil data file to be imported
 
# PySide returns a tuple (filename, filter) instead of just a string like in PyQt
filename, filefilter = QtGui.QFileDialog.getOpenFileName(QtGui.qApp.activeWindow(),'Open An Airfoil File','*.dat')

class p():
 
    def proceed(self):
        global filename
        if self.radio1.isChecked():
            #if True:
            try:
 
                # This produces a scaled Airfoil with a DWire
 
                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
 
            except Exception, e:
                FreeCAD.Console.PrintError("Error, not a valid .dat file\n")
 
            self.close()
 
        if self.radio2.isChecked():
            try:
 
                # This produces a scaled Airfoil with a BSpline
 
                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                points = FreeCAD.ActiveDocument.ActiveObject.Points
                Draft.makeBSpline(points, closed=True)
                Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
                App.getDocument("Unnamed").removeObject("DWire")
 
            except:
                FreeCAD.Console.PrintError("Error, not a valid .dat file\n")
 
            self.close()
 
    def close(self):
        self.dialog.hide()
 
 
    def __init__(self):
        self.dialog = None
        self.s1 = None
 
 
        # Make dialog box and get the scale size
 
        self.dialog = QtGui.QDialog()
        self.dialog.resize(350,100)
        self.dialog.setWindowTitle("Airfoil Import &amp; Scale")
        la = QtGui.QVBoxLayout(self.dialog)
        t1 = QtGui.QLabel("Chord Length")
        la.addWidget(t1)
        self.s1 = QtGui.QLineEdit()
        la.addWidget(self.s1)
 
        # Add radio buttons to select between DWire and BSpline
 
        self.radio1 = QRadioButton("Make DWire")
        self.radio2 = QRadioButton("Make BSpline")
 
            # set default to DWire &amp; make radio buttons - Change self.radio1.setChecked(True) to
            # self.radio2.setChecked(True) to set BSpline as default
 
        self.radio1.setChecked(True)
        la.addWidget(self.radio1)
        la.addWidget(self.radio2)
 
        # Add OK / Cancel buttons
 
        okbox = QtGui.QDialogButtonBox(self.dialog)
        okbox.setOrientation(QtCore.Qt.Horizontal)
        okbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        la.addWidget(okbox)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("accepted()"), self.proceed)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("rejected()"), self.close)
        QtCore.QMetaObject.connectSlotsByName(self.dialog)
        self.dialog.show()
        self.dialog.exec_()
 
p()
</pre>
<p><span id="Version_2.1.2"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span class="mw-headline" id="Version_2.1.2">Version 2.1.2</span></h3>
</div>
<p>ToolBar icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Airfoil_Import_%26_Scale.png"><img decoding="async" height="64" src="../File/Macro_Airfoil_Import_%26_Scale.png" width="64"/></a></span>
</p><p><b>Macro_Airfoil_Import_&amp;_Scale.FCMacro</b>
</p>
<pre># This Macro, when run, will first provide the user with a file browser to
# locate and select a .dat airfoil text file. Once selected, a chord length is
# entered and upon pressing the OK button, a properly scaled airfoil is
# produced. There are two versions provided here. Version 1.5 should work on
# FreeCAD versions, 0.13 stable as well as all 0.14 versions. Version 2 should
# only be used with FreeCAD versions equal to or greater than 0.14 3077 and
# will work best with versions built with OCE/OCC versions 6.7 or greater (See
# the Wiki page for all available version).
#
# (c) quick61

__Name__ = 'Airfoil Import and Scale'
__Comment__ = 'Imports and scales an Airfoil in the form of a Draft Wire (DWire) or Basic Spline (BSpline)'
__Author__ = "quick61"
__Version__ = '2.1.2'
__Date__ = '2019-07-16'
__License__ = ''
__Web__ = "https://forum.freecad.org/viewtopic.php?f=22&amp;t=5554"
__Wiki__ = "https://www.freecad.org/wiki/Macro_Airfoil_Import_%26_Scale"
__Icon__ = 'https://www.freecad.org/wiki/images/0/0c/Macro_Airfoil_Import_%26_Scale.png'
__Help__ = ''
__Status__ = 'stable'
__Requires__ = 'Freecad &gt;= 0.14.3706'
__Communication__ = ''
__Files__ = ''


import FreeCAD as app
import PySide
from PySide import QtCore, QtGui
from PySide.QtGui import QLineEdit, QRadioButton
import Draft
import importAirfoilDAT


# Select .dat airfoil data file to be imported

# PySide returns a tuple (filename, filter) instead of just a string like in PyQt

global filename
global nameFile

try:
    filename, filefilter = QtGui.QFileDialog.getOpenFileName(QtGui.qApp.activeWindow(), 'Open An Airfoil File', '*.dat')
except Exception:
    param = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macro")# macro path
    path = param.GetString("MacroPath","") + "/"                        # macro path
    filename, filefilter = PySide.QtGui.QFileDialog.getOpenFileName(None, "Open An Airfoil File", path, "*.dat")

nameFile = filename.split("/")[-1][:-4]

class AirfoilImporterAndScaler():
    def __init__(self):
        self.dialog = None
        self.s1 = None

        # Make dialog box and get the scale size
        self.dialog = QtGui.QDialog()
        self.dialog.resize(350,100)
        self.dialog.setWindowTitle("Airfoil Import &amp; Scale")
        la = QtGui.QVBoxLayout(self.dialog)
        t1 = QtGui.QLabel("Chord Length")
        la.addWidget(t1)
        self.s1 = QtGui.QLineEdit()
        la.addWidget(self.s1)

        # Add radio buttons to select between DWire and BSpline
        self.radio1 = QtGui.QRadioButton("Make DWire")
        self.radio2 = QtGui.QRadioButton("Make BSpline")

        # set default to DWire &amp; make radio buttons - Change self.radio1.setChecked(True) to
        # self.radio2.setChecked(True) to set BSpline as default

        self.radio1.setChecked(True)
        la.addWidget(self.radio1)
        la.addWidget(self.radio2)

        # Add OK / Cancel buttons
        okbox = QtGui.QDialogButtonBox(self.dialog)
        okbox.setOrientation(QtCore.Qt.Horizontal)
        okbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        la.addWidget(okbox)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("accepted()"), self.proceed)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("rejected()"), self.close)
        QtCore.QMetaObject.connectSlotsByName(self.dialog)
        self.dialog.show()
        self.dialog.exec_()



    def proceed(self):
        global filename
        global nameFile

        if self.radio1.isChecked():
            try:
                # This produces a scaled Airfoil with a DWire
                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                try:
                    Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
                except Exception:
                    Draft.scale(App.ActiveDocument.ActiveObject,scale=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0.0,0.0,0.0),copy=False)
                
                App.ActiveDocument.ActiveObject.Label = nameFile + "_(DWire)"

            except Exception as e:
                app.Console.PrintError("Error, not a valid .dat file\n")

        if self.radio2.isChecked():
            try:
                # This produces a scaled Airfoil with a BSpline
                scalefactor=float(self.s1.text())
                f1=str(filename)
                importAirfoilDAT.insert(f1,"Unnamed")
                points = app.ActiveDocument.ActiveObject.Points
                App.getDocument("Unnamed").removeObject(App.ActiveDocument.ActiveObject.Name)
                Draft.makeBSpline(points, closed=True)
                try:
                    Draft.scale(App.ActiveDocument.ActiveObject,delta=App.Vector(scalefactor,scalefactor,scalefactor),center=App.Vector(0,0,0),legacy=True)
                except Exception:
                    for i in range(len(points)):
                        Draft.scaleVertex(App.ActiveDocument.ActiveObject, i, App.Vector(scalefactor,scalefactor,scalefactor), App.Vector(0.0,0.0,0.0))

                App.ActiveDocument.ActiveObject.Label = nameFile + "_(BSpline)"

            except:
                app.Console.PrintError("Error, not a valid .dat file\n")

        try:    
            # delete the directory created by importAirfoilDAT
            for obj in App.ActiveDocument.Objects:
                if (obj.TypeId == "App::DocumentObjectGroup") and (obj.Name == nameFile):
                    App.getDocument("Unnamed").removeObject(nameFile)
        except Exception:
            None

        self.close()    # close the window

    def close(self):
        self.dialog.hide()


AirfoilImporterAndScaler()
</pre>
</div>
</div>
<p><span id="Link"></span>
</p>
<h2><span class="mw-headline" id="Odkaz">Odkaz</span></h2>
<div class="mw-translate-fuzzy">
<p>Diskuse o <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=22&amp;t=5554&amp;p=45137&amp;hilit=Airfoil#p45137" rel="nofollow">Forum</a>
</p>
</div>
<p><a class="external text" href="http://aerospace.illinois.edu/m-selig/ads/coord_database.html#N" rel="nofollow">UIUC Applied Aerodynamics Group Departement of Aerospace Engineering</a>
</p>
<!-- 
NewPP limit report
Cached time: 20241214203847
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.071 seconds
Real time usage: 0.131 seconds
Preprocessor visited node count: 262/1000000
Post‐expand include size: 3811/2097152 bytes
Template argument size: 3157/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 26912/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.652      1 -total
 36.00%    3.474      5 Template:MacroCode
 24.30%    2.345      1 Template:Macro/cs
 13.09%    1.264      2 Template:Button
 12.22%    1.179      2 Template:RadioButton
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:33669-0!canonical and timestamp 20241214203847 and revision id 1510485. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
