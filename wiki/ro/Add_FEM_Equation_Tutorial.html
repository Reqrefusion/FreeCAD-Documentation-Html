<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Add FEM Equation Tutorial/ro</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="de" title="Tutorium FEM Gleichung hinzufügen (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="en" title="Add FEM Equation Tutorial (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="fr" title="FEM Tutoriel pour ajouter des équations FEM (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="it" title="Tutorial Aggiungere equazione FEM (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="pl" title="Poradnik: Dodawanie równań w środowisku MES (100% translated)">polski</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" dir="ltr" lang="ro">română</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="ru" title="Руководство по добавлению уравнений в верстак FEM (3% translated)">русский</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img decoding="async" height="32" src="../File/Freecad.svg" width="32"/></span></span> Tutorial
</td></tr>
<tr>
<th class="ctOdd">Topic
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Level
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Time to complete
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Authors
</th></tr>
<tr>
<td class="ctEven"><a class="new" href="index.php?title=User;M42kus&amp;action=edit&amp;redlink=1.html" title="User:M42kus (page does not exist)">M42kus</a>
</td></tr>
<tr>
<th class="ctOdd">FreeCAD version
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Example files
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Nou_tip_de_Equation"><span class="tocnumber">2</span> <span class="toctext">Nou tip de Equation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Obiectul_Elmers_FEM_Solver_Equation"><span class="tocnumber">3</span> <span class="toctext">Obiectul Elmers FEM Solver Equation</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Keywords"><span class="tocnumber">3.1</span> <span class="toctext">Keywords</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Editing_files"><span class="tocnumber">3.2</span> <span class="toctext">Editing files</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Extinderea_Obiectului_Solver"><span class="tocnumber">4</span> <span class="toctext">Extinderea Obiectului Solver</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Extensia_Analizei_Export"><span class="tocnumber">5</span> <span class="toctext">Extensia Analizei Export</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Gui_tool_to_create_an_equation"><span class="tocnumber">6</span> <span class="toctext">Gui tool to create an equation</span></a></li>
</ul>
</div>
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>În acest tutorial vom adăuga ecuația de flux la FreeCAD și vom implementa suport pentru Elmer FEM Solver. Asigurați-vă că ați citit și ați înțeles <a href="Extend_FEM_Module.html" title="Extend FEM Module"> Extend FEM Module</a> înainte de a citi acest tutorial.
</p><p>Sarcina poate fi împărțită în patru părți. Primul pas este de a face bancul de lucru FEM conștient de un nou tip de ecuație. Această etapă ar trebui efectuată numai dacă ecuația nu există în fluxul FreeCAD (spre deosebire de ecuația care există deja în FreeCAD, dar nu este suportată de solverul țintă). Al doilea pas este de a adăuga un obiect tip document concret la ecuația specifică a lui Elmer FEM Solver. Al treilea pas este să adăugăm sprijin pentru noua ecuație obiectului solver al lui Elmer. După ce analiza Elmer trebuie extinsă pentru a susține noul tip de ecuație.
</p><p><span id="New_equation_type"></span>
</p>
<h2><span class="mw-headline" id="Nou_tip_de_Equation">Nou tip de Equation</span></h2>
<p>In this step we are going to modify the following file:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/equationbase.py</span></li></ul>
<p>The equation type is shared among all equation objects of the different solvers. Each type has a string specifier (e.g. "Heat") and a dedicated command that adds the equation to the selected solver. This allows for a simpler GUI where we have only one button for the heat equation which is used for all supported solver.
</p><p>First, add the new equation to the <code>equationbase.py</code> module. Each equation requires two classes. A document proxy and a view proxy. Those two classes will later be used as base classes for the Elmer-specific equation classes. Just copy-paste them from an existing equation type and adjust the icon path inside <code>getIcon(self)</code> of the view proxy.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">FlowProxy</span><span class="p">(</span><span class="n">BaseProxy</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">FlowViewProxy</span><span class="p">(</span><span class="n">BaseViewProxy</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">":/icons/FEM_EquationFlow.svg"</span>
</pre></div>
<p><span id="New_Elmer's_equation_object"></span>
</p>
<h2><span class="mw-headline" id="Obiectul_Elmers_FEM_Solver_Equation">Obiectul Elmers FEM Solver Equation</span></h2>
<p>În acest pas vom modifica următoarele fișiere:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/elmer/equations/flow.py</span></li></ul>
<p>și adăugați următorul fișier nou:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/ObjectsFem.py</span></li>
<li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/CMakeLists.txt</span></li></ul>
<p>Să începem cu modulul care implementează obiectul documentului. In poate fi copiat dintr-o ecuație existentă. Dacă noua ecuație acceptă numai cuvintele cheie pentru sistemele liniare FemSolver/Elmer/Equations/Elasticity.py module. În cazul în care acceptă cuvinte cheie neliniare prea copiate FemSolver/Elmer/Equations/Heat.py. Ecuația de curgere este o posibilă ecuație neliniară. Aceasta înseamnă că ne vom baza munca Heat.py.
</p>
<h3><span class="mw-headline" id="Keywords">Keywords</span></h3>
<ul><li>If the new equation only supports keywords for <b>linear</b> systems copy the <code>femsolver/elmer/equations/elasticity.py</code> module.</li>
<li>If the new equation supports keywords for both <b>linear</b> and <b>non-linear</b> systems, copy <code>femsolver/elmer/equations/heat.py</code>.</li></ul>
<p>The flow equation in Elmer is a potentially non-linear equation. This means that we are going to base our work on <code>heat.py</code>.
</p>
<h3><span class="mw-headline" id="Editing_files">Editing files</span></h3>
<p>După copiere Heat.py to Flow.py adjust - argumentul de nume al funcției de creare a modulului, - atributul Type al clasei Proxy, - - clasele de bază ale proxy - ului și ale ViewProxy classes, - și proprietățile adăugate prin funcția obj.addProperty(..) de cele necesare ecuației.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"'''Flow'''"</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">femutils</span><span class="o">.</span><span class="n">createObject</span><span class="p">(</span>
        <span class="n">doc</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Proxy</span><span class="p">,</span> <span class="n">ViewProxy</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Proxy</span><span class="p">(</span><span class="n">nonlinear</span><span class="o">.</span><span class="n">Proxy</span><span class="p">,</span> <span class="n">equationbase</span><span class="o">.</span><span class="s1">'''Flow'''</span><span class="n">Proxy</span><span class="p">):</span>

    <span class="n">Type</span> <span class="o">=</span> <span class="s2">"Fem::EquationElmer'''Flow'''"</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Proxy</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Priority</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">class</span> <span class="nc">ViewProxy</span><span class="p">(</span><span class="n">nonlinear</span><span class="o">.</span><span class="n">ViewProxy</span><span class="p">,</span> <span class="n">equationbase</span><span class="o">.</span><span class="s1">'''Flow'''</span><span class="n">ViewProxy</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Then you need to change the properties added via the <code>obj.addProperty(..)</code> function to those needed by the equation.
</p><p>În momentul în care scrieți acest tutorial Consultați ecuația de elasticitate Elmer FEM Solver pentru un exemplu cu proprietăți.
</p><p>Finally one has to register a <b>makeEquationFlow</b> definition in <code>src/Mod/Fem/ObjectsFem.py</code> by duplicating an available entry.
</p><p>Nu în ultimul rând, înregistrați noul fișier modul (Flow.py) în ambele fișiere CMakeLists.txt modul descris în <a class="external text" href="https://www.freecadweb.org/wiki/Extend_FEM_Module" rel="nofollow">Extend FEM Module</a>. Listele potrivite pot fi găsite prin căutarea fișierelor de module de ecuație existente ale lui Elmer FEM Solver.
</p><p><span id="Extend_Solver_Object"></span>
</p>
<h2><span class="mw-headline" id="Extinderea_Obiectului_Solver">Extinderea Obiectului Solver</span></h2>
<p>În acest pas vom modifica următorul fișier:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/elmer/solver.py</span></li></ul>
<p>Pentru moment, FreeCAD a realizat că există un nou tip de ecuație și a adăugat o comandă care adaugă această ecuație obiectului solver selectat. Am implementat, de asemenea, un obiect de ecuații concrete pentru Elmer.Ceea ce trebuie să facem acum pentru a face legătura dintre elmer și ecuația de curgere. Acesta trebuie să se facă direct în obeictul Elmer FEM solver.
</p><p>Înregistrați modulul în care am introdus noul nostru obiect de ecuații (Flow.py) wcu ecuația specificată din pasul 1("Flow") în lista Proxy._EQUATIONS în Elmer/Object.py.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">.equations</span> <span class="kn">import</span> <span class="n">electrostatic</span>
<span class="o">+</span><span class="kn">from</span> <span class="nn">.equations</span> <span class="kn">import</span> <span class="n">flow</span>

<span class="o">...</span>

<span class="n">_EQUATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Heat"</span><span class="p">:</span> <span class="n">heat</span><span class="p">,</span>
    <span class="s2">"Elasticity"</span><span class="p">:</span> <span class="n">elasticity</span><span class="p">,</span>
<span class="o">+</span>    <span class="s2">"Flow"</span><span class="p">:</span> <span class="n">flow</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
<p><span id="Extend_writer_object"></span>
</p>
<h2><span class="mw-headline" id="Extensia_Analizei_Export">Extensia Analizei Export</span></h2>
<p>În acest pas vom modifica următorul fișier:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/elmer/writer.py</span></li></ul>
<p>Aceasta este cea mai pretențioasă parte a implementării unei noi ecuații. Acest fișier conține o clasă Writer care exportă analiza în format Elmer FEM Solver sif.
</p><p>Pentru fiecare ecuație suportată există o serie de metode de manipulare a exportului ecuației respective. Trebuie doar să copiați toate ecuațiile existente și să le ajustați la nevoile dvs. Ecuația fluxului nostru folosește următoarele metode:
</p>
<ul><li><code>_getFlowSolver</code></li>
<li><code>_handleFlow</code></li></ul>
<p>You need to register the <code>_handleFlow</code> method inside the <code>Writer</code> class:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">Writer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handleFlow</span><span class="p">()</span>

<span class="o">...</span>
</pre></div>
<p><code>_handleFlow</code> can control a series of other detailed methods. Our flow equation uses the following detailed methods:
</p>
<ul><li><code>_handleFlowConstants</code></li>
<li><code>_handleFlowMaterial</code></li>
<li><code>_handleFlowInitialVelocity</code></li>
<li><code>_handleFlowBndConditions</code></li>
<li><code>_handleFlowEquation</code></li></ul>
<p>We now finished the function part of the new equation. Next, we'll connect the new equation through the GUI.
</p>
<h2><span class="mw-headline" id="Gui_tool_to_create_an_equation">Gui tool to create an equation</span></h2>
<p>We have just created a new equation class. To access it from the FEM GUI, we need to create a button and link it to the new equation class. Here is a tutorial: <a href="Add_Button_to_FEM_Toolbar_Tutorial.html" title="Add Button to FEM Toolbar Tutorial">Add Button to FEM Toolbar Tutorial</a>.
</p>
<!-- 
NewPP limit report
Cached time: 20241129213253
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.066 seconds
Real time usage: 0.572 seconds
Preprocessor visited node count: 255/1000000
Post‐expand include size: 2369/2097152 bytes
Template argument size: 1309/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 4/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 6183/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  481.091      1 -total
 98.55%  474.119      4 Template:Code
  0.43%    2.064      1 Template:TutorialInfo/ro
  0.36%    1.714     17 Template:Incode
  0.27%    1.315      6 Template:FileName
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:105679-0!canonical and timestamp 20241129213253 and revision id 1354685. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
