<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Extend FEM Module/ro</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../de\Extend_FEM_Module.html" lang="de" title="FEM Modul Erweitern (29% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Extend_FEM_Module.html" lang="en" title="Extend FEM Module (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../es\Extend_FEM_Module.html" lang="es" title="Extend FEM Module (17% translated)">español</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../fr\Extend_FEM_Module.html" lang="fr" title="FEM Module d'extension (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--med" dir="ltr" href="../it\Extend_FEM_Module.html" lang="it" title="Estendere il modulo FEM (54% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../pl\Extend_FEM_Module.html" lang="pl" title="Rozszerzenie modułu MES (100% translated)">polski</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--low" dir="ltr" lang="ro">română</span></li>
<li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../ru\Extend_FEM_Module.html" lang="ru" title="Расширение рабочей среды верстака МКЭ (25% translated)">русский</a></li></ul></div>
<div class="mw-translate-fuzzy">
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img decoding="async" height="32" src="../File/Freecad.svg" width="32"/></span></span> Tutorial
</td></tr>
<tr>
<th class="ctOdd">Topic
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Level
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Time to complete
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Authors
</th></tr>
<tr>
<td class="ctEven"><a class="new" href="../index.php?title=User;M42kus&amp;action=edit&amp;redlink=1.html" title="User:M42kus (page does not exist)">M42kus</a>
</td></tr>
<tr>
<th class="ctOdd">FreeCAD version
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">Example files
</th></tr>
<tr>
<td class="ctEven">
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Build_System_(cmake)"><span class="tocnumber">1</span> <span class="toctext">Build System (cmake)</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Source_Organization"><span class="tocnumber">2</span> <span class="toctext">Source Organization</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Rezolvitor"><span class="tocnumber">3</span> <span class="toctext">Rezolvitor</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Ecuații"><span class="tocnumber">4</span> <span class="toctext">Ecuații</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Constrângeri"><span class="tocnumber">5</span> <span class="toctext">Constrângeri</span></a></li>
</ul>
</div>
</td></tr></tbody></table>
</div>
<div class="mw-translate-fuzzy">
<p>Atelierul FEM deja suportă o mulțime de constrângeri diferite și un buchet de rezolvitori. Despite that people often need constraints not jet supported by FreeCAD. This page is the starting point to a series of tutorials and other resources describing how to extend the FEM workbench using the existing framework. While this series can prove helpful to software developers too the idea is to allow FEM users with a bit of interrest into python coding to add the stuff they need themselfs.
</p>
</div>
<p>Adăugarea de noi constrângeri, ecuatții sau rezolvitori este în cea mai mare parte o activitate de rutină. Dar a face acest lucru pentru prima dată nu va părea ușor. An understanding of the following topics will prove helpful:
</p>
<div class="mw-translate-fuzzy">
<ul><li>Python scripting in FreeCAD.
<ul><li><a href="../Python_scripting_tutorial.html" title="Python scripting tutorial">FreeCAD Scripting Tutorial</a></li>
<li><a href="../FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics">FreeCAD Scripting Basics</a></li></ul></li>
<li>Extending FreeCAD with Python.
<ul><li><a href="../Scripted_objects.html" title="Scripted objects">Scripted Objects</a></li></ul></li>
<li>A solid understanding of the solver for which new objects shall be added (e.g. calculix) is important.</li>
<li>A little knowledge about build systems, especially cmake (build system used by FreeCAD)</li></ul>
</div>
<h2><span id="Build_System_.28cmake.29"></span><span class="mw-headline" id="Build_System_(cmake)">Build System (cmake)</span></h2>
<div class="mw-translate-fuzzy">
<p>The build system must be modified regardless of which objects shall be added o the FEM workbench. Every python module (file) must be registerd. The FEM workbench even requries every new python module to be registerd twice. Once in Mod/Fem/CMakeLists.txt and a secound time in Mod/Fem/App/CMakeLists.txt. This is true regaredless of the type of the python module (gui or non-gui). Where exactely the module must be inserted depends on the role of the module. Solver, equations and constraints all use different lists. Searching for similar files and inserting the new file in the same list works most of the time.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>As an example lets add a new constraint pressure. A new constraint requires at least the following new modules: FemConstraint&lt;name&gt;.py, ViewProviderFemConstraint&lt;name&gt;.py, CommandFemConstraint&lt;name&gt;.py. These three files must be added to CMakeLists.txt as well as App/CMakeLists.txt.
</p>
</div>
<p><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">Mod/Fem/CMakeLists.txt</span>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">SET</span><span class="p">(</span><span class="n">FemObjects_SRCS</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">base_fempythonobject</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">constraint_bodyheatsource</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">constraint_electrostaticpotential</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">constraint_flowvelocity</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">constraint_initialflowvelocity</span><span class="o">.</span><span class="n">py</span>
<span class="o">+</span>   <span class="n">femobjects</span><span class="o">/</span><span class="n">constraint_initialflowpressure</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">constraint_selfweight</span><span class="o">.</span><span class="n">py</span>
<span class="o">...</span>
    <span class="n">femobjects</span><span class="o">/</span><span class="n">solver_ccxtools</span><span class="o">.</span><span class="n">py</span>
<span class="p">)</span>
<span class="o">...</span>
<span class="n">SET</span><span class="p">(</span><span class="n">FemGuiViewProvider_SRCS</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_base_femconstraint</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_base_femobject</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_constraint_bodyheatsource</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_constraint_electrostaticpotential</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_constraint_flowvelocity</span><span class="o">.</span><span class="n">py</span>
<span class="o">+</span>   <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_constraint_flowpressure</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_constraint_initialflowvelocity</span><span class="o">.</span><span class="n">py</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_constraint_selfweight</span><span class="o">.</span><span class="n">py</span>
<span class="o">...</span>
    <span class="n">femviewprovider</span><span class="o">/</span><span class="n">view_solver_ccxtools</span><span class="o">.</span><span class="n">py</span>
<span class="p">)</span>
</pre></div>
<h2><span class="mw-headline" id="Source_Organization">Source Organization</span></h2>
<div class="mw-translate-fuzzy">
<p>For organizing the python code the FEM module uses a similar abbroach to that used for the C++ code thoughout FreeCAD. The module is split into two packages. PyObjects, which contains all non-gui like python proxies for document objects and PyGui containing everything gui related like python proxies for view provider, task panels, ui files and commands.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>One package doesn't follow this pattern: FemSolver. It has its place on the same level as PyObjects and PyGui (src/Mod/Fem/FemSolver). The package contains solver and equation related packages and modules and it is organized the following way:
</p>
</div>
<pre>.femsolver
.femsolver.elmer
.femsolver.elmer.equations
.femsolver.calculix
.femsolver.calculix.equations
.femsolver.z88
.femsolver.z88.equations
</pre>
<p><span id="Solver"></span>
</p>
<h2><span class="mw-headline" id="Rezolvitor">Rezolvitor</span></h2>
<div class="mw-translate-fuzzy">
<p>In FreeCAD a solver can be split into two parts. One is the document object used by the user to interact with the solver. Though it solver parameter can be set and it is also used to control the solving process. The other one are the so called tasks of a solver. The solving process is split into those tasks, namely: check, prepare, solve and results. Those do the actual work of exporting the analysis into a format understood by the solver executable, starting the executable and loading the results back into FreeCAD.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>Most files related to a solver reside in a sub-package of the FemSolver package (e.g. FemSolver.Elmer). The following list enumerates all files related to the implementation of a solver. Those are the files that need to be copied and modified to add support for a new solver to FreeCAD.
</p>
</div>
<div class="mw-translate-fuzzy">
<ul><li><b>FemSolver/Elmer/Object.py:</b> Document object visible in the tree-view. Implemented in python via a document proxy and view proxy.</li>
<li><b>FemSolver/Elmer/Tasks.py:</b> Module containing one task class per task required for a solver implementation. Those tasks divide the process of solving a analysis into the following steps: check, prepare, solve, results.</li>
<li><b>PyGui/_CommandFemElmer.py:</b> Adds the solver document object to the active document. Required to access the solver object from the GUI.</li></ul>
</div>
<p><span id="Equations"></span>
</p>
<h2><span id="Ecua.C8.9Bii"></span><span class="mw-headline" id="Ecuații">Ecuații</span></h2>
<div class="mw-translate-fuzzy">
<p>An equation represets a particular physics that shall be considered when solving the analysis (e.g. Flow, Heat). Not all solver in FreeCAD support equations. Equations are represented by child objects of the corresponding solver object. In the tree-view this looks like this:
</p>
</div>
<div class="mw-translate-fuzzy">
<ul><li>ElmerSolver
<ul><li>Elasticity</li>
<li>Heat</li>
<li>Flow</li></ul></li></ul>
</div>
<div class="mw-translate-fuzzy">
<p>Most solver specific options (max iterations, method of solving, etc) are set via the equation objects. One consequence of this is that each solver must have it's own implementation of "the same" equation. Calculix would have a different Heat object that Elmer. To avoid having multiple buttons for the same physics in the GUI each solver object adds it's equations itself.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>The actual implementation can be split into the generic and the solver specific part. The generic part can be found in the FemSolver.EquationBase module. The solver specific part resides inside individual Equations sub-packages of the solver packages (e.g. FemSolver/Elmer/Equations).
</p>
</div>
<div class="mw-translate-fuzzy">
<p>Adding a new equations to elmer should be very easy. For newcomers there exists a tutorial which shows how to add a new equation to elmer by adding the existing elasticity solver to FreeCAD: <a href="../Add_FEM_Equation_Tutorial.html" title="Add FEM Equation Tutorial">Add FEM Equation Tutorial</a>.
</p>
</div>
<p><span id="Constraints"></span>
</p>
<h2><span id="Constr.C3.A2ngeri"></span><span class="mw-headline" id="Constrângeri">Constrângeri</span></h2>
<p>Constrângerile definesc condițiile limită pentru problema care trebuie rezolvată. În FreeCAD constrângerile nu sunt specifice unui anumit rezolvitor. O problemă definită poate fi rezolvată de toțși rezolvitorii care suportă toate condițiile analizei.
</p>
<div class="mw-translate-fuzzy">
<p>Adăugarea de noi constrângeri este destul de simplă. Pentru nou-veniți, există un tutorial: <a href="../Add_FEM_Constraint_Tutorial.html" title="Add FEM Constraint Tutorial">Add FEM Constraint Tutorial</a>.
</p>
</div>
<!-- 
NewPP limit report
Cached time: 20241214203049
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.055 seconds
Real time usage: 0.088 seconds
Preprocessor visited node count: 92/1000000
Post‐expand include size: 920/2097152 bytes
Template argument size: 978/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 1/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 5244/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   11.848      1 -total
 58.90%    6.979      1 Template:TutorialInfo/ro
 22.04%    2.611      1 Template:Code
 17.45%    2.067      1 Template:FileName
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:106227-0!canonical and timestamp 20241214203049 and revision id 1289703. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
