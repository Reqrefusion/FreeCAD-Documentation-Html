<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Code snippets/ro</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../id\Code_snippets.html" lang="id" title="Code snippets (1% translated)">Bahasa Indonesia</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../de\Code_snippets.html" lang="de" title="Code Schnipsel (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Code_snippets.html" lang="en" title="Code snippets (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../tr\Code_snippets.html" lang="tr" title="Code snippets (1% translated)">Türkçe</a></li>
<li><a class="mw-pt-progress mw-pt-progress--high" dir="ltr" href="../es\Code_snippets.html" lang="es" title="Fragmentos Código (68% translated)">español</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../fr\Code_snippets.html" lang="fr" title="Extraits de codes (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../it\Code_snippets.html" lang="it" title="Frammenti di codice (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../pl\Code_snippets.html" lang="pl" title="Wycinki kodów (100% translated)">polski</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--low" dir="ltr" lang="ro">română</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../sv\Code_snippets.html" lang="sv" title="Code snippets (12% translated)">svenska</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../cs\Code_snippets.html" lang="cs" title="Code snippets (1% translated)">čeština</a></li>
<li><a class="mw-pt-progress mw-pt-progress--med" dir="ltr" href="../ru\Code_snippets.html" lang="ru" title="Code snippets (43% translated)">русский</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../ja\Code_snippets.html" lang="ja" title="Code snippets (10% translated)">日本語</a></li></ul></div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Snippets"><span class="tocnumber">2</span> <span class="toctext">Snippets</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Un_fișier_tipic_InitGui.py"><span class="tocnumber">2.1</span> <span class="toctext">Un fișier tipic InitGui.py</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Un_fișier_modul_tipic"><span class="tocnumber">2.2</span> <span class="toctext">Un fișier modul tipic</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Importul_unui_nou_tip_de_fișier"><span class="tocnumber">2.3</span> <span class="toctext">Importul unui nou tip de fișier</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Adăugarea_unei_linii_(segment)"><span class="tocnumber">2.4</span> <span class="toctext">Adăugarea unei linii (segment)</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Adăugarea_unui_poligon"><span class="tocnumber">2.5</span> <span class="toctext">Adăugarea unui poligon</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Adăugarea_și_îndepărtarea_unui_obiect_într-un_grup"><span class="tocnumber">2.6</span> <span class="toctext">Adăugarea și îndepărtarea unui obiect într-un grup</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Adăugarea_unei_plase"><span class="tocnumber">2.7</span> <span class="toctext">Adăugarea unei plase</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Adăugarea_unui_cerc_sau_a_unui_arc_de_cerc"><span class="tocnumber">2.8</span> <span class="toctext">Adăugarea unui cerc sau a unui arc de cerc</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Accesarea_și_schimbarea_reprezentării_unui_obiect"><span class="tocnumber">2.9</span> <span class="toctext">Accesarea și schimbarea reprezentării unui obiect</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Replace_the_form_of_mouse_with_one_image"><span class="tocnumber">2.10</span> <span class="toctext">Replace the form of mouse with one image</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Replace_the_form_of_mouse_with_one_image_(cross)_include"><span class="tocnumber">2.11</span> <span class="toctext">Replace the form of mouse with one image (cross) include</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Observe_camera_change_in_the_3D_viewer_via_Python"><span class="tocnumber">2.12</span> <span class="toctext">Observe camera change in the 3D viewer via Python</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Observarea_evenimentelor_mouse-ului_în_vizualizatorul_3D_via_Python"><span class="tocnumber">2.13</span> <span class="toctext">Observarea evenimentelor mouse-ului în vizualizatorul 3D via Python</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Afișați_tastele_apăsate_și_evenimentele_comenzi"><span class="tocnumber">2.14</span> <span class="toctext">Afișați tastele apăsate și evenimentele comenzi</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Manipularea_de_scene_grafice_în_Python"><span class="tocnumber">2.15</span> <span class="toctext">Manipularea de scene grafice în Python</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Adăugarea_și_eliminarea_obiectelor_în_/_de_la_scena_de_grafică"><span class="tocnumber">2.16</span> <span class="toctext">Adăugarea și eliminarea obiectelor în / de la scena de grafică</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Salvați_sceneGraph_cu_o_rotație_într-o_serie_de_36_fișiere_în_axele_X_Y_Z"><span class="tocnumber">2.17</span> <span class="toctext">Salvați sceneGraph cu o rotație într-o serie de 36 fișiere în axele X Y Z</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Adăugarea_de_widget-uri_personalizate_la_interfață"><span class="tocnumber">2.18</span> <span class="toctext">Adăugarea de widget-uri personalizate la interfață</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Adăugarea_unui_tab_în_vizualizarea_Combo"><span class="tocnumber">2.19</span> <span class="toctext">Adăugarea unui tab în vizualizarea Combo</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Activați_sau_dezactivați_o_fereastră"><span class="tocnumber">2.20</span> <span class="toctext">Activați sau dezactivați o fereastră</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Deschiderea_unei_pagini_web_personalizate"><span class="tocnumber">2.21</span> <span class="toctext">Deschiderea unei pagini web personalizate</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Obținerea_conținutului_HTML_al_unei_pagini_Web_deschise"><span class="tocnumber">2.22</span> <span class="toctext">Obținerea conținutului HTML al unei pagini Web deschise</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Recuperați_și_utilizați_coordonatele_a_3_puncte_sau_obiecte_selectate"><span class="tocnumber">2.23</span> <span class="toctext">Recuperați și utilizați coordonatele a 3 puncte sau obiecte selectate</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Listarea_tuturor_obeictelor"><span class="tocnumber">2.24</span> <span class="toctext">Listarea tuturor obeictelor</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Listează_dimensiunile_unui_obiect,_având_în_vedere_numele_acestuia"><span class="tocnumber">2.25</span> <span class="toctext">Listează dimensiunile unui obiect, având în vedere numele acestuia</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Funcția_rezidentă_cu_acțiunea_clicului_mouse-ului"><span class="tocnumber">2.26</span> <span class="toctext">Funcția rezidentă cu acțiunea clicului mouse-ului</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Display_the_active_document"><span class="tocnumber">2.27</span> <span class="toctext">Display the active document</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#căutarea_și_selecția_tuturor_elementelor_de_sub_cursor"><span class="tocnumber">2.28</span> <span class="toctext">căutarea și selecția tuturor elementelor de sub cursor</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Lista_componentelor_unui_obiect"><span class="tocnumber">2.29</span> <span class="toctext">Lista componentelor unui obiect</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Lista_PropertiesList"><span class="tocnumber">2.30</span> <span class="toctext">Lista PropertiesList</span></a></li>
<li class="toclevel-2 tocsection-33"><a href='#Adăugarea_unei_proprietăți_"Comentariu"'><span class="tocnumber">2.31</span> <span class="toctext">Adăugarea unei proprietăți "Comentariu"</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Căutarea_și_extracția_datelor"><span class="tocnumber">2.32</span> <span class="toctext">Căutarea și extracția datelor</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Căutarea_Manuală_a_unui_element_având_eticheta_sa"><span class="tocnumber">2.33</span> <span class="toctext">Căutarea Manuală a unui element având eticheta sa</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Coordonate_Carteziene"><span class="tocnumber">2.34</span> <span class="toctext">Coordonate Carteziene</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Selectați_toate_obiectele_în_document"><span class="tocnumber">2.35</span> <span class="toctext">Selectați toate obiectele în document</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Selectarea_fațetei_unui_obiect"><span class="tocnumber">2.36</span> <span class="toctext">Selectarea fațetei unui obiect</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_Face_(r.Q)"><span class="tocnumber">2.37</span> <span class="toctext">Get the normal vector of a face of an object by Name object and number Face (r.Q)</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_of_Face"><span class="tocnumber">2.38</span> <span class="toctext">Get the normal vector of a face of an object by Name object and number of Face</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Get_the_normal_vector_of_an_object_selected_and_number_of_Face"><span class="tocnumber">2.39</span> <span class="toctext">Get the normal vector of an object selected and number of Face</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Determinarea_vectorului_normal()_la_o_suprafață"><span class="tocnumber">2.40</span> <span class="toctext">Determinarea vectorului normal() la o suprafață</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Get_the_normal_vector_of_the_face_and_create_a_line_at_the_point_mouse_clicked"><span class="tocnumber">2.41</span> <span class="toctext">Get the normal vector of the face and create a line at the point mouse clicked</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Get_the_normal_vector_of_a_surface_from_a_STL_file"><span class="tocnumber">2.42</span> <span class="toctext">Get the normal vector of a surface from a STL file</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#Crearea_unui_obiect_față_de_poziția_Camerei_foto"><span class="tocnumber">2.43</span> <span class="toctext">Crearea unui obiect față de poziția  Camerei foto</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Citirea_și_Scrierea_unei_Expresii"><span class="tocnumber">2.44</span> <span class="toctext">Citirea și Scrierea unei Expresii</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Create_a_Sketch_on_a_Surface_in_PartDesign"><span class="tocnumber">2.45</span> <span class="toctext">Create a Sketch on a Surface in PartDesign</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#How_to_Simulate_a_Mouse_Click_at_a_given_Coordinate"><span class="tocnumber">2.46</span> <span class="toctext">How to Simulate a Mouse Click at a given Coordinate</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#How_to_create_a_face_with_holes_using_Python_API"><span class="tocnumber">2.47</span> <span class="toctext">How to create a face with holes using Python API</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Close_and_restart_FreeCAD"><span class="tocnumber">2.48</span> <span class="toctext">Close and restart FreeCAD</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-51"><a href="#Coin3D"><span class="tocnumber">3</span> <span class="toctext">Coin3D</span></a></li>
<li class="toclevel-1 tocsection-52"><a href="#Related"><span class="tocnumber">4</span> <span class="toctext">Related</span></a></li>
</ul>
</div>
</div>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<div class="mw-translate-fuzzy">
<p>Această pagină conține exemple, extrase, fragmente de cod Python de la FreeCAD, colectate din experiențele utilizatorilor și discuțiile pe forumuri. Citește și folosește-o ca un început pentru scripturile tale ...
</p>
</div>
<h2><span class="mw-headline" id="Snippets">Snippets</span></h2>
<p><span id="A_typical_InitGui.py_file"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Un_fi.C8.99ier_tipic_InitGui.py"></span><span class="mw-headline" id="Un_fișier_tipic_InitGui.py">Un fișier tipic InitGui.py</span></h3>
<p>Fiecare modul trebuie să conțină, pe lângă fișierul modulului principal, un fișier InitGui.py, responsabil pentru înserarea modulului GUI principal. Acesta este un exemplu simplu.
</p>
</div>
<p>Every module must contain, besides your main module file, an InitGui.py file, responsible for inserting the module in the main Gui. This is an example of a simple one. 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ScriptWorkbench</span> <span class="p">(</span><span class="n">Workbench</span><span class="p">):</span> 
    <span class="n">MenuText</span> <span class="o">=</span> <span class="s2">"Scripts"</span>
    <span class="k">def</span> <span class="nf">Initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">Scripts</span> <span class="c1"># assuming Scripts.py is your module</span>
        <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Script_Cmd"</span><span class="p">]</span> <span class="c1"># That list must contain command names, that can be defined in Scripts.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendToolbar</span><span class="p">(</span><span class="s2">"My Scripts"</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> 
        
<span class="n">Gui</span><span class="o">.</span><span class="n">addWorkbench</span><span class="p">(</span><span class="n">ScriptWorkbench</span><span class="p">())</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="A_typical_module_file"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Un_fi.C8.99ier_modul_tipic"></span><span class="mw-headline" id="Un_fișier_modul_tipic">Un fișier modul tipic</span></h3>
<p>Acesta este un exemplu al unui fișier modul principal, care conține tot ceea ce face modul dvs. Acesta este fișierul Scripts.py invocat în exemplul anterior. Puteți să aveți toate comenzile personalizate aici.
</p>
</div>
<p>This is an example of a main module file, containing everything your module does. It is the Scripts.py file invoked by the previous example. You can have all your custom commands here.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span> 
 
<span class="k">class</span> <span class="nc">ScriptCmd</span><span class="p">:</span> 
   <span class="k">def</span> <span class="nf">Activated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
       <span class="c1"># Here your write what your ScriptCmd does...</span>
       <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">GetResources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
       <span class="k">return</span> <span class="p">{</span><span class="s1">'Pixmap'</span> <span class="p">:</span> <span class="s1">'path_to_an_icon/myicon.png'</span><span class="p">,</span> <span class="s1">'MenuText'</span><span class="p">:</span> <span class="s1">'Short text'</span><span class="p">,</span> <span class="s1">'ToolTip'</span><span class="p">:</span> <span class="s1">'More detailed text'</span><span class="p">}</span> 
       
<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">addCommand</span><span class="p">(</span><span class="s1">'Script_Cmd'</span><span class="p">,</span> <span class="n">ScriptCmd</span><span class="p">())</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Import_a_new_filetype"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Importul_unui_nou_tip_de_fi.C8.99ier"></span><span class="mw-headline" id="Importul_unui_nou_tip_de_fișier">Importul unui nou tip de fișier</span></h3>
<p>Efectuarea unui import pentru un nou tip de fișier în FreeCAD este ușoară. FreeCAD nu ia 
în considerare că importați orice date într-un document deschis, pentru că nu puteți deschide direct un nou tip de fișier. Deci, ceea ce trebuie să faceți este să adăugați noua extensie de fișiere în lista de extensii cunoscute a FreeCAD și să scrieți codul care va citi fișierul și va crea obiectele FreeCAD pe care le doriți:
</p>
</div>
<p>Making an importer for a new filetype in FreeCAD is easy. FreeCAD doesn't consider that you import data in an opened document, but rather that you simply can directly open the new filetype. So what you need to do is to add the new file extension to FreeCAD's list of known extensions, and write the code that will read the file and create the FreeCAD objects you want:
</p><p>Această linie trebuie adăugată în fișierul InitGui.py pentru a adăuga noua extensie de fișier în listă de extensii:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># Assumes Import_Ext.py is the file that has the code for opening and reading .ext files</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">addImportType</span><span class="p">(</span><span class="s2">"Your new File Type (*.ext)"</span><span class="p">,</span><span class="s2">"Import_Ext"</span><span class="p">)</span>
</pre></div>
<p>Then in the Import_Ext.py file:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span> 
   <span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
   <span class="c1"># here you do all what is needed with filename, read, classify data, create corresponding FreeCAD objects</span>
   <span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p>Pentru a exporta documentul la unele tipuri de fișiere noi funcționează în același mod, cu excepția faptului că utilizați:
</p>
<pre>FreeCAD.addExportType("Your new File Type (*.ext)","Export_Ext")
</pre>
<p><a href="#top">Top</a></p>
<p><span id="Add_a_line"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_unei_linii_.28segment.29"></span><span class="mw-headline" id="Adăugarea_unei_linii_(segment)">Adăugarea unei linii (segment)</span></h3>
<p>O linie este definită  doar de 2 puncte.
</p>
</div>
<p>A line simply has 2 points.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span><span class="nn">PartGui</span> 
<span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> 
<span class="c1"># add a line element to the document and set its points </span>
<span class="n">l</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">LineSegment</span><span class="p">()</span>
<span class="n">l</span><span class="o">.</span><span class="n">StartPoint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">EndPoint</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span><span class="o">.</span><span class="n">Shape</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span> 
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Add_a_polygon"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_unui_poligon"></span><span class="mw-headline" id="Adăugarea_unui_poligon">Adăugarea unui poligon</span></h3>
<p>Un poligon este pur și simplu un set de segmente de linie conectate (o polilinie în AutoCAD). Nu este obligatoriu să fie închisă.
</p>
</div>
<p>A polygon is simply a set of connected line segments (a polyline in AutoCAD). It doesn't need to be closed.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">PartGui</span> 
<span class="n">doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span> 

<span class="c1"># create a 3D vector, set its coordinates and add it to the list </span>
<span class="n">v</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="n">v</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="c1">#... repeat for all nodes </span>

<span class="c1"># Create a polygon object and set its nodes </span>
<span class="n">p</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Polygon"</span><span class="p">,</span><span class="s2">"Polygon"</span><span class="p">)</span> 
<span class="n">p</span><span class="o">.</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">n</span> 
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Add_and_remove_an_object_to/from_a_group"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_.C8.99i_.C3.AEndep.C4.83rtarea_unui_obiect_.C3.AEntr-un_grup"></span><span class="mw-headline" id="Adăugarea_și_îndepărtarea_unui_obiect_într-un_grup">Adăugarea și îndepărtarea unui obiect într-un grup</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> 
<span class="n">grp</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::DocumentObjectGroup"</span><span class="p">,</span> <span class="s2">"Group"</span><span class="p">)</span> 
<span class="n">lin</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span> <span class="s2">"Line"</span><span class="p">)</span>
<span class="n">grp</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">lin</span><span class="p">)</span> <span class="c1"># adds the lin object to the group grp</span>
<span class="n">grp</span><span class="o">.</span><span class="n">removeObject</span><span class="p">(</span><span class="n">lin</span><span class="p">)</span> <span class="c1"># removes the lin object from the group grp</span>
</pre></div>
<p>Notă: Puteți chiar să adăugați un alt grup la un grup...
</p>
<p><a href="#top">Top</a></p>
<p><span id="Add_a_Mesh"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_unei_plase"></span><span class="mw-headline" id="Adăugarea_unei_plase">Adăugarea unei plase</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Mesh</span>
<span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="c1"># create a new empty mesh</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">Mesh</span><span class="p">()</span>
<span class="c1"># build up box out of 12 facets</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="c1"># scale to a edge langth of 100</span>
<span class="n">m</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
<span class="c1"># add the mesh to the active document</span>
<span class="n">me</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Mesh::Feature"</span><span class="p">,</span><span class="s2">"Cube"</span><span class="p">)</span>
<span class="n">me</span><span class="o">.</span><span class="n">Mesh</span><span class="o">=</span><span class="n">m</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Add_an_arc_or_a_circle"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_unui_cerc_sau_a_unui_arc_de_cerc"></span><span class="mw-headline" id="Adăugarea_unui_cerc_sau_a_unui_arc_de_cerc">Adăugarea unui cerc sau a unui arc de cerc</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Circle</span><span class="p">()</span> 
<span class="n">c</span><span class="o">.</span><span class="n">Radius</span><span class="o">=</span><span class="mf">10.0</span>  
<span class="n">f</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span> <span class="s2">"Circle"</span><span class="p">)</span> <span class="c1"># create a document with a circle feature </span>
<span class="n">f</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span> <span class="c1"># Assign the circle shape to the shape property </span>
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Access_and_change_the_representation_of_an_object"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Accesarea_.C8.99i_schimbarea_reprezent.C4.83rii_unui_obiect"></span><span class="mw-headline" id="Accesarea_și_schimbarea_reprezentării_unui_obiect">Accesarea și schimbarea reprezentării unui obiect</span></h3>
<p>Fiecare obiect dintr-un document FreeCAD are un obiect vederii asociat, care stochează toți parametrii care definesc proprietățile obiectului, cum ar fi culoarea, lățimea liniei etc.
</p>
</div>
<p>Each object in a FreeCAD document has an associated view representation object that stores all the parameters that define how that object appears: i.e. color, linewidth, etc... See also <a href="#List_the_components_of_an_object">List the components of an object</a> snippet below
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">gad</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> <span class="c1"># access the active document containing all </span>
                           <span class="c1"># view representations of the features in the</span>
                           <span class="c1"># corresponding App document </span>

<span class="n">v</span> <span class="o">=</span> <span class="n">gad</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">"Cube"</span><span class="p">)</span>  <span class="c1"># access the view representation to the Mesh feature 'Cube' </span>
<span class="n">v</span><span class="o">.</span><span class="n">ShapeColor</span>               <span class="c1"># prints the color to the console </span>
<span class="n">v</span><span class="o">.</span><span class="n">ShapeColor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># sets the shape color to white</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Replace_the_form_of_mouse_with_one_image">Replace the form of mouse with one image</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QCursor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<span class="n">myImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">"Complete_Path_to_image.bmp"</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">myImage</span><span class="p">)</span>
<span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span id="Replace_the_form_of_mouse_with_one_image_.28cross.29_include"></span><span class="mw-headline" id="Replace_the_form_of_mouse_with_one_image_(cross)_include">Replace the form of mouse with one image (cross) include</span></h3>
<p>The image is created by Gimp exported in a .XPM file. Copy and use the code between the bracket <b>"{"</b>  code to copy  <b>"}"</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QCursor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<span class="n">cross32x32Icon</span> <span class="o">=</span> <span class="p">[</span>
<span class="s2">"32 32 2 1"</span><span class="p">,</span>
<span class="s2">" 	c None"</span><span class="p">,</span>
<span class="s2">".	c #FF0000"</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                                "</span><span class="p">,</span>
<span class="s2">"............... . .............."</span><span class="p">,</span>
<span class="s2">"                                "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span>
<span class="p">]</span>

<span class="n">myImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">cross32x32Icon</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">myImage</span><span class="p">)</span>
<span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Observe_camera_change_in_the_3D_viewer_via_Python">Observe camera change in the 3D viewer via Python</span></h3>
<p>This can be done adding a <a class="external text" href="https://www.coin3d.org/Coin/html/classSoNodeSensor.html" rel="nofollow">Node sensor</a> to the camera: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">cam</span><span class="p">,</span> <span class="n">sensor</span> <span class="o">=</span> <span class="n">args</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Cam position : </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Cam rotation : </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>

<span class="n">camera_node</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraNode</span><span class="p">()</span>
<span class="n">node_sensor</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoNodeSensor</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">camera_node</span><span class="p">)</span>
<span class="n">node_sensor</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">camera_node</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Observe_mouse_events_in_the_3D_viewer_via_Python"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Observarea_evenimentelor_mouse-ului_.C3.AEn_vizualizatorul_3D_via_Python"></span><span class="mw-headline" id="Observarea_evenimentelor_mouse-ului_în_vizualizatorul_3D_via_Python">Observarea evenimentelor mouse-ului în vizualizatorul 3D via Python</span></h3>
<p>Cadrul Inventor permite adăugarea unuia sau mai multor noduri de apel invers(callback) la scena grafică vizualizată. În mod implicit, în FreeCAD, un nod de apel invers este instalat per vizualizator(fereastra de afișare grafică), ceea ce permite adăugarea funcțiilor globale sau statice C ++. Metode de legarea adecvată sunt furnizate de Python, pentru a permite utilizarea acestei tehnici plecând de la codul Python.
</p>
</div>
<p>The Inventor framework allows to add one or more callback nodes to the scenegraph of the viewer. By default in FreeCAD one callback node is installed per viewer which allows to add global or static C++ functions. In the appropriate Python binding some methods are provided to make use of this technique from within Python code.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
 
<span class="c1">#This class logs any mouse button events. As the registered callback function fires twice for 'down' and</span>
<span class="c1">#'up' events we need a boolean flag to handle this.</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"State"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"DOWN"</span><span class="p">)</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">"Position"</span><span class="p">]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">down</span><span class="p">):</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Clicked on position: ("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">", "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">")</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       
<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>
</pre></div>
<p><br/>
Acum, alegeți undeva în zona din ecran (suprafață de lucru)vizualizatorul 3D și observați mesajele din fereastra de ieșire. Pentru a termina observația, trebuie doar să sunați
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">removeEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
<p>Următoarele tipuri de evenimente sunt suportate
</p>
<ul><li>SoEvent -- orice tip de evenimente</li>
<li>SoButtonEvent -- toate evenimentele butoanele /rotiță mouse</li>
<li>SoLocation2Event -- evenimente mișcări 2D  (mișcările normale ale mouse-lui)</li>
<li>SoMotion3Event -- evenimentele mișcări 3D  (normale pentru spaceball)</li>
<li>SoKeyboardEvent -- evenimente de tastare  a tastelor cu săgeți sus/jos</li>
<li>SoMouseButtonEvent -- evenimentul de tastare și eliberare a butoanelor mouse</li>
<li>SoSpaceballButtonEvent -- evenimentul de tastare și eliberare a butoanelor spaceball</li></ul>
<p>Funcțiile Python care pot fi înregistrate cu  addEventCallback() așteaptă definirea unei bilbioteci.
Funcție de modul în care evenimentul survine , biblioteca poate dispunde diferite taste.
Este alocată câte o tastă pentru fiecare eveniment:
</p><p>În funcție de eveniment, dicționarul poate conține diferite taste alocate.
</p><p>Pentru toate evenimentele are tastele:
</p>
<ul><li>Type -- the name of the event type i.e. SoMouseEvent, SoLocation2Event, ...</li>
<li>Time -- timpul curent ca șir de caractere</li>
<li>Position -- tuple de două numere întregi, reprezentând poziția mouse-ului</li>
<li>ShiftDown -- un indicator boolean, adevărat dacă Shift a fost apăsat altfel fals</li>
<li>CtrlDown -- un indicator boolean, adevărat dacă Ctrl a fost apăsat altfel fals</li>
<li>AltDown -- un indicator boolean, adevărat dacă Alt a fost apăsat altfel fals</li></ul>
<p>Pentru toate evenimentele gen apăsare de buton, adică evenimente de tip tastatură, mouse sau spațiu
</p>
<ul><li>State -- Un șir text dacă butonul este 'UP' , 'DOWN' dacă butonul este jos, sau pentru orice alt caz 'UNKNOWN'</li></ul>
<p>pentru evenimentele tip apăsare tastatură: 
</p>
<ul><li>Key -- caracterul tastei apăsate</li></ul>
<p>pentru evenimente buton de mouse  
</p>
<ul><li>Button -- Butonul apăsat, poate lua valorile BUTTON1, ..., BUTTON5 sau oricare dintre ele</li></ul>
<p>pentru evenimente tip spaceball: 
</p>
<ul><li>Button -- butonul apăsat poate lua valorile,  BUTTON1, ..., BUTTON7 sau oricare dintre ele ANY</li></ul>
<p>Și în sfârșit, evenimentele legate de deplasare: 
</p>
<ul><li>Translation -- o tuplă de trei numere cu virgulă <b><a class="external text" href="http://docs.python.org/library/functions.html#float" rel="nofollow">float()</a></b></li>
<li>Rotation -- un quaternion pentru rotație, adică o tuplă de patru valori exprimate cu virgulă <b><a class="external text" href="http://docs.python.org/library/functions.html#float" rel="nofollow">float()</a></b></li></ul>
<p><a href="#top">Top</a></p>
<p><span id="Display_keys_pressed_and_Events_command"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Afi.C8.99a.C8.9Bi_tastele_ap.C4.83sate_.C8.99i_evenimentele_comenzi"></span><span class="mw-headline" id="Afișați_tastele_apăsate_și_evenimentele_comenzi">Afișați tastele apăsate și evenimentele comenzi</span></h3>
<p>Această macrocomandă afișează în vizualizarea raportului tastele apăsate și comanda tuturor evenimentelor
</p>
</div>
<p>This macro displays in the report view the keys pressed and all events command 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="k">try</span><span class="p">:</span>
           <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"Key"</span><span class="p">])</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">down</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># here the character pressed</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># list all events command</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"_______________________________________"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
           <span class="kc">None</span>
 
<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>

<span class="c1">#v.removeEventCallback("SoEvent",c) # remove ViewObserver</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Manipulate_the_scenegraph_in_Python"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Manipularea_de_scene_grafice_.C3.AEn_Python"></span><span class="mw-headline" id="Manipularea_de_scene_grafice_în_Python">Manipularea de scene grafice în Python</span></h3>
<p>De asemenea, este posibil să se afișeze și să se schimbe scen în programul Python, cu modulul "pivy" - în combinație cu Coin.
</p>
</div>
<p>It is also possible to get and change the scenegraph in Python, with the 'pivy' module -- a Python binding for Coin.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy.coin</span> <span class="kn">import</span> <span class="o">*</span>                <span class="c1"># load the pivy module</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>   <span class="c1"># get the active viewer</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">getSceneGraph</span><span class="p">()</span>            <span class="c1"># the root is an SoSeparator node</span>
<span class="n">root</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">SoCube</span><span class="p">())</span>
<span class="n">view</span><span class="o">.</span><span class="n">fitAll</span><span class="p">()</span>
</pre></div>
<p>API-ul Python API-ul de tip pivy este creat folosind instrumentul SWIG. Pe măsură ce folosim în FreeCAD niște noduri scrise automat, pe care nu le puteți crea direct în Python.
Cu toate acestea, este posibil să creați un nod prin numele său intern. Un exemplu de tipul "SoFCSelection" poate fi creată cu:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">type</span> <span class="o">=</span> <span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s2">"SoFCSelection"</span><span class="p">)</span>
<span class="n">node</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Add_and_remove_objects_to/from_the_scenegraph"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_.C8.99i_eliminarea_obiectelor_.C3.AEn_.2F_de_la_scena_de_grafic.C4.83"></span><span class="mw-headline" id="Adăugarea_și_eliminarea_obiectelor_în_/_de_la_scena_de_grafică">Adăugarea și eliminarea obiectelor în / de la scena de grafică</span></h3>
<p>Adăugarea de noi noduri în scena grafică poate fi făcută astfel. Aveți grijă să adăugați mereu un SoSeparator pentru a conține proprietățile formei geometrice, coordonatele și informațiile despre material ale aceluiași obiect. Următorul exemplu adaugă o linie roșie de la (0,0,0) până la (10,0,0):
</p>
</div>
<p>Adding new nodes to the scenegraph can be done this way. Take care of always adding a SoSeparator to contain the geometry, coordinates and material info of a same object. The following example adds a red line from (0,0,0) to (10,0,0):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="n">sg</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getSceneGraph</span><span class="p">()</span>
<span class="n">co</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">co</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">),</span><span class="n">pts</span><span class="p">)</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>
<span class="n">ma</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">li</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoLineSet</span><span class="p">()</span>
<span class="n">li</span><span class="o">.</span><span class="n">numVertices</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">no</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">co</span><span class="p">)</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
</pre></div>
<p>Pentru a șerge pe acesta, este cimplu:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">sg</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p><div class="mw-collapsible mw-collapsed toccolours">
<p><span id="Save_the_sceneGraph_in_3_series_of_36_files"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Salva.C8.9Bi_sceneGraph_cu_o_rota.C8.9Bie_.C3.AEntr-o_serie_de_36_fi.C8.99iere_.C3.AEn_axele_X_Y_Z"></span><span class="mw-headline" id="Salvați_sceneGraph_cu_o_rotație_într-o_serie_de_36_fișiere_în_axele_X_Y_Z">Salvați sceneGraph cu o rotație într-o serie de 36 fișiere în axele X Y Z</span></h3>
</div>
<p>View the code snippet by expanding this section
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">dirname</span> <span class="o">=</span> <span class="s2">"C:/Temp/animation/"</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">36</span>
<span class="n">angle</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">steps</span>

<span class="n">matX</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matX</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsX</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matX</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">matY</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matY</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsY</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matY</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">matZ</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matZ</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsZ</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matZ</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">view</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
<span class="n">cam</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="n">getCameraNode</span><span class="p">()</span>
<span class="n">rotCamera</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="o">*</span><span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>

<span class="c1"># this sets the lookat point to the center of circumsphere of the global bounding box</span>
<span class="n">view</span><span class="o">.</span><span class="n">fitAll</span><span class="p">()</span>

<span class="c1"># the camera's position, i.e. the user's eye point</span>
<span class="n">position</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
<span class="n">distance</span><span class="o">=</span><span class="n">cam</span><span class="o">.</span><span class="n">focalDistance</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>

<span class="c1"># view direction</span>
<span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># this is the point on the screen the camera looks at</span>
<span class="c1"># when rotating the camera we should make this point fix</span>
<span class="n">lookat</span><span class="o">=</span><span class="n">position</span><span class="o">+</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>

<span class="c1"># around x axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsX</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"x-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># around y axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsY</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"y-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># around z axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsZ</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"z-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><a href="#top">Top</a></p>
<p><span id="Add_custom_widgets_to_the_interface"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_de_widget-uri_personalizate_la_interfa.C8.9B.C4.83"></span><span class="mw-headline" id="Adăugarea_de_widget-uri_personalizate_la_interfață">Adăugarea de widget-uri personalizate la interfață</span></h3>
<p>Puteți crea widget-uri personalizate cu designerul Qt, le puteți transforma într-un script python și apoi le puteți încărca în interfața FreeCAD cu PySide.
</p>
</div>
<p>You can create custom widgets with Qt designer, transform them into a python script, and then load them into the FreeCAD interface with PySide.
</p><p>Codul python produs de compilatorul Ui python (instrumentul care convertește fișierele qt-designer .ui în codul python), în general, arată astfel (este simplu, puteți, de asemenea, să îl codificați direct în Python):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">myWidget_Ui</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">myWidget</span><span class="p">):</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"my Nice New Widget"</span><span class="p">)</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">())</span><span class="o">.</span><span class="n">expandedTo</span><span class="p">(</span><span class="n">myWidget</span><span class="o">.</span><span class="n">minimumSizeHint</span><span class="p">()))</span> <span class="c1"># sets size of the widget</span>
 
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">myWidget</span><span class="p">)</span> <span class="c1"># creates a label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span> <span class="c1"># sets its size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"label"</span><span class="p">)</span> <span class="c1"># sets its name, so it can be found by name</span>

    <span class="k">def</span> <span class="nf">retranslateUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draftToolbar</span><span class="p">):</span> <span class="c1"># built-in QT function that manages translations of widgets</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">"myWidget"</span><span class="p">,</span> <span class="s2">"My Widget"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">UnicodeUTF8</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">"myWidget"</span><span class="p">,</span> <span class="s2">"Welcome to my new widget!"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">UnicodeUTF8</span><span class="p">))</span>
</pre></div>
<p>Apoi, tot ce trebuie să faceți este să creați o referință la fereastra Qt FreeCAD, să-i inserați un widget personalizat în ea și să transferați codul Ui al acestui widget pe care tocmai l-am făcut:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span>
<span class="n">FCmw</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">activeWindow</span><span class="p">()</span> <span class="c1"># the active qt window, = the freecad window since we are inside it</span>
<span class="c1"># FCmw = FreeCADGui.getMainWindow() # use this line if the 'addDockWidget' error is declared</span>
<span class="n">myNewFreeCADWidget</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">()</span> <span class="c1"># create a new dckwidget</span>
<span class="n">myNewFreeCADWidget</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">myWidget_Ui</span><span class="p">()</span> <span class="c1"># load the Ui script</span>
<span class="n">myNewFreeCADWidget</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="n">myNewFreeCADWidget</span><span class="p">)</span> <span class="c1"># setup the ui</span>
<span class="n">FCmw</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">,</span><span class="n">myNewFreeCADWidget</span><span class="p">)</span> <span class="c1"># add the widget to the main window</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Add_a_Tab_to_the_Combo_View"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_unui_tab_.C3.AEn_vizualizarea_Combo"></span><span class="mw-headline" id="Adăugarea_unui_tab_în_vizualizarea_Combo">Adăugarea unui tab în vizualizarea Combo</span></h3>
<p>Următorul cod vă permite să adăugați o filă în FreeCAD ComboView, pe lângă filele "Project" și "Tasks". De asemenea, utilizează modulul uic pentru a încărca un fișier ui direct în acea filă.
</p>
</div>
<p>The following code allows you to add a tab to the <a href="../Combo_view.html" title="Combo view">Combo view</a>, separate from the preexisting "Model" and "Tasks" tabs. It also uses the <code>uic</code> module to load an UI file directly in that tab.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># create new Tab in ComboView</span>
<span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span><span class="n">QtCore</span>
<span class="c1">#from PySide import uic</span>

<span class="k">def</span> <span class="nf">getMainWindow</span><span class="p">():</span>
   <span class="s2">"returns the main window"</span>
   <span class="c1"># using QtGui.qApp.activeWindow() isn't very reliable because if another</span>
   <span class="c1"># widget than the mainwindow is active (e.g. a dialog) the wrong widget is</span>
   <span class="c1"># returned</span>
   <span class="n">toplevel</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span><span class="o">.</span><span class="n">topLevelWidgets</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">toplevel</span><span class="p">:</span>
       <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">metaObject</span><span class="p">()</span><span class="o">.</span><span class="n">className</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Gui::MainWindow"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span>
   <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"No main window found"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getComboView</span><span class="p">(</span><span class="n">mw</span><span class="p">):</span>
   <span class="n">dw</span><span class="o">=</span><span class="n">mw</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dw</span><span class="p">:</span>
       <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span> <span class="o">==</span> <span class="s2">"Combo View"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">)</span>
       <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span> <span class="o">==</span> <span class="s2">"Python Console"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">)</span>
   <span class="k">raise</span> <span class="ne">Exception</span> <span class="p">(</span><span class="s2">"No tab widget found"</span><span class="p">)</span>

<span class="n">mw</span> <span class="o">=</span> <span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">getComboView</span><span class="p">(</span><span class="n">getMainWindow</span><span class="p">())</span>
<span class="n">tab2</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDialog</span><span class="p">()</span>
<span class="n">tab</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="s2">"A Special Tab"</span><span class="p">)</span>

<span class="c1">#uic.loadUi("/myTaskPanelforTabs.ui",tab2)</span>
<span class="n">tab2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#tab.removeTab(2)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Enable_or_disable_a_window"></span>
</p>
<h3><span id="Activa.C8.9Bi_sau_dezactiva.C8.9Bi_o_fereastr.C4.83"></span><span class="mw-headline" id="Activați_sau_dezactivați_o_fereastră">Activați sau dezactivați o fereastră</span></h3>
<p>This script give the ability to manipulate the UI from the <a href="../Python_console.html" title="Python console">Python console</a> to show/hide different components in the FreeCAD <a href="../Interface.html" title="Interface">interface</a> such as:
</p>
<ul><li><a href="../Report_view.html" title="Report view">Report view</a></li>
<li><a href="../Tree_view.html" title="Tree view">Tree view</a></li>
<li><a href="../Property_editor.html" title="Property editor">Property view</a></li>
<li><a href="../Selection_view.html" title="Selection view">Selection view</a></li>
<li><a href="../Combo_view.html" title="Combo view">Combo view</a></li>
<li><a href="../Python_console.html" title="Python console">Python console</a></li>
<li>draftToolbar</li></ul>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">dws</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">)</span>

<span class="c1"># objectName may be :</span>
<span class="c1"># "Report view"</span>
<span class="c1"># "Tree view"</span>
<span class="c1"># "Property view"</span>
<span class="c1"># "Selection view"</span>
<span class="c1"># "Combo View"</span>
<span class="c1"># "Python console"</span>
<span class="c1"># "draftToolbar"</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dws</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Report view"</span><span class="p">:</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">break</span>

<span class="n">va</span> <span class="o">=</span> <span class="n">dw</span><span class="o">.</span><span class="n">toggleViewAction</span><span class="p">()</span>
<span class="n">va</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>        <span class="c1"># True or False</span>
<span class="n">dw</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>        <span class="c1"># True or False</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Open_a_custom_webpage"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span class="mw-headline" id="Deschiderea_unei_pagini_web_personalizate">Deschiderea unei pagini web personalizate</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">WebGui</span>
<span class="n">WebGui</span><span class="o">.</span><span class="n">openBrowser</span><span class="p">(</span><span class="s2">"http://www.example.com"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Get_the_HTML_contents_of_an_opened_webpage"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ob.C8.9Binerea_con.C8.9Binutului_HTML_al_unei_pagini_Web_deschise"></span><span class="mw-headline" id="Obținerea_conținutului_HTML_al_unei_pagini_Web_deschise">Obținerea conținutului HTML al unei pagini Web deschise</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span><span class="n">QtWebKit</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">activeWindow</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtWebKit</span><span class="o">.</span><span class="n">QWebFrame</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">unicode</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">toHtml</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">html</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Retrieve_the_coordinates_of_3_selected_points_or_objects"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Recupera.C8.9Bi_.C8.99i_utiliza.C8.9Bi_coordonatele_a_3_puncte_sau_obiecte_selectate"></span><span class="mw-headline" id="Recuperați_și_utilizați_coordonatele_a_3_puncte_sau_obiecte_selectate">Recuperați și utilizați coordonatele a 3 puncte sau obiecte selectate</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># the line above to put the accentuated in the remarks</span>
<span class="c1"># If this line is missing, an error will be returned</span>
<span class="c1"># extract and use the coordinates of 3 objects selected</span>
<span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">PartGui</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span><span class="p">,</span> <span class="n">Console</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span> <span class="c1"># " sel " contains the items selected</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span><span class="o">!=</span><span class="mi">3</span> <span class="p">:</span>
  <span class="c1"># If there are no 3 objects selected, an error is displayed in the report view</span>
  <span class="c1"># The \r and \n at the end of line mean return and the newline CR + LF.</span>
  <span class="n">Console</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">"Select 3 points exactly</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">else</span> <span class="p">:</span>
  <span class="n">points</span><span class="o">=</span><span class="p">[]</span>
  <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">BoundBox</span><span class="o">.</span><span class="n">Center</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
    <span class="c1"># display of the coordinates in the report view</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>

  <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="List_all_objects"></span>
</p>
<h3><span class="mw-headline" id="Listarea_tuturor_obeictelor">Listarea tuturor obeictelor</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span><span class="nn">Draft</span>
<span class="c1"># List all objects of the document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span>
<span class="n">objs</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span>
<span class="c1">#App.Console.PrintMessage(str(objs) + "\n")</span>
<span class="c1">#App.Console.PrintMessage(str(len(FreeCAD.ActiveDocument.Objects)) + " Objects"  + "\n")</span>

<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span>                                             <span class="c1"># list the Name  of the object  (not modifiable)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Label</span>                                            <span class="c1"># list the Label of the object  (modifiable)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">LabelText</span>                                    <span class="c1"># list the LabeText of the text (modifiable)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># Displays the Name the Label and the text</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># Displays the Name and the Label of the object</span>

<span class="c1">#doc.removeObject("Box") # Clears the designated object</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="List_the_dimensions_of_an_object,_given_its_name"></span>
</p>
<h3><span id="Listeaz.C4.83_dimensiunile_unui_obiect.2C_av.C3.A2nd_.C3.AEn_vedere_numele_acestuia"></span><span class="mw-headline" id="Listează_dimensiunile_unui_obiect,_având_în_vedere_numele_acestuia">Listează dimensiunile unui obiect, având în vedere numele acestuia</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">MyObjectName</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">:</span> <span class="c1"># replace "MyObjectName" for list</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">edge</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Function_resident_with_the_mouse_click_action"></span>
</p>
<h3><span id="Func.C8.9Bia_rezident.C4.83_cu_ac.C8.9Biunea_clicului_mouse-ului"></span><span class="mw-headline" id="Funcția_rezidentă_cu_acțiunea_clicului_mouse-ului">Funcția rezidentă cu acțiunea clicului mouse-ului</span></h3>
<p>Here with <b>SelObserver</b> on a object select
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># causes an action to the mouse click on an object</span>
<span class="c1"># This function remains resident (in memory) with the function "addObserver(s)"</span>
<span class="c1"># "removeObserver(s) # Uninstalls the resident function</span>
<span class="k">class</span> <span class="nc">SelObserver</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">setPreselection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">):</span>                <span class="c1"># Preselection object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># The part of the object name</span>

    <span class="k">def</span> <span class="nf">addSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">,</span><span class="n">pnt</span><span class="p">):</span>               <span class="c1"># Selection object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"addSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Name of the document</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Name of the object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># The part of the object name</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Coordinates of the object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"______"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">):</span>                <span class="c1"># Remove the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"removeSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>                           <span class="c1"># Set selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"setSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clearSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>                         <span class="c1"># If click on the screen, clear the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"clearSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># If click on another object, clear the previous object</span>
<span class="n">s</span> <span class="o">=</span><span class="n">SelObserver</span><span class="p">()</span>
<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addObserver</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>                       <span class="c1"># install the function mode resident</span>
<span class="c1">#FreeCADGui.Selection.removeObserver(s)                   # Uninstall the resident function</span>
</pre></div>
<p>Other example with <b>ViewObserver</b> on a object select or view
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
 
<span class="c1">#This class logs any mouse button events. As the registered callback function fires twice for 'down' and</span>
<span class="c1">#'up' events we need a boolean flag to handle this.</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">view</span>
   
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"State"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"DOWN"</span><span class="p">)</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">"Position"</span><span class="p">]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">down</span><span class="p">):</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Clicked on position: ("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">", "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">")</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
           <span class="n">pnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"World coordinates: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
           <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getObjectInfo</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Object info: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Display_the_active_document">Display the active document</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">DocObserver</span><span class="p">:</span>                      <span class="c1"># document Observer</span>
    <span class="k">def</span> <span class="nf">slotActivateDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>

<span class="n">obs</span><span class="o">=</span><span class="n">DocObserver</span><span class="p">()</span>
<span class="n">App</span><span class="o">.</span><span class="n">addDocumentObserver</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="c1">#App.removeDocumentObserver(obs)                 # desinstalle la fonction residente</span>
</pre></div>
<p>To remove the observer call:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">removeDocumentObserver</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>                 <span class="c1"># desinstalle la fonction residente</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Find/select_all_elements_below_the_cursor"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="c.C4.83utarea_.C8.99i_selec.C8.9Bia_tuturor_elementelor_de_sub_cursor"></span><span class="mw-headline" id="căutarea_și_selecția_tuturor_elementelor_de_sub_cursor">căutarea și selecția tuturor elementelor de sub cursor</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>

<span class="k">def</span> <span class="nf">mouse_over_cb</span><span class="p">(</span> <span class="n">event_callback</span><span class="p">):</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">event_callback</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
    <span class="n">listObjects</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getObjectsInfo</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">listObjects</span><span class="p">:</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> *** Objects under mouse pointer ***"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">listObjects</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="s2">"Object"</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>


<span class="n">view</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>

<span class="n">mouse_over</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoLocation2Event</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">mouse_over_cb</span> <span class="p">)</span>

<span class="c1"># to remove Callback :</span>
<span class="c1">#view.removeEventCallbackPivy( coin.SoLocation2Event.getClassTypeId(), mouse_over)</span>

<span class="c1">####</span>
<span class="c1">#The easy way is probably to use FreeCAD's selection.</span>
<span class="c1">#FreeCADGui.ActiveDocument.ActiveView.getObjectsInfo(mouse_coords)</span>

<span class="c1">####</span>
<span class="c1">#you get that kind of result :</span>
<span class="c1">#'Document': 'Unnamed', 'Object': 'Box', 'Component': 'Face2', 'y': 8.604081153869629, 'x': 21.0, 'z': 8.553047180175781</span>

<span class="c1">####</span>
<span class="c1">#You can use this data to add your element to FreeCAD's selection :</span>
<span class="c1">#FreeCADGui.Selection.addSelection(FreeCAD.ActiveDocument.Box,'Face2',21.0,8.604081153869629,8.553047180175781)</span>
</pre></div>
<p><a href="#top">Top</a></p><div class="mw-collapsible mw-collapsed toccolours">
<p><span id="List_the_components_of_an_object"></span>
</p>
<h3><span class="mw-headline" id="Lista_componentelor_unui_obiect">Lista componentelor unui obiect</span></h3>
<p>This function list the components of an object and extracts:
</p>
<ul><li>this object its XYZ coordinates,</li>
<li>its edges and their lengths center of mass and coordinates</li>
<li>its faces and their center of mass</li>
<li>its faces and their surfaces and coordinates</li></ul>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># This function list the components of an object</span>
<span class="c1"># and extract this object its XYZ coordinates,</span>
<span class="c1"># its edges and their lengths center of mass and coordinates</span>
<span class="c1"># its faces and their center of mass</span>
<span class="c1"># its faces and their surfaces and coordinates</span>
<span class="c1"># 8/05/2014</span>

<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span><span class="nn">Part</span>
<span class="k">def</span> <span class="nf">detail</span><span class="p">():</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>   <span class="c1"># Select an object</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>                           <span class="c1"># If there is a selection then</span>
        <span class="n">Vertx</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Edges</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Faces</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">compt_V</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">compt_E</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">compt_F</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">pas</span>    <span class="o">=</span><span class="mi">0</span>
        <span class="n">perimetre</span> <span class="o">=</span> <span class="mf">0.0</span>   
        <span class="n">EdgesLong</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Displays the "Name" and the "Label" of the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Selection &gt; "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"  "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Label</span><span class="p">)</span> <span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">):</span>                                     <span class="c1"># Search the "Edges" and their lengths</span>
            <span class="n">compt_E</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">Edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Edge</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">EdgesLong</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">))</span>
            <span class="n">perimetre</span> <span class="o">+=</span> <span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span>                     <span class="c1"># calculates the perimeter</span>

            <span class="c1"># Displays the "Edge" and its length</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edge"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_E</span><span class="p">)</span><span class="o">+</span><span class="s2">" Length &gt; "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays the "Edge" and its center mass</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edge"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_E</span><span class="p">)</span><span class="o">+</span><span class="s2">" Center &gt; "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="n">num</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="c1"># Displays the coordinates 1</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">" Y1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" Z1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">num</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
            <span class="c1"># Displays the coordinates 2</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">" Y2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" Z2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Perimeter of the form  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perimetre</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> 

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">FacesSurf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">):</span>                                      <span class="c1"># Search the "Faces" and their surface</span>
            <span class="n">compt_F</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">Faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Face</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">FacesSurf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span><span class="p">))</span>

            <span class="c1"># Displays 'Face' and its surface</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Surface "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its CenterOfMass</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Center  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its Coordinates</span>
            <span class="n">FacesCoor</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">fco</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">f0</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>                        <span class="c1"># Search the Vertexes of the face</span>
                <span class="n">fco</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>

            <span class="c1"># Displays 'Face' and its Coordinates</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Coordinate"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FacesCoor</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its Volume</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Volume  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Displays the total surface of the form</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Surface of the form    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Displays the total Volume of the form</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Volume  of the form    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">detail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">Top</a></p>
<p><span id="List_the_PropertiesList"></span>
</p>
<h3><span class="mw-headline" id="Lista_PropertiesList">Lista PropertiesList</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveObject</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">PropertiesList</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">op</span><span class="p">:</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Property: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span> <span class="s2">" Value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Add_a_single_Property_Comment"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Ad.C4.83ugarea_unei_propriet.C4.83.C8.9Bi_.22Comentariu.22"></span><span class="mw-headline" id='Adăugarea_unei_proprietăți_"Comentariu"'>Adăugarea unei proprietăți "Comentariu"</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span><span class="s2">"GComment"</span><span class="p">,</span><span class="s2">"Draft"</span><span class="p">,</span><span class="s2">"Font name"</span><span class="p">)</span><span class="o">.</span><span class="n">GComment</span> <span class="o">=</span> <span class="s2">"Comment here"</span>
<span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Top</a></p>
<div class="mw-collapsible mw-collapsed toccolours">
<p><span id="Search_and_data_extraction"></span>
</p>
<h3><span id="C.C4.83utarea_.C8.99i_extrac.C8.9Bia_datelor"></span><span class="mw-headline" id="Căutarea_și_extracția_datelor">Căutarea și extracția datelor</span></h3>
<p>Example de cautare și decodare a informației despre un obiect.
</p><p>Fiecare secțiune este independentă și este separată de diezi "############" poate fi copiată direct în consola Python sau într-o macrocomandă sau poate folosi această macrocomandă. Descrierea macrocomenzii în comentariu.
</p>
<div class="mw-translate-fuzzy">
<p>Afișajul se face în fereastra "View Report"  (View &gt; Views &gt; View report)
</p>
</div>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
 
<span class="c1"># Exemples de recherche et de decodage d'informations sur un objet</span>
<span class="c1"># Chaque section peut etre copiee directement dans la console Python ou dans une macro ou utilisez la macro tel quel</span>
<span class="c1"># Certaines commandes se repetent seul l'approche est differente</span>
<span class="c1"># L'affichage se fait dans la Vue rapport : Menu Affichage &gt; Vues &gt; Vue rapport</span>
<span class="c1">#</span>
<span class="c1"># Examples of research and decoding information on an object</span>
<span class="c1"># Each section can be copied directly into the Python console, or in a macro or uses this macro</span>
<span class="c1"># Certain commands as repeat alone approach is different</span>
<span class="c1"># Displayed in Report view: View &gt; Views &gt; report view</span>
<span class="c1">#</span>
<span class="c1"># rev:30/08/2014:29/09/2014:17/09/2015 22/11/2019 30/12/2022</span>
 
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">import</span> <span class="nn">DraftVecUtils</span><span class="o">,</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">Part</span>

<span class="c1">##################################################################################</span>
<span class="c1"># info in the object</span>

<span class="n">box</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s1">'Box'</span><span class="p">)</span>                                 <span class="c1"># object </span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>                                                           <span class="c1"># all options disponible in the object</span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>                                                           <span class="c1"># object name</span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">Content</span><span class="p">)</span>                                                        <span class="c1"># content of the object in XML format</span>
<span class="c1">##################################################################################</span>
<span class="c1">#</span>
<span class="c1"># example of using the information listed</span>
<span class="c1">#</span>
<span class="c1"># search the name of the active document </span>
<span class="n">mydoc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">Name</span>                                     <span class="c1"># Name of active Document</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Active docu    : "</span><span class="o">+</span><span class="p">(</span><span class="n">mydoc</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the document name and the name of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_FullName</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">FullName</span>                                         <span class="c1"># file Name and Name of the object selected</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_FullName: "</span><span class="o">+</span><span class="p">(</span><span class="n">object_FullName</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the label of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_Label</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Label</span>                                               <span class="c1"># Label of the object (modifiable)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_Label   : "</span><span class="o">+</span><span class="p">(</span><span class="n">object_Label</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1">#TypeID object FreeCAD selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"sel            : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># sel[0] first object selected</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the Name of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_Name</span>  <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Name</span>                                                <span class="c1"># Name of the object (not modifiable)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_Name    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">object_Name</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the Sub Element Name of the sub object selected</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SubElement</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>                    <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">element_</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                           <span class="c1"># name of 1 element selected</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"elementSelec   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">element_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="k">except</span><span class="p">:</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="c1">##################################################################################</span>

<span class="c1"># give the length of the subObject selected</span>
<span class="n">SubElementLength</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span> <span class="c1"># sub element or element name with getSelectionEx()</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"SubElement length: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SubElementLength</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span><span class="c1"># length</span>
<span class="c1">##################################################################################</span>

<span class="c1"># list the edges and the coordinates of the object[0] selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">):</span>                                   <span class="c1"># list all Edges</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edges n : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X1             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1"># coordinate XYZ first point</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Y1             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1">#</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Z1             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X2             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># coordinate XYZ second point</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Y2             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1">#</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Z2             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1">#</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>    
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>    
<span class="c1">##################################################################################</span>

<span class="c1"># give the sub element name, length, coordinates, BoundBox, BoundBox.Center, Area of the SubObjects selected</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SubElement</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>                                        <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">subElementName</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                     <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subElementName : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subElementName</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectLength</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span>                  <span class="c1"># sub element Length</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectLength: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectLength</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectX1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span>         <span class="c1"># sub element coordinate X1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_X1   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectX1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">subObjectY1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span>         <span class="c1"># sub element coordinate Y1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Y1   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectY1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">subObjectZ1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span>         <span class="c1"># sub element coordinate Z1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Z1   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectZ1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">subObjectX2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span>     <span class="c1"># sub element coordinate X2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_X2   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectX2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">subObjectY2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span>     <span class="c1"># sub element coordinate Y2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Y2   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectY2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">subObjectZ2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span>     <span class="c1"># sub element coordinate Z2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Z2   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectZ2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            

    <span class="n">subObjectBoundBox</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">BoundBox</span>              <span class="c1"># sub element BoundBox coordinates</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectBBox  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectBoundBox</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectBoundBoxCenter</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">BoundBox</span><span class="o">.</span><span class="n">Center</span> <span class="c1"># sub element BoundBoxCenter</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectBBoxCe: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectBoundBoxCenter</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">surfaceFace</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span>                        <span class="c1"># Area of the face selected</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"surfaceFace    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">surfaceFace</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="c1">##################################################################################</span>

<span class="c1"># give the area of the object</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">surface</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Area</span>                                               <span class="c1"># Area object complete</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"surfaceObjet   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the Center Of Mass and coordinates of the object</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">CenterOfMass</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">CenterOfMass</span>                                  <span class="c1"># Center of Mass of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMass   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassX  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>   <span class="c1"># coordinates [0]=X [1]=Y [2]=Z</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassY  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>   <span class="c1"># or CenterOfMass.x, CenterOfMass.y, CenterOfMass.z</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassZ  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># list the all faces of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">):</span>                                   <span class="c1"># List alles faces of the object</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face           : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"Face</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the volume of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">volume_</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Volume</span>                                             <span class="c1"># Volume of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"volume_        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">volume_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
 
<span class="c1"># give the BoundBox of the oject selected all type</span>
<span class="n">objs</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>                                                         <span class="c1"># serch the object type</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Shape"</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Mesh"</span><span class="p">):</span>      <span class="c1"># upgrade with wmayer thanks #http://forum.freecadweb.org/viewtopic.php?f=13&amp;t=22331</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Mesh</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Points"</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Points</span>

<span class="n">boundBox_</span><span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">BoundBox</span>                                                     <span class="c1"># BoundBox of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBox_      : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBox_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>         <span class="c1"># </span>
 
<span class="n">boundBoxLX</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XLength</span>                                          <span class="c1"># Length x boundBox rectangle</span>
<span class="n">boundBoxLY</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YLength</span>                                          <span class="c1"># Length y boundBox rectangle</span>
<span class="n">boundBoxLZ</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZLength</span>                                          <span class="c1"># Length z boundBox rectangle</span>

<span class="n">boundBoxXMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XMin</span>                                             <span class="c1"># coordonate XMin</span>
<span class="n">boundBoxYMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YMin</span>                                             <span class="c1"># coordonate YMin</span>
<span class="n">boundBoxZMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZMin</span>                                             <span class="c1"># coordonate ZMin</span>
<span class="n">boundBoxXMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XMax</span>                                             <span class="c1"># coordonate XMax</span>
<span class="n">boundBoxYMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YMax</span>                                             <span class="c1"># coordonate YMax</span>
<span class="n">boundBoxZMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZMax</span>                                             <span class="c1"># coordonate ZMax</span>

<span class="n">boundBoxDiag</span><span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">DiagonalLength</span>                                    <span class="c1"># Diagonal Length boundBox rectangle</span>
<span class="n">boundBoxCenter</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">Center</span>                                         <span class="c1"># BoundBox Center</span>
<span class="n">boundBoxCenterOfGravity</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">CenterOfGravity</span>                       <span class="c1"># BoundBox CenterOfGravity</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLX     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLX</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLY     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLZ     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLZ</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxXMin   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxXMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxYMin   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxYMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxZMin   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxZMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxXMax   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxXMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxYMax   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxYMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxZMax   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxZMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxDiag   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxDiag</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxCenter : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxCenter</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBox Center of Gravity : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxCenterOfGravity</span> <span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1">##################################################################################</span>

<span class="c1"># give the complete placement of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span>                                               <span class="c1"># Placement Vector XYZ and Yaw-Pitch-Roll</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement      : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement Base (xyz) of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span>                                          <span class="c1"># Placement Vector XYZ</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"PlacementBase  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
 
<span class="c1"># give the placement Base (xyz) of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">oripl_X</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                        <span class="c1"># decode Placement X</span>
<span class="n">oripl_Y</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                        <span class="c1"># decode Placement Y</span>
<span class="n">oripl_Z</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                                        <span class="c1"># decode Placement Z</span>

<span class="c1"># same </span>
<span class="c1">#oripl_X = sel[0].Placement.Base.x                                        # decode Placement X</span>
<span class="c1">#oripl_Y = sel[0].Placement.Base.y                                        # decode Placement Y</span>
<span class="c1">#oripl_Z = sel[0].Placement.Base.z                                        # decode Placement Z</span>
 
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_X        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_X</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_Y        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_Y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_Z        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_Z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement rotation of the object selected (x, y, z, angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">rotation</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span>                                      <span class="c1"># decode Placement Rotation</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"rotation              : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement rotation of the object selected (x, y, z, angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span>                                      <span class="c1"># decode Placement Rotation other method</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement Rot         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation of the object selected (angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span>                                <span class="c1"># decode Placement Rotation Angle</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement Rot Angle   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation.Q of the object selected (angle rotation in Radian) for convert: math.degrees(angleInRadian)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">Rot</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span>                                       <span class="c1"># Placement Rotation Q</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot           : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
 
<span class="n">Rot_0</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation Q</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_0         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_0</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_0</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>
 
<span class="n">Rot_1</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 1</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_1         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_1</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_1</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>
 
<span class="n">Rot_2</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 2</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_2         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_2</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_2</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>

<span class="n">Rot_3</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 3</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_3         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_3</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">Rot_Axis</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Axis</span>                                 <span class="c1"># Placement Rotation .Axis</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_Axis      : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_Axis</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
 
<span class="n">Rot_Angle</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span>                               <span class="c1"># Placement Rotation .Angle</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_Angle     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_Angle</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation of the object selected toEuler (angle rotation in degrees)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                             <span class="c1"># select object with getSelection()</span>
<span class="n">angle</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()</span>                   <span class="c1"># angle Euler</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Angle          : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Yaw</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Yaw (Z) lacet (alpha)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Yaw            : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Yaw</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Pitch</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Pitch (Y) tangage (beta)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Pitch          : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Pitch</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Roll</span>  <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Roll (X) roulis (gamma)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Roll           : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Roll</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">rot</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">()</span>
<span class="n">rot</span><span class="o">.</span><span class="n">setYawPitchRoll</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Angle: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Angle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Axis: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Axis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"RawAxis: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">RawAxis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"YawPitchRoll: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">getYawPitchRoll</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation: "</span><span class="p">,</span> <span class="n">rot</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Quaternion: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>

<span class="c1">##################################################################################</span>

<span class="c1"># find Midpoint of the selected line</span>
<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">DraftGeomUtils</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
<span class="n">vecteur</span> <span class="o">=</span> <span class="n">DraftGeomUtils</span><span class="o">.</span><span class="n">findMidpoint</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>              <span class="c1"># find Midpoint</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="n">vecteur</span><span class="p">)</span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makePoint</span><span class="p">(</span><span class="n">vecteur</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
</pre></div>
</div>
</div>
<p><a href="#top">Top</a></p>
<p><span id="Manual_search_of_an_element_with_label"></span>
</p>
<h3><span id="C.C4.83utarea_Manual.C4.83_a_unui_element_av.C3.A2nd_eticheta_sa"></span><span class="mw-headline" id="Căutarea_Manuală_a_unui_element_având_eticheta_sa">Căutarea Manuală a unui element având eticheta sa</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># Extract the coordinate X,Y,Z and Angle giving the label (here "Cylindre")</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.x       : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.y       : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.z       : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.Angle   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p><b>PS:</b> De obiecei unghiurile sunt dat în Radian, pentru a face conversia :
</p>
</div>
<ol><li>angle in Degrees to Radians :
<ul><li>Angle in radian = <b>pi * (angle in degree) / 180</b></li>
<li>Angle in radian = math.radians(angle in degree)</li></ul></li>
<li>angle in Radians to Degrees :
<ul><li>Angle in degree = <b>180 * (angle in radian) / pi</b></li>
<li>Angle in degree = math.degrees(angle in radian)</li></ul></li></ol>
<p><a href="#top">Top</a></p>
<p><span id="Cartesian_coordinates"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span class="mw-headline" id="Coordonate_Carteziene">Coordonate Carteziene</span></h3>
</div>
<p>Acest cod afișează coordonatele cartesiene ale elementului selectat.
</p><p>Modificați valoarea "numberOfPoints" dacă doriți o precizie mai mare sau mai mică
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">numberOfPoints</span> <span class="o">=</span> <span class="mi">100</span>                                                         <span class="c1"># Decomposition number (or precision you can change)</span>
<span class="n">selectedEdge</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># select one element</span>
<span class="n">points</span>  <span class="o">=</span> <span class="n">selectedEdge</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">numberOfPoints</span><span class="p">)</span>                            <span class="c1"># discretize the element</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>                                                             <span class="c1"># list and display the coordinates</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="s2">" X"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</pre></div>
<p>Altă metodă de afișarea a "Int" și "Float"
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">c</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>        <span class="c1"># create the circle</span>
<span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>                     <span class="c1"># display the shape</span>

<span class="c1"># slice accepts two arguments:</span>
<span class="c1">#+ the normal of the cross section plane</span>
<span class="c1">#+ the distance from the origin to the cross section plane. Here you have to find a value so that the plane intersects your object</span>
<span class="n">s</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># </span>

<span class="c1"># here the result is a single wire</span>
<span class="c1"># depending on the source object this can be several wires</span>
<span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># if you only need the vertexes of the shape you can use</span>
<span class="n">v</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>
    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span>

<span class="c1"># but you can also sub-sample the section to have a certain number of points (int) ...</span>
<span class="n">p1</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p1</span><span class="p">:</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>                                             <span class="c1"># Vector()</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">ii</span><span class="p">,</span> <span class="s2">": X:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">z</span> <span class="p">)</span>       <span class="c1"># Vector decode</span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makeWire</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>    <span class="c1"># to see the difference accuracy (20)</span>

<span class="c1">## uncomment to use</span>
<span class="c1">#import Draft</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # first transform the DWire in Wire         "downgrade"</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # second split the Wire in single objects   "downgrade"</span>
<span class="c1">#</span>
<span class="c1">##Draft.upgrade(FreeCADGui.Selection.getSelection(),delete=True) # to attach lines contiguous SELECTED use "upgrade"</span>


<span class="c1"># ... or define a sampling distance (float)</span>
<span class="n">p2</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p2</span><span class="p">:</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>                                             <span class="c1"># Vector()</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">ii</span><span class="p">,</span> <span class="s2">": X:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">z</span> <span class="p">)</span>       <span class="c1"># Vector decode </span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makeWire</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># to see the difference accuracy (0.5)</span>

<span class="c1">## uncomment to use</span>
<span class="c1">#import Draft</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # first transform the DWire in Wire         "downgrade"</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # second split the Wire in single objects   "downgrade"</span>
<span class="c1">#</span>
<span class="c1">##Draft.upgrade(FreeCADGui.Selection.getSelection(),delete=True) # to attach lines contiguous SELECTED use "upgrade"</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Select_all_objects_in_the_document"></span>
</p>
<h3><span id="Selecta.C8.9Bi_toate_obiectele_.C3.AEn_document"></span><span class="mw-headline" id="Selectați_toate_obiectele_în_document">Selectați toate obiectele în document</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span> <span class="p">)</span>                               <span class="c1"># display the object Name</span>
    <span class="n">objName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">objName</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>                 <span class="c1"># select the object</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Select_a_face_of_an_object_by_Name_object_and_Face_number"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Selectarea_fa.C8.9Betei_unui_obiect"></span><span class="mw-headline" id="Selectarea_fațetei_unui_obiect">Selectarea fațetei unui obiect</span></h3>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># select one face of the object</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">Draft</span>
<span class="n">App</span><span class="o">=</span><span class="n">FreeCAD</span>
<span class="n">nameObject</span> <span class="o">=</span> <span class="s2">"Box"</span>                             <span class="c1"># objet</span>
<span class="n">faceSelect</span> <span class="o">=</span> <span class="s2">"Face3"</span>                           <span class="c1"># face to selection</span>
<span class="n">loch</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nameObject</span><span class="p">)</span>  <span class="c1"># objet</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>                 <span class="c1"># clear all selection</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">loch</span><span class="p">,</span><span class="n">faceSelect</span><span class="p">)</span>    <span class="c1"># select the face specified</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>
<span class="c1">#Draft.makeFacebinder(s)                       #</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_Face_.28r.Q.29"></span><span class="mw-headline" id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_Face_(r.Q)">Get the normal vector of a face of an object by Name object and number Face (r.Q)</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">## normal of a face by giving the number of the face and the name of the object (rotation Q with yL, uV) = (App.Vector (x, y, z), angle))</span>
<span class="c1">## normal d'une face en donnant le numero de la face et le nom de l'objet (rotation Q avec yL, uV) = (App.Vector(x, y, z),angle))</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Vector</span>

<span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># number of the face searched (begin 0, 1, 2, 3 .....)</span>
<span class="n">nomObjet</span>    <span class="o">=</span> <span class="s2">"Box"</span>  <span class="c1"># object name</span>
<span class="n">yL</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">yL</span><span class="p">)</span>

<span class="n">nv</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">direction</span> <span class="o">=</span> <span class="n">yL</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">nv</span> <span class="o">+</span> <span class="n">yL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Direction  : "</span><span class="p">,</span><span class="n">direction</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">direction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation   : "</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation Q : "</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_of_Face">Get the normal vector of a face of an object by Name object and number of Face</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># number of the face searched (begin 0, 1, 2, 3 .....)</span>
<span class="n">nomObjet</span>    <span class="o">=</span> <span class="s2">"Box"</span>   <span class="c1"># object name</span>
<span class="n">normal</span>      <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numero_Face</span><span class="p">),</span> <span class="s2">" : "</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Get_the_normal_vector_of_an_object_selected_and_number_of_Face">Get the normal vector of an object selected and number of Face</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">## normal of a face by giving the number of the face of the selected object</span>
<span class="n">selectionObjects</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>     
<span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">3</span>    <span class="c1"># numero de la face recherchee</span>
<span class="n">normal</span> <span class="o">=</span> <span class="n">selectionObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
<span class="c1"># selectionne la face numerotee</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">selectionObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numero_Face</span><span class="p">))</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Get_the_normal_vector_on_the_surface"></span>
</p>
<div class="mw-translate-fuzzy">
<h3><span id="Determinarea_vectorului_normal.28.29_la_o_suprafa.C8.9B.C4.83"></span><span class="mw-headline" id="Determinarea_vectorului_normal()_la_o_suprafață">Determinarea vectorului normal() la o suprafață</span></h3>
</div>
<p>Acest exemplu arată modul de găsire a vectorului normal() a unei suprafețe prin căutarea  parametrilor u, v ai unui punct de pe suprafață și folosirea parametrilor u, v pentru a găsi vectorul normal()
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   <span class="n">ss</span><span class="o">=</span><span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="c1">#SubObjects[0] is the edge list</span>
   <span class="n">points</span>  <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="c1">#points on the surface edge, </span>
             <span class="c1">#this example just use points on the edge for example. </span>
             <span class="c1">#However point is not necessary on the edge, it can be anywhere on the surface. </span>
   <span class="n">face</span><span class="o">=</span><span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
   <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
      <span class="n">pt</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="c1">#a point on the surface edge</span>
      <span class="n">uv</span><span class="o">=</span><span class="n">face</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="c1"># find the surface u,v parameter of a point on the surface edge</span>
      <span class="n">u</span><span class="o">=</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">v</span><span class="o">=</span><span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">normal</span><span class="o">=</span><span class="n">face</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="c1">#use u,v to find normal vector</span>
      <span class="nb">print</span><span class="p">(</span> <span class="n">normal</span><span class="p">)</span>
      <span class="n">line</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">((</span><span class="n">pp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">normal</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">normal</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">normal</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
      <span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Get_the_normal_vector_of_the_face_and_create_a_line_at_the_point_mouse_clicked">Get the normal vector of the face and create a line at the point mouse clicked</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span> <span class="k">as</span> <span class="nn">Gui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">openTransaction</span><span class="p">(</span><span class="s2">"Tyty"</span><span class="p">)</span>    <span class="c1"># memorise les actions (avec annuler restore)</span>
<span class="n">selectedFace</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pointClick</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">PickedPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">########## section direction</span>
<span class="n">plr</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">yL</span> <span class="o">=</span> <span class="n">pointClick</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">selectedFace</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">yL</span><span class="p">)</span>
<span class="n">nv</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">selectedFace</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nv</span><span class="p">)</span>
<span class="n">plr</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">Q</span>
<span class="n">plr</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">pointClick</span>
<span class="c1">########## section direction</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">make_wire</span><span class="p">([</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">)]</span> <span class="p">)</span>    <span class="c1"># create line</span>
<span class="n">line</span><span class="o">.</span><span class="n">Placement</span><span class="o">=</span><span class="n">plr</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">"Direction (radian) : "</span><span class="p">,</span><span class="n">direction</span> <span class="p">)</span>    <span class="c1"># direction in radian</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Get_the_normal_vector_of_a_surface_from_a_STL_file">Get the normal vector of a surface from a STL file</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">getNormal</span><span class="p">(</span><span class="n">cb</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span> <span class="o">==</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoButtonEvent</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">getPickedPoint</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pp</span><span class="p">:</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getNormal</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">getDetail</span><span class="p">(),</span> <span class="s2">"SoFaceDetail"</span><span class="p">)</span><span class="o">.</span><span class="n">getFaceIndex</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Normal: </span><span class="si">{}</span><span class="s2">, Face index: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vec</span><span class="p">),</span> <span class="n">index</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="n">meth</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">getNormal</span><span class="p">)</span>
</pre></div>
<p>you are done then run for quit: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">removeEventCallbackPivy</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">meth</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Create_one_object_to_the_position_of_the_Camera"></span>
</p>
<h3><span id="Crearea_unui_obiect_fa.C8.9B.C4.83_de_pozi.C8.9Bia_Camerei_foto"></span><span class="mw-headline" id="Crearea_unui_obiect_față_de_poziția_Camerei_foto">Crearea unui obiect față de poziția  Camerei foto</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># create one object of the position to camera with "getCameraOrientation()"</span>
<span class="c1"># the object is still facing the screen</span>
<span class="kn">import</span> <span class="nn">Draft</span>

<span class="n">plan</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraOrientation</span><span class="p">()</span>
<span class="n">plan</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="c1">###### extract data</span>
<span class="n">a</span>    <span class="o">=</span> <span class="s2">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plan</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"0123456789e.- "</span><span class="p">):</span>
        <span class="n">a</span><span class="o">+=</span><span class="n">i</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
<span class="c1">####### extract data</span>

<span class="c1">#print( a)</span>
<span class="c1">#print( a[0])</span>
<span class="c1">#print( a[1])</span>
<span class="c1">#print( a[2])</span>
<span class="c1">#print( a[3])</span>

<span class="n">xP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">yP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">zP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">pl</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">xP</span><span class="p">,</span><span class="n">yP</span><span class="p">,</span><span class="n">zP</span><span class="p">,</span><span class="n">qP</span><span class="p">)</span>         <span class="c1"># rotation of object</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1"># here coordinates XYZ of Object</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># create rectangle</span>
<span class="c1">#rec = Draft.makeCircle(radius=5,placement=pl,face=False,support=None)                   # create circle</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">rec</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
</pre></div>
<p>aici avem același sod simplificat
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraOrientation</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Read_And_write_one_Expression"></span>
</p>
<h3><span id="Citirea_.C8.99i_Scrierea_unei_Expresii"></span><span class="mw-headline" id="Citirea_și_Scrierea_unei_Expresii">Citirea și Scrierea unei Expresii</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span>

<span class="n">pl</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeCircle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>    <span class="c1"># create circle</span>

<span class="nb">print</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">PropertiesList</span> <span class="p">)</span>                                                  <span class="c1"># properties disponible in the obj</span>

<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'Radius'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'2mm'</span><span class="p">)</span>                    <span class="c1"># modify the radius</span>
<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'Placement.Base.x'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'10mm'</span><span class="p">)</span>         <span class="c1"># modify the placement </span>
<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'FirstAngle'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'90'</span><span class="p">)</span>                 <span class="c1"># modify the first angle</span>
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>

<span class="n">expressions</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ExpressionEngine</span>                                         <span class="c1"># read the expression list</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">expressions</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>                                                      <span class="c1"># list and separate the data expression</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">" = "</span><span class="p">,</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Create_a_Sketch_on_a_Surface_in_PartDesign">Create a Sketch on a Surface in PartDesign</span></h3>
<p>This snippet can be useful, if you want to create a sketch on a surface in PartDesign from inside a macro.
Note, that body might be None, if no active body is selected and that the Selection might be empty.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">body</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getActiveObject</span><span class="p">(</span><span class="s1">'pdbody'</span><span class="p">)</span>
<span class="n">first_selection</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">first_selection</span><span class="o">.</span><span class="n">Object</span>
<span class="n">face_name</span> <span class="o">=</span> <span class="n">first_selection</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">sketch</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Sketcher::SketchObject'</span><span class="p">,</span><span class="s1">'MySketch'</span><span class="p">)</span>
<span class="n">body</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
<span class="n">sketch</span><span class="o">.</span><span class="n">MapMode</span> <span class="o">=</span> <span class="s1">'FlatFace'</span>
<span class="n">sketch</span><span class="o">.</span><span class="n">Support</span> <span class="o">=</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">face_name</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="How_to_Simulate_a_Mouse_Click_at_a_given_Coordinate">How to Simulate a Mouse Click at a given Coordinate</span></h3>
<p>The position is relative to the GL widget. See <a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=22&amp;t=44008" rel="nofollow">forum thread</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span>

<span class="n">mw</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QOpenGLWidget</span><span class="p">)</span>
<span class="n">me</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonRelease</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">sendEvent</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="n">me</span><span class="p">)</span>
</pre></div>
<p>If you have a 3d point and want to get the 2d point on the opengl widget then use this: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
<span class="n">point3d</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">point2d</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getPointOnScreen</span><span class="p">(</span><span class="n">point3d</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">coordX</span> <span class="o">=</span> <span class="n">point2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coordY</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">me</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonRelease</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">coordX</span><span class="p">,</span><span class="n">coordY</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="How_to_create_a_face_with_holes_using_Python_API">How to create a face with holes using Python API</span></h3>
<p>This snippet demonstrates how to create a face with internal holes through the Python API. See <a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=22&amp;t=56308" rel="nofollow">forum thread</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">Part</span>

<span class="c1"># Create poles that will define the Face</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="n">bs</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">BSplineCurve</span><span class="p">()</span>
<span class="n">bs</span><span class="o">.</span><span class="n">buildFromPoles</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># True makes this periodic/closed</span>

<span class="c1"># Make the Face from the curve</span>
<span class="n">myFace</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeFilledFace</span><span class="p">([</span><span class="n">bs</span><span class="o">.</span><span class="n">toShape</span><span class="p">()])</span>

<span class="c1"># Create geometry for holes that will be cut in the surface</span>
<span class="n">hole0</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Geom2d</span><span class="o">.</span><span class="n">Circle2d</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">hole1</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Geom2d</span><span class="o">.</span><span class="n">Circle2d</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">edge0</span> <span class="o">=</span> <span class="n">hole0</span><span class="o">.</span><span class="n">toShape</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
<span class="n">edge1</span> <span class="o">=</span> <span class="n">hole1</span><span class="o">.</span><span class="n">toShape</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
<span class="n">wireb</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">bs</span><span class="o">.</span><span class="n">toShape</span><span class="p">())</span>
<span class="n">wire0</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
<span class="n">wire1</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">edge1</span><span class="p">)</span>

<span class="c1"># Cut holes in the face</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">cutHoles</span><span class="p">([</span><span class="n">wire0</span><span class="p">])</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>  <span class="c1"># This is required</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">cutHoles</span><span class="p">([</span><span class="n">wire1</span><span class="p">])</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h3><span class="mw-headline" id="Close_and_restart_FreeCAD">Close and restart FreeCAD</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span> 
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>

<span class="k">def</span> <span class="nf">restart_freecad</span><span class="p">():</span>
    <span class="sd">"""Shuts down and restarts FreeCAD"""</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">arguments</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">():</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QProcess</span><span class="o">.</span><span class="n">startDetached</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">applicationFilePath</span><span class="p">(),</span> <span class="n">args</span>
        <span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<h2><span class="mw-headline" id="Coin3D">Coin3D</span></h2>
<p>See <a href="../Coin3d_snippets.html" title="Coin3d snippets">Coin3d snippets</a>
</p>
<p><a href="#top">Top</a></p>
<h2><span class="mw-headline" id="Related">Related</span></h2>
<ul><li><a href="../Scripted_objects.html" title="Scripted objects">Scripted objects</a></li>
<li><a href="../Macros.html" title="Macros">Macros</a></li>
<li><a href="../Topological_data_scripting.html" title="Topological data scripting">Topological_data_scripting</a></li></ul>
<p><a href="#top">Top</a></p>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
<div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Power_user_hub.png"><img decoding="async" height="24" src="../File/Power_user_hub.png" width="24"/></a></span> <a href="../ro\Power_users_hub.html" title="Power users hub/ro">Power user documentation</a>
<div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>FreeCAD scripting:</b> <a href="../ro\Python.html" title="Python/ro">Python</a>, <a href="../ro\Introduction_to_Python.html" title="Introduction to Python/ro">Introduction to Python</a>, <a href="../ro\Python_scripting_tutorial.html" title="Python scripting tutorial/ro">Python scripting tutorial</a>, <a href="../ro\FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/ro">FreeCAD Scripting Basics</a></li></ul>
<hr/>
<ul><li><b>Modules:</b> <a href="../ro\Builtin_modules.html" title="Builtin modules/ro">Builtin modules</a>, <a href="../ro\Units.html" title="Units/ro">Units</a>, <a class="new" href="../index.php?title=Quantity_ro&amp;action=edit&amp;redlink=1.html" title="Quantity/ro (page does not exist)">Quantity</a></li>
<li><b>Workbenches:</b> <a href="../ro\Workbench_creation.html" title="Workbench creation/ro">Workbench creation</a>, <a href="../ro\Gui_Command.html" title="Gui Command/ro">Gui Commands</a>, <a href="../ro\Command.html" title="Command/ro">Commands</a>, <a href="../ro\Installing_more_workbenches.html" title="Installing more workbenches/ro">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="../ro\Mesh_Scripting.html" title="Mesh Scripting/ro">Mesh Scripting</a>, <a href="../ro\Topological_data_scripting.html" title="Topological data scripting/ro">Topological data scripting</a>, <a href="../ro\Mesh_to_Part.html" title="Mesh to Part/ro">Mesh to Part</a>, <a href="../ro\PythonOCC.html" title="PythonOCC/ro">PythonOCC</a></li></ul>
<hr/>
<ul><li><b>Parametric objects:</b> <a href="../ro\Scripted_objects.html" title="Scripted objects/ro">Scripted objects</a>, <a class="new" href="../index.php?title=Viewprovider_ro&amp;action=edit&amp;redlink=1.html" title="Viewprovider/ro (page does not exist)">Viewproviders</a> <small>(<a class="new" href="../index.php?title=Custom_icon_in_tree_view_ro&amp;action=edit&amp;redlink=1.html" title="Custom icon in tree view/ro (page does not exist)">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../ro\Scenegraph.html" title="Scenegraph/ro">Coin (Inventor) scenegraph</a>, <a href="../ro\Pivy.html" title="Pivy/ro">Pivy</a></li>
<li><b>Graphical interface:</b> <a class="new" href="../index.php?title=Interface_creation_ro&amp;action=edit&amp;redlink=1.html" title="Interface creation/ro (page does not exist)">Interface creation</a>, <a href="../ro\Dialog_creation.html" title="Dialog creation/ro">Interface creation completely in Python</a> <small>(<a class="new" href="../index.php?title=Dialog_creation_with_various_widgets_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation with various widgets/ro (page does not exist)">1</a>, <a class="new" href="../index.php?title=Dialog_creation_reading_and_writing_files_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation reading and writing files/ro (page does not exist)">2</a>, <a class="new" href="../index.php?title=Dialog_creation_setting_colors_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation setting colors/ro (page does not exist)">3</a>, <a class="new" href="../index.php?title=Dialog_creation_image_and_animated_GIF_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation image and animated GIF/ro (page does not exist)">4</a>, <a class="new" href="../index.php?title=PySide_usage_snippets_ro&amp;action=edit&amp;redlink=1.html" title="PySide usage snippets/ro (page does not exist)">5</a>)</small>, <a href="../ro\PySide.html" title="PySide/ro">PySide</a>, PySide examples <a class="new" href="../index.php?title=PySide_Beginner_Examples_ro&amp;action=edit&amp;redlink=1.html" title="PySide Beginner Examples/ro (page does not exist)">beginner</a>, <a class="new" href="../index.php?title=PySide_Intermediate_Examples_ro&amp;action=edit&amp;redlink=1.html" title="PySide Intermediate Examples/ro (page does not exist)">intermediate</a>, <a class="new" href="../index.php?title=PySide_Advanced_Examples_ro&amp;action=edit&amp;redlink=1.html" title="PySide Advanced Examples/ro (page does not exist)">advanced</a></li>
<li><b>Macros:</b> <a href="../ro\Macros.html" title="Macros/ro">Macros</a>, <a href="../ro\How_to_install_macros.html" title="How to install macros/ro">How to install macros</a></li>
<li><b>Embedding:</b> <a href="../ro\Embedding_FreeCAD.html" title="Embedding FreeCAD/ro">Embedding FreeCAD</a>, <a href="../ro\Embedding_FreeCADGui.html" title="Embedding FreeCADGui/ro">Embedding FreeCADGui</a></li></ul>
<hr/>
<ul><li><b>Other:</b> <a class="new" href="../index.php?title=Expressions_ro&amp;action=edit&amp;redlink=1.html" title="Expressions/ro (page does not exist)">Expressions</a>, <a class="mw-selflink selflink">Code snippets</a>, <a href="../ro\Line_drawing_function.html" title="Line drawing function/ro">Line drawing function</a>, <a href="../ro\FreeCAD_vector_math_library.html" title="FreeCAD vector math library/ro">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr/>
<ul><li><b>Hubs:</b> <a href="../ro\User_hub.html" title="User hub/ro">User hub</a>, <a href="../ro\Power_users_hub.html" title="Power users hub/ro">Power users hub</a>, <a href="../ro\Developer_hub.html" title="Developer hub/ro">Developer hub</a></li></ul></div>
</div></div>
<!-- 
NewPP limit report
Cached time: 20241214203552
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.339 seconds
Real time usage: 1.879 seconds
Preprocessor visited node count: 1257/1000000
Post‐expand include size: 12094/2097152 bytes
Template argument size: 56576/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 59/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 268382/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 1564.456      1 -total
 99.16% 1551.274     59 Template:Code
  0.18%    2.877      1 Template:Powerdocnavi/ro
  0.09%    1.394     50 Template:Top
  0.08%    1.264      1 Template:Navigation_menu_2
  0.05%    0.799      1 Template:Incode
  0.04%    0.577      1 Template:TOCright
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:33649-0!canonical and timestamp 20241214203550 and revision id 1353633. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
