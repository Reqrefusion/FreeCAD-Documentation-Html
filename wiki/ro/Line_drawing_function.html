<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Line drawing function/ro</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../id\Line_drawing_function.html" lang="id" title="Line drawing function (3% translated)">Bahasa Indonesia</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../de\Line_drawing_function.html" lang="de" title="Linienzeichnungsfunktion (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Line_drawing_function.html" lang="en" title="Line drawing function (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../tr\Line_drawing_function.html" lang="tr" title="Line drawing function (3% translated)">Türkçe</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../es\Line_drawing_function.html" lang="es" title="Line drawing function (12% translated)">español</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../fr\Line_drawing_function.html" lang="fr" title="Fonction - tracer une ligne (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../it\Line_drawing_function.html" lang="it" title="Funzione per disegnare delle linee (35% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../pl\Line_drawing_function.html" lang="pl" title="Funkcja rysowania linii (100% translated)">polski</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--stub" dir="ltr" lang="ro">română</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../sv\Line_drawing_function.html" lang="sv" title="Line drawing function (12% translated)">svenska</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../cs\Line_drawing_function.html" lang="cs" title="Line drawing function (3% translated)">čeština</a></li>
<li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../ru\Line_drawing_function.html" lang="ru" title="Функция рисования линии (28% translated)">русский</a></li></ul></div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Scriptul_Principal"><span class="tocnumber">2</span> <span class="toctext">Scriptul Principal</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Explicații_detaliate"><span class="tocnumber">3</span> <span class="toctext">Explicații detaliate</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Testing_&amp;_Using_the_script"><span class="tocnumber">4</span> <span class="toctext">Testing &amp; Using the script</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Înregistrarea_scriptului_în_interfața_FreeCAD"><span class="tocnumber">5</span> <span class="toctext">Înregistrarea scriptului în interfața FreeCAD</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Deci_vrei_mai_mult?"><span class="tocnumber">6</span> <span class="toctext">Deci vrei mai mult?</span></a></li>
</ul>
</div>
</div>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<div class="mw-translate-fuzzy">
<p>Această pagină arată modul în care se poate construi cu ușurință o funcționalitatea avansată în Python. În acest exercițiu, vom construi un nou instrument care atrage o linie. Acest instrument poate fi apoi legat la o comandă FreeCAD și această comandă poate fi apelată de orice element al interfeței, cum ar fi un element de meniu sau un buton din bara de unelte.
</p>
</div>
<p><span id="The_main_script"></span>
</p>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Scriptul_Principal">Scriptul Principal</span></h2>
<p>Mai întâi vom scrie un script care conține toate funcționalitățile noastre. Apoi, vom salva acest lucru într-un fișier și îl vom importa în FreeCAD, astfel încât toate clasele și funcțiile pe care le scriem vor fi disponibile pentru FreeCAD. Deci, lansați editorul de text preferat și tastați următoarele rânduri:
</p>
</div>
<p>First we will write a script containing all our functionality. Then we will save this in a file and import it in FreeCAD to make all its classes and functions available. Launch your favorite code editor and type the following lines:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCADGui</span><span class="o">,</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">pivy.coin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">line</span><span class="p">:</span>

    <span class="sd">"""This class will create a line after the user clicked 2 points on the screen"""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getpoint</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_cb</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">event_cb</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span> <span class="o">==</span> <span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
            <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">LineSegment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span>
                <span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">removeEventCallbackPivy</span><span class="p">(</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Top</a></p>
<p><span id="Detailed_explanation"></span>
</p>
<h2><span id="Explica.C8.9Bii_detaliate"></span><span class="mw-headline" id="Explicații_detaliate">Explicații detaliate</span></h2>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">pivy.coin</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>În Python, atunci când doriți să utilizați funcții dintr-un alt modul, trebuie să-l importați. În cazul nostru, vom avea nevoie de funcții de la <a href="../Part_Workbench.html" title="Part Workbench">Part Workbench</a>, pentru crearea liniei și de la modulul Gui (FreeCADGui), pentru a accesa vizualizarea 3D. De asemenea, avem nevoie de conținutul complet al bibliotecii de monede, astfel încât să putem folosi direct toate obiectele precum coin, SoMouseButtonEvent, (eveniment mouse) etc ...
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">line</span><span class="p">:</span>
</pre></div>
<p>Aici definim clasa noastră principală. De ce folosim o clasă și nu o funcție? Motivul este că avem nevoie ca instrumentul nostru să rămână "în viață" în timp ce așteptăm ca utilizatorul să facă clic pe ecran. O funcție se termină atunci când sarcina sa a fost făcută, dar un obiect (o clasă definește un obiect) rămâne în viață până când este distrus.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="sd">"""This class will create a line after the user clicked 2 points on the screen"""</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>În Python, fiecare clasă sau funcție poate avea o descriere. Acest lucru este util în particular în FreeCAD, deoarece atunci când veți apela acea clasă în interpret, descrierea va fi afișată ca o sugestie .
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Clasele Python întotdeauna trebuie să conțină  o funcție __init__function, care este executată atunci când clasa este apelată să creeze un obiect. Deci, vom pune aici tot ce vrem să se întâmple atunci când instrumentul nostru de linie începe(este apelat).
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Într-o clasă, de obicei, este de dorit să adăugați "self" înaintea unui nume de variabilă, astfel încât să fie ușor accesibilă tuturor funcțiilor din interiorul și din afara clasei respective. Aici vom folosi self.view pentru a accesa și manipula vizualizarea 3D activă.
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Aici vom crea o listă goală care va conține punctele în 3D trimise de funcția getpoint.
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getpoint</span><span class="p">)</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Acesta este un punct/parte importantă: Deoarece că este vorba de o o scenă <a class="external text" href="http://www.coin3d.org/" rel="nofollow">coin3D</a>, FreeCAD folosește mecanismul de apel invers, care permite unei funcții să fie apelată de fiecare dată când se întâmplă un anumit eveniment scenă. În cazul nostru, creăm un apel invers pentru evenimentele <a class="external text" href="http://doc.coin3d.org/Coin/group__events.html" rel="nofollow">SoMouseButtonEvent</a> și îl legăm la funcția getpoint. Acum, de fiecare dată când este apăsat sau eliberat un buton mouse-ului, funcția GetPoint va fi executată.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>Rețineți că există, de asemenea, o alternativă la addEventCallbackPivy() numită addEventCallback() care exclude utilizarea pivy. Dar, din moment ce pivu este o modalitate foarte eficientă și naturală de a accesa orice parte a scenei coin, este mult mai bine să o utilizați cât de mult puteți!
</p>
</div>
<p><a href="#top">Top</a></p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">getpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_cb</span><span class="p">):</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Acum definim funcția GetPoint, care va fi executată atunci când un buton al mouse-ului este apăsat într-o vizualizare 3D. Această funcție va primi un argument, pe care îl vom numi event_cb. De la acest apel al evenimentului, putem accesa obiectul eveniment, care conține mai multe informații -mai multe informații pe această pagină (modul info<a href="../Code_snippets.html#Observing_mouse_events_in_the_3D_viewer_via_Python" title="Code snippets">here</a>).
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span> <span class="o">==</span> <span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Funcția GetPoint va fi apelată când un buton al mouse-ului este apăsat sau eliberat. Dar vrem să alegem un punct 3D numai atunci când este presat (altfel am obține două puncte foarte aproape unul de celălalt). Așa că trebuie să verificăm asta
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Aici găsim coordonatele cursorului mouse-ului pe ecran
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Această funcție ne dă un vector FreeCAD (x, y, z) ale punctului care se află pe planul focal, chiar sub cursorul mouse-ului. Dacă vă aflați într-o vizualizare a camerei foto, imaginați-vă camera trece prin cursorul mouse-ului și atinge planul focal. Acesta este punctul nostru 3D. Dacă suntem în vedere ortogonală, raza este paralelă cu direcția de vizualizare.
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Noi adăugăm elementul nostru nou în stivă/morman
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</pre></div>
<p>Avem toate punctele necesare? dacă da, atunci să tragem linia!
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">LineSegment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Aici folosim funcția line() din <a href="../Part_Workbench.html" title="Part Workbench">Part Workbench</a> care a creat o linie din două vectori FreeCAD. Tot ceea ce creăm și modificăm în interiorul modulului Part, rămâne în modulul Part. Deci, până acum, am creat o piesă tip linie. Nu este legat de niciun obiect al documentului nostru activ, deci nu apare nimic pe ecran.
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Documentul FreeCAD poate accepta decât forme  din modulul Part Module. Formele sunt cel mai generic tip al  Part Module. Deci, trebuie să convertim linia noastră într-o formă înainte de a o adăuga la document.
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Modulul Part Module are o funcție foarte utilă show(), care creează un obiect nou în document și se leagă la o formă. De asemenea, am putea să avem un nou obiect în primul document, apoi să-l legăm manual la formă.
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">removeEventCallbackPivy</span><span class="p">(</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Deoarece am terminat cu linia noastră, să eliminăm mecanismul de apel invers, care consumă cicluri CPU prețioase.
</p>
</div>
<p><a href="#top">Top</a></p>
<p><span id="Testing_the_script"></span>
</p>
<div class="mw-translate-fuzzy">
<h2><span id="Testing_.26_Using_the_script"></span><span class="mw-headline" id="Testing_&amp;_Using_the_script">Testing &amp; Using the script</span></h2>
<p>Acum, hai să salvăm scriptul într-un loc unde interpretul Python de la FreeCAD îl va găsi. Când importați module, interpretorul va căuta în următoarele locuri: căile de instalare python, directorul bin FreeCAD și toate directoarele modulelor FreeCAD. Deci, cea mai bună soluție este să creați un director nou într-unul din FreeCAD <a href="../Installing_more_workbenches.html" title="Installing more workbenches"> Mod directories</a> și să salvați scriptul în el. De exemplu, să facem un director "MyScripts" și să salvăm scriptul nostru ca "exercise.py".
</p>
</div>
<p>Now let's save our script in a folder where the FreeCAD Python interpreter can find it. When importing modules, the interpreter will look in the following places: the Python installation paths, the FreeCAD <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">bin</span> folder, and all FreeCAD <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">Mod</span> (module) folders. So the best solution is to create a new folder in one of the <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">Mod</span> folders. Let's create a <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">MyScripts</span> folder there and save our script in it as <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">exercise.py</span>.
</p>
<div class="mw-translate-fuzzy">
<p>Acum, totul este gata, să începem FreeCAD, să creăm un nou document și, în interpretorul python, să tastăm:
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">exercise</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Dacă nu apare niciun mesaj de eroare, înseamnă că scriptul nostru de exerciții <b>exercise</b> a fost încărcat. Acum îi putem verifica conținutul cu:
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">exercise</span><span class="p">)</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Comanda <b>dir()</b> este o comandă python încorporată care listează/enumeră conținutul unui modul. Putem vedea că clasa noastră <b>class line()</b> este aici, așteptându-ne. Acum, să o testăm:
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="s1">'line'</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">exercise</span><span class="p">)</span>
</pre></div>
<p>Now let's test it:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">exercise</span><span class="o">.</span><span class="n">line</span><span class="p">()</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Apoi, faceți dublu clic în vizualizarea 3D, și bingo, aici este linia noastră! Pentru a face din nou, doar tastați <b>exercise.line()</b> din nou, și din nou și din nou ... Vă simțiți minunat, nu-i așa?
</p>
</div>
<p><a href="#top">Top</a></p>
<p><span id="Registering_the_script"></span>
</p>
<div class="mw-translate-fuzzy">
<h2><span id=".C3.8Enregistrarea_scriptului_.C3.AEn_interfa.C8.9Ba_FreeCAD"></span><span class="mw-headline" id="Înregistrarea_scriptului_în_interfața_FreeCAD">Înregistrarea scriptului în interfața FreeCAD</span></h2>
<p>Acum, pentru ca noul nostru instrument de trasat linii să fie foarte cool, ar trebui să aibă un buton pe interfață, deci să nu trebuiescă să tastăm toate acele lucruri de fiecare dată. Cea mai ușoară cale este să ne transformăm noul director MyScripts într-un atelier de lucru complet FreeCAD. Este ușor, tot ce este necesar este să plasați un fișier numit <b>InitGui.py</b> în directorul MyScripts. InitGui.py va conține instrucțiunile pentru a crea un nou atelier de lucru și va adăuga noul instrument. În plus, va trebui să transformăm un pic codul nostru de exerciții, astfel încât instrumentul line() este recunoscut ca o comandă oficială FreeCAD. Să începem prin a face un fișier InitGui.py și scrieți următorul cod în el:
</p>
</div>
<p>For our new line tool to be really useful, and to avoid having to type all that stuff, it should have a button in the interface. One way to do this is to transform our new <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">MyScripts</span> folder into a full FreeCAD workbench. This is easy, all that is needed is to put a file called <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">InitGui.py</span> inside the <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">MyScripts</span> folder. <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">InitGui.py</span> will contain the instructions to create a new workbench, and add our new tool to it. Besides that we will also need to change our exercise code a bit, so the <code>line()</code> tool is recognized as an official FreeCAD command. Let's start by creating an <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">InitGui.py</span> file, and writing the following code in it:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">MyWorkbench</span> <span class="p">(</span><span class="n">Workbench</span><span class="p">):</span>

    <span class="n">MenuText</span> <span class="o">=</span> <span class="s2">"MyScripts"</span>

    <span class="k">def</span> <span class="nf">Initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">exercise</span>
        <span class="n">commandslist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"line"</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendToolbar</span><span class="p">(</span><span class="s2">"My Scripts"</span><span class="p">,</span> <span class="n">commandslist</span><span class="p">)</span>

<span class="n">Gui</span><span class="o">.</span><span class="n">addWorkbench</span><span class="p">(</span><span class="n">MyWorkbench</span><span class="p">())</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Până acum, ar fi trebuit să fi înțeles deja scriptul de mai sus, mă gândesc eu: Creați o nouă clasă pe care o numiți MyWorkbench. Îi vom da un titlu (MenuText) și vom defini o funcție Initialize() care va fi executată atunci când atelierul de lucru este încărcat în FreeCAD. În această funcție, încărcăm conținutul fișierului de exerciții și adăugăm comenzile FreeCAD găsite în interiorul unei liste de comenzi. Apoi, facem o bară de instrumente numită "Scripturile mele" și îi atribuim comenzile noastre. În prezent, desigur, avem doar un singur instrument, astfel că lista noastră de comenzi conține doar un singur element.  Apoi, odată ce atelierul nostru de lucru este gata, îl adăugăm la interfața principală.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>Dar acest lucru nu va funcționa, deoarece o comandă FreeCAD trebuie să fie formatată într-un anumit mod de lucru. Deci, va trebui să transformăm puțin instrumentul nostru <b>line()</b>. Noul nostu script <b>exercise.py</b> va arăta cam așa:
</p>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCADGui</span><span class="o">,</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">pivy.coin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">line</span><span class="p">:</span>

    <span class="sd">"""This class will create a line after the user clicked 2 points on the screen"""</span>

    <span class="k">def</span> <span class="nf">Activated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getpoint</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_cb</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">event_cb</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span> <span class="o">==</span> <span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
            <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">LineSegment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span>
                <span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">removeEventCallbackPivy</span><span class="p">(</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">GetResources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">'Pixmap'</span><span class="p">:</span> <span class="s1">'path_to_an_icon/line_icon.png'</span><span class="p">,</span> <span class="s1">'MenuText'</span><span class="p">:</span> <span class="s1">'Line'</span><span class="p">,</span> <span class="s1">'ToolTip'</span><span class="p">:</span> <span class="s1">'Creates a line by clicking 2 points on the screen'</span><span class="p">}</span>

<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">addCommand</span><span class="p">(</span><span class="s1">'line'</span><span class="p">,</span> <span class="n">line</span><span class="p">())</span>
</pre></div>
<div class="mw-translate-fuzzy">
<p>Ceea ce am făcut aici? noi am transformat funcția noastră __init__() function într-o funcție <b>Activated()</b>, deoarece atunci când comenzile FreeCAD sunt executate, ele execută automat funcția <b>Activated()</b>. Am adăugat, de asemenea, o funcție GetResources (), care informează FreeCAD unde poate găsi o pictogramă pentru instrument și care va fi numele și sugestia/indicația instrumentului nostru. Orice imagine jpg, png sau svg va funcționa ca o pictogramă/iconiță, poate fi orice dimensiune, dar este mai bine să utilizați o dimensiune care este aproape de aspectul final, cum ar fi 16x16, 24x24 sau 32x32.
Apoi, adăugăm <b>class line()</b> ca o comandă oficială FreeCAD cu metoda <b>addCommand()</b>.
</p>
</div>
<div class="mw-translate-fuzzy">
<p>Asta este, vrem să reporniți FreeCAD și vom avea un nou atelier de lucru cu noul nostru instrument linie <b>line</b>!
</p>
</div>
<p><a href="#top">Top</a></p>
<p><span id="So_you_want_more?"></span>
</p>
<h2><span id="Deci_vrei_mai_mult.3F"></span><span class="mw-headline" id="Deci_vrei_mai_mult?">Deci vrei mai mult?</span></h2>
<div class="mw-translate-fuzzy">
<p>Dacă ți-a plăcut acest exercițiu, de ce să nu încerci să îmbunătățești acest mic instrument? Sunt multe lucruri care pot fi făcute, ca de exemplu:
</p>
<ul><li>Adăugați comentarii utilizatorilor: până acum am făcut un instrument foarte subțire îmbrăcat, utilizatorul ar putea fi un pic pierdut atunci când îl utilizează. Așadar, am putea adăuga comentarii, spunându-i ce să facă în continuare. De exemplu, puteți emite mesaje către consola FreeCAD. ”Aruncați o privire” în modulul FreeCAD.Console</li>
<li>Adăugați posibilitatea de a introduce manual coordonatele punctelor 3D. Uitați-vă la funcția  python input(), de exemplu,</li>
<li>Adăugați posibilitatea de a adăuga mai mult de 2 puncte</li>
<li>Adăugați evenimente pentru alte lucruri: Acum verificăm doar evenimentele butonului mouse-ului, dacă am face și ceva când mouse-ul este mutat, cum ar fi afișarea coordonatelor curente?</li>
<li>Dați un nume obiectului creat și multe alte lucruri.</li></ul>
<p>Nu ezitați să vă scrieți întrebările sau ideile pe <a class="external text" href="http://forum.freecadweb.org/" rel="nofollow">forum</a>!
</p>
</div>
<p>Don't hesitate to ask questions or share ideas on the <a class="external text" href="https://forum.freecadweb.org/" rel="nofollow">forum</a>!
</p>
<p><a href="#top">Top</a></p>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
<div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Power_user_hub.png"><img decoding="async" height="24" src="../File/Power_user_hub.png" width="24"/></a></span> <a href="../ro\Power_users_hub.html" title="Power users hub/ro">Power user documentation</a>
<div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>FreeCAD scripting:</b> <a href="../ro\Python.html" title="Python/ro">Python</a>, <a href="../ro\Introduction_to_Python.html" title="Introduction to Python/ro">Introduction to Python</a>, <a href="../ro\Python_scripting_tutorial.html" title="Python scripting tutorial/ro">Python scripting tutorial</a>, <a href="../ro\FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/ro">FreeCAD Scripting Basics</a></li></ul>
<hr/>
<ul><li><b>Modules:</b> <a href="../ro\Builtin_modules.html" title="Builtin modules/ro">Builtin modules</a>, <a href="../ro\Units.html" title="Units/ro">Units</a>, <a class="new" href="../index.php?title=Quantity_ro&amp;action=edit&amp;redlink=1.html" title="Quantity/ro (page does not exist)">Quantity</a></li>
<li><b>Workbenches:</b> <a href="../ro\Workbench_creation.html" title="Workbench creation/ro">Workbench creation</a>, <a href="../ro\Gui_Command.html" title="Gui Command/ro">Gui Commands</a>, <a href="../ro\Command.html" title="Command/ro">Commands</a>, <a href="../ro\Installing_more_workbenches.html" title="Installing more workbenches/ro">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="../ro\Mesh_Scripting.html" title="Mesh Scripting/ro">Mesh Scripting</a>, <a href="../ro\Topological_data_scripting.html" title="Topological data scripting/ro">Topological data scripting</a>, <a href="../ro\Mesh_to_Part.html" title="Mesh to Part/ro">Mesh to Part</a>, <a href="../ro\PythonOCC.html" title="PythonOCC/ro">PythonOCC</a></li></ul>
<hr/>
<ul><li><b>Parametric objects:</b> <a href="../ro\Scripted_objects.html" title="Scripted objects/ro">Scripted objects</a>, <a class="new" href="../index.php?title=Viewprovider_ro&amp;action=edit&amp;redlink=1.html" title="Viewprovider/ro (page does not exist)">Viewproviders</a> <small>(<a class="new" href="../index.php?title=Custom_icon_in_tree_view_ro&amp;action=edit&amp;redlink=1.html" title="Custom icon in tree view/ro (page does not exist)">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../ro\Scenegraph.html" title="Scenegraph/ro">Coin (Inventor) scenegraph</a>, <a href="../ro\Pivy.html" title="Pivy/ro">Pivy</a></li>
<li><b>Graphical interface:</b> <a class="new" href="../index.php?title=Interface_creation_ro&amp;action=edit&amp;redlink=1.html" title="Interface creation/ro (page does not exist)">Interface creation</a>, <a href="../ro\Dialog_creation.html" title="Dialog creation/ro">Interface creation completely in Python</a> <small>(<a class="new" href="../index.php?title=Dialog_creation_with_various_widgets_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation with various widgets/ro (page does not exist)">1</a>, <a class="new" href="../index.php?title=Dialog_creation_reading_and_writing_files_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation reading and writing files/ro (page does not exist)">2</a>, <a class="new" href="../index.php?title=Dialog_creation_setting_colors_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation setting colors/ro (page does not exist)">3</a>, <a class="new" href="../index.php?title=Dialog_creation_image_and_animated_GIF_ro&amp;action=edit&amp;redlink=1.html" title="Dialog creation image and animated GIF/ro (page does not exist)">4</a>, <a class="new" href="../index.php?title=PySide_usage_snippets_ro&amp;action=edit&amp;redlink=1.html" title="PySide usage snippets/ro (page does not exist)">5</a>)</small>, <a href="../ro\PySide.html" title="PySide/ro">PySide</a>, PySide examples <a class="new" href="../index.php?title=PySide_Beginner_Examples_ro&amp;action=edit&amp;redlink=1.html" title="PySide Beginner Examples/ro (page does not exist)">beginner</a>, <a class="new" href="../index.php?title=PySide_Intermediate_Examples_ro&amp;action=edit&amp;redlink=1.html" title="PySide Intermediate Examples/ro (page does not exist)">intermediate</a>, <a class="new" href="../index.php?title=PySide_Advanced_Examples_ro&amp;action=edit&amp;redlink=1.html" title="PySide Advanced Examples/ro (page does not exist)">advanced</a></li>
<li><b>Macros:</b> <a href="../ro\Macros.html" title="Macros/ro">Macros</a>, <a href="../ro\How_to_install_macros.html" title="How to install macros/ro">How to install macros</a></li>
<li><b>Embedding:</b> <a href="../ro\Embedding_FreeCAD.html" title="Embedding FreeCAD/ro">Embedding FreeCAD</a>, <a href="../ro\Embedding_FreeCADGui.html" title="Embedding FreeCADGui/ro">Embedding FreeCADGui</a></li></ul>
<hr/>
<ul><li><b>Other:</b> <a class="new" href="../index.php?title=Expressions_ro&amp;action=edit&amp;redlink=1.html" title="Expressions/ro (page does not exist)">Expressions</a>, <a href="../ro\Code_snippets.html" title="Code snippets/ro">Code snippets</a>, <a class="mw-selflink selflink">Line drawing function</a>, <a href="../ro\FreeCAD_vector_math_library.html" title="FreeCAD vector math library/ro">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr/>
<ul><li><b>Hubs:</b> <a href="../ro\User_hub.html" title="User hub/ro">User hub</a>, <a href="../ro\Power_users_hub.html" title="Power users hub/ro">Power users hub</a>, <a href="../ro\Developer_hub.html" title="Developer hub/ro">Developer hub</a></li></ul></div>
</div></div>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241214202947
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.123 seconds
Real time usage: 1.216 seconds
Preprocessor visited node count: 552/1000000
Post‐expand include size: 9298/2097152 bytes
Template argument size: 5209/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 24/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 21611/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 1082.803      1 -total
 99.08% 1072.866     24 Template:Code
  0.27%    2.935      1 Template:Powerdocnavi/ro
  0.13%    1.442      1 Template:Navigation_menu_2
  0.11%    1.207      6 Template:Top
  0.08%    0.840     10 Template:FileName
  0.06%    0.645      1 Template:TOCright
  0.06%    0.626      1 Template:Incode
  0.05%    0.506      1 Template:Clear
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:65493-0!canonical and timestamp 20241214202946 and revision id 1385049. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
