<link href="site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Sandbox:TechDraw TemplateHelper</span></h1><div class="mw-parser-output"><p>Still not finishedÂ :-)
</p>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
<div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="File/Freecad.svg" width="16"/></span></span></div>
<div style="margin: 4px 0; float: right;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="File/Freecad.svg" width="16"/></span></span></div>
<div style="text-align:center"><a href="Online_Help_Toc.html" title="Online Help Toc">Index</a> <span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="24" src="File/Online_Help_Toc.svg" width="24"/></span></span></div>
</div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Task_list"><span class="tocnumber">2</span> <span class="toctext">Task list</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Insert_a_page_and_template"><span class="tocnumber">3</span> <span class="toctext">Insert a page and template</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Insert_just_one_page_and_template"><span class="tocnumber">3.1</span> <span class="toctext">Insert just one page and template</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Insert_more_than_just_one_page_and_template"><span class="tocnumber">3.2</span> <span class="toctext">Insert more than just one page and template</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Generate_a_template"><span class="tocnumber">4</span> <span class="toctext">Generate a template</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Generate_a_simple_blank_page_template"><span class="tocnumber">4.1</span> <span class="toctext">Generate a simple blank page template</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Add_code_segments_to..."><span class="tocnumber">4.2</span> <span class="toctext">Add code segments to...</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#..._create_frames"><span class="tocnumber">4.2.1</span> <span class="toctext">... create frames</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#..._to_add_index_fields"><span class="tocnumber">4.2.2</span> <span class="toctext">... to add index fields</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#..._create_title_block_elements"><span class="tocnumber">4.2.3</span> <span class="toctext">... create title block elements</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#The_resulting_macro"><span class="tocnumber">4.3</span> <span class="toctext">The resulting macro</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Set_up_a_user_interface"><span class="tocnumber">5</span> <span class="toctext">Set up a user interface</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#A_simple_user_interface_window"><span class="tocnumber">5.1</span> <span class="toctext">A simple user interface window</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#A_user_interface_window_with_buttons"><span class="tocnumber">5.2</span> <span class="toctext">A user interface window with buttons</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#A_user_interface_window_with_combo-box"><span class="tocnumber">5.3</span> <span class="toctext">A user interface window with combo-box</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Manipulate_editable_texts"><span class="tocnumber">6</span> <span class="toctext">Manipulate editable texts</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Look_for_existing_Pages"><span class="tocnumber">6.1</span> <span class="toctext">Look for existing Pages</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Read_and_write_editable_texts"><span class="tocnumber">6.2</span> <span class="toctext">Read and write editable texts</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Add_a_user_interface"><span class="tocnumber">6.3</span> <span class="toctext">Add a user interface</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Combined_code"><span class="tocnumber">7</span> <span class="toctext">Combined code</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Generate_A3_template_and_insert_it"><span class="tocnumber">7.1</span> <span class="toctext">Generate A3 template and insert it</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Select_format_and_generate_a_template_then_insert_it"><span class="tocnumber">7.2</span> <span class="toctext">Select format and generate a template then insert it</span></a></li>
</ul>
</li>
</ul>
</div>
</div>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>This document is about creating a drawing template and to insert into a FreeCAD file using a Python macro.
</p><p>I managed to automate my drawing generation with a Python script which
</p>
<dl><dd><ul><li>generates a temporary svg template of the desired size (DIN A formats so far...)</li>
<li>inserts this temporary template into the active FreeCAD document</li>
<li>fills some values into the editable text fields</li></ul></dd></dl>
<p>The development was somehow chaotic, because I'm still learning Python and some solution may seen to be a little odd - but it works at least...
</p><p>Now I'd like to share what I have learned and coded so far and rewrite it in a tidier way.
</p><p>I think it is better to show how to solve certain problems rather than just presenting a somehow finished macro.
</p><p>Anyone is invited to borrow some code and develop similar or hopefully better tools that make handling drawings easier.
</p>
<pre>This sandbox is to start my documentation. At some further state it may be split into several pages for easier use.
</pre>
<h2><span class="mw-headline" id="Task_list">Task list</span></h2>
<p>To automatically generate a drawing page we need to know
</p>
<dl><dd><ul><li>how to insert a template into a FreeCAD document</li>
<li>how to set up a user interface to set some page parameters</li>
<li>how to generate a template</li>
<li>how to manipulate editable texts</li></ul></dd></dl>
<h2><span class="mw-headline" id="Insert_a_page_and_template">Insert a page and template</span></h2>
<p>Usually a template will be inserted into the active FreeCAD document which means a FreeCAD must be running and a file must be opened.
</p><p>As this macro is launched from within a FreeCAD file the only variables that needs to be set are
</p>
<dl><dd><ul><li>templatePath, the path to the template folder and</li>
<li>templateName, the name of the template to be inserted.</li></ul></dd></dl>
<p>(MyTemplate.svg is the name for the generated template in a following section. Change it to test the macro with your favourite template.)
</p><p>(This has still to be done manually before running the macro as long as I'm not sure where to read the path variable ...)
</p><p>An object to address the active document is introduced and named activeDoc.
</p><p>And finally two variables are filled with the names of the generated page and template. (I prefer 2 digits for the numbers in contrast to FreeCAD)
</p><p><br/>
</p>
<h3><span class="mw-headline" id="Insert_just_one_page_and_template">Insert just one page and template</span></h3>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Code to add a page and insert a template
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#- set the template path to the directory where your templates are stored</span>
<span class="n">templatePath</span> <span class="o">=</span> <span class="s2">"/Users/.../FreeCAD/Templates/"</span>
<span class="n">templateName</span> <span class="o">=</span> <span class="s2">"MyTemplate.svg"</span>

<span class="c1"># --- Main section ---</span>

<span class="c1"># -- Add a page and a template to the active document --</span>

<span class="n">activeDoc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>

<span class="n">newPage</span> <span class="o">=</span> <span class="s1">'Page01'</span>
<span class="n">newTemplate</span> <span class="o">=</span> <span class="s1">'Template01'</span>

<span class="c1"># add a page object to the active document</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawPage'</span><span class="p">,</span><span class="n">newPage</span><span class="p">)</span>

<span class="c1"># add a template object to the active document</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawSVGTemplate'</span><span class="p">,</span><span class="n">newTemplate</span><span class="p">)</span>

<span class="c1"># load the svg template into the template object</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span>

<span class="c1"># add the template object to the page's object list</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span>

<span class="c1"># rename 'Page' to 'Sheet'</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="s1">'Sheet '</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># open the page object for editing</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">ViewObject</span><span class="o">.</span><span class="n">doubleClicked</span><span class="p">()</span>
</pre></div>
<dl><dd><ul><li>A page object and a template object are added to the active document's object list.</li>
<li>The content of the svg document is loaded into the template object.</li>
<li>The template object is put onto the page's objects list.</li>
<li>Drawings are on sheets rather than on pages and so they are renamed.</li></ul></dd>
<dd>Since the property "Name" cannot be changed the property "Label" must be altered.
<ul><li>Finally the drawing view is opened and activated for editing.</li></ul></dd></dl>
</div>
</div>
<p><br/>
</p>
<h3><span class="mw-headline" id="Insert_more_than_just_one_page_and_template">Insert more than just one page and template</span></h3>
<p>The above code works for single pages only. It needs some extra lines to detect existing pages and to increment the page number.
</p><p>The macro tries to read the property label of Page01 to detect if page01 exists. If it doesn't it will be created.
</p><p>If it exists the page number will be incremented and the next try to detect a page starts.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Code to check for existing pages to add a first page or yet another
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#- set the template path to the directory where your templates are stored</span>
<span class="n">templatePath</span> <span class="o">=</span> <span class="s2">"/Users/.../FreeCAD/Templates/"</span>
<span class="n">templateName</span> <span class="o">=</span> <span class="s2">"MyTemplate.svg"</span>

<span class="c1"># --- Main section ---</span>

<span class="c1"># -- Add a page and a template to the active document --</span>

<span class="n">activeDoc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>

<span class="n">newPage</span> <span class="o">=</span> <span class="s1">'Page01'</span> <span class="c1"># first page name to start search</span>

<span class="c1"># to find the current page number to create</span>
<span class="n">pageCount</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pageFound</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">while</span> <span class="n">pageFound</span><span class="p">:</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span><span class="p">)</span>
	<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="n">newPage</span> <span class="o">+</span> <span class="s2">" to be created"</span><span class="p">)</span>
		<span class="n">pageFound</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">pageCount</span> <span class="o">=</span> <span class="n">pageCount</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="n">pageCount</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
			<span class="n">newPage</span> <span class="o">=</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'0'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">newPage</span> <span class="o">=</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span>

<span class="c1"># set template number according to page number</span>
<span class="n">newTemplate</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Template'</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>

<span class="c1"># add a page object to the active document</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawPage'</span><span class="p">,</span><span class="n">newPage</span><span class="p">)</span>

<span class="c1"># add a template object to the active document</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawSVGTemplate'</span><span class="p">,</span><span class="n">newTemplate</span><span class="p">)</span>

<span class="c1"># load the svg template into the template object</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span>

<span class="c1"># add the template object to the page's object list</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span>

<span class="c1"># rename 'Page' to 'Sheet'</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="s1">'Sheet '</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># open the page object for editing</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">ViewObject</span><span class="o">.</span><span class="n">doubleClicked</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>I recommend to save the file after each added page.
</p><p><br/>
</p>
<h2><span class="mw-headline" id="Generate_a_template">Generate a template</span></h2>
<p>A template provides a background for the drawing tasks. The template's dimensions are used by the printer drivers to scale the drawing correctly.
</p><p>The templates are svg-files  and so the macro has to write lines of svg code (which is a subset of xml code).
</p><p><br/>
</p>
<h3><span class="mw-headline" id="Generate_a_simple_blank_page_template">Generate a simple blank page template</span></h3>
<p>This macro shows the principle how an svg-file can be put together. (Format is A3)
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Code to create a simple svg-file
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#- set the template path to the directory where your templates are stored</span>
<span class="n">templatePath</span> <span class="o">=</span> <span class="s2">"/Users/.../FreeCAD/Templates/"</span>
<span class="n">templateName</span> <span class="o">=</span> <span class="s2">"MyTemplate.svg"</span>

<span class="c1"># - SVG creation -</span>

<span class="c1">#- Create a file and insert a header line</span>
<span class="c1">#   (with t as the space saving variant of template)</span>
<span class="k">def</span> <span class="nf">CreateSvgFile</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"w"</span><span class="p">)</span> <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Create opening svg-tag</span>
<span class="c1">#   Namespace section</span>
<span class="k">def</span> <span class="nf">StartSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span> <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecadweb.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
<span class="c1">#   Sheet size section</span>
<span class="k">def</span> <span class="nf">CreateSheet</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">shWidth</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">shHeight</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span><span class="o">+</span><span class="n">shWidth</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">shHeight</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height will synchronise mm and svg-units</span>

<span class="c1">#- Create closing svg-tag</span>
<span class="k">def</span> <span class="nf">EndSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1"># --- Main section ---</span>

<span class="n">CreateSvgFile</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span> <span class="c1"># overwrites existing File</span>

<span class="c1"># Set sheet format (DIN A3)</span>
<span class="n">formatWidth</span>  <span class="o">=</span> <span class="s2">"420"</span>
<span class="n">formatHeight</span> <span class="o">=</span> <span class="s2">"297"</span>

<span class="n">StartSvg</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span>  <span class="c1"># adds Start tag and namespaces</span>
<span class="n">CreateSheet</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">EndSvg</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span>
<span class="c1"># At this point a new SVG-file is generated and saved</span>
</pre></div>
<dl><dd>The result, a simple template for a blank page (A3 landscape):</dd></dl>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>

<span class="nt">&lt;svg</span>
  <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span> <span class="na">version=</span><span class="s">"1.1"</span>
  <span class="na">xmlns:freecad=</span><span class="s">"http://www.freecadweb.org/wiki/index.php?title=Svg_Namespace"</span>
  <span class="na">width =</span><span class="s">"420mm"</span>
  <span class="na">height=</span><span class="s">"297mm"</span>
  <span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<dl><dd>The main principle is to open a file for writing and so start an svg-file from scratch, write the header line and close the file as a first step.</dd>
<dd>After that the file will be repeatedly opened to append further segments and closed again after appending.</dd>
<dd>(The FreeCAD namespace is an investment into the future when editable texts come into play)</dd></dl>
</div>
</div>
<p><br/>
Now some ink will be added to the blank page:
</p>
<h3><span class="mw-headline" id="Add_code_segments_to...">Add code segments to...</span></h3>
<p>The following code segments are to be added to the above code. They should placed between the svg-tags.
</p><p>They are usually split in a part to collect data for parameter values and one part to create the Python code lines with given parameters.
</p><p>All functions dealing with <b>formatWidth</b> and <b>formatHeight</b> can create svg-code to match each DIN format from A4 to A0.
</p>
<h4><span class="mw-headline" id="..._create_frames">... create frames</span></h4>
<p>Code segments (to create the svg-instructions) to draw two rectangles, one for a sheet frame and one around the drawing area.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Additional code to create frames
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># - SVG creation -</span>
<span class="k">class</span> <span class="nc">ToteBag</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1"># This class is empty to act as a container for several variables</span>
<span class="c1">#- one bag for drawing borders</span>
<span class="n">borders</span> <span class="o">=</span> <span class="n">ToteBag</span><span class="p">()</span>

<span class="c1">#- set default values - custom values may be added </span>
<span class="k">def</span> <span class="nf">setDINBorderValues</span><span class="p">(</span><span class="nb">format</span><span class="p">):</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>    <span class="o">=</span> <span class="mi">10</span> <span class="c1"># distance from page boundary</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>   <span class="o">=</span> <span class="mi">20</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>  <span class="o">=</span> <span class="mi">10</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>     <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># distance from drawing area border</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>  <span class="o">=</span> <span class="mi">5</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>    <span class="o">=</span> <span class="mi">5</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>   <span class="o">=</span> <span class="mi">5</span>

<span class="c1">#- Function to generate an svg-instruction to draw a rectangle with the given values</span>
<span class="k">def</span> <span class="nf">svgrect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">width</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Frame creation</span>
<span class="k">def</span> <span class="nf">CreateFrame</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>

    <span class="c1"># inner Frame, drawing area</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># outer frame</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFL</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFT</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1"># --- Main section ---</span>

<span class="c1">#borders = ToteBag()</span>
<span class="n">setDINBorderValues</span><span class="p">(</span><span class="s1">'A3'</span><span class="p">)</span>

<span class="n">CreateFrame</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
</pre></div>
<dl><dd>Each write instruction has to start with a specific number of blank spaces for the correct indentation of the resulting svg-file.</dd>
<dd>The toteBag class is used to collect and distribute global values. I'm not sure yet if this really makes sense...</dd></dl>
</div>
</div>
<p><br/>
</p>
<h4><span class="mw-headline" id="..._to_add_index_fields">... to add index fields</span></h4>
<p>Code segments to calculate a few parameters based on sheet dimensions and then create code to place the separator lines, index letters and numbers and a few lines to help folding this drawing and placing a puncher.
Additional functions to create several path and text instructions for the svg-file.
</p><p><br/>
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Additional code to create index fields
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># SVG creation</span>

<span class="c1">#- Function to generate an svg-instruction to draw a path element (line) with the given values</span>
<span class="k">def</span> <span class="nf">svgpath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" l "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place a text element with the given values</span>
<span class="k">def</span> <span class="nf">svgtext</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Indexes and folding marks creation</span>
<span class="k">def</span> <span class="nf">CreateDecoration</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">index-separators</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>

    <span class="c1">#- starting point values of center lines</span>
    <span class="n">indexCenter</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexMiddle</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1">#- centre and middle markings of drawing area</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"210"</span><span class="p">:</span> <span class="c1"># format=="DIN-A4":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-15"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-20"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- starting point values of separator lines</span>
    <span class="n">indexLeft</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>

    <span class="c1">#- set number of horizontal and vertical indexes</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">6</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># format=="DIN-A2":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">12</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">8</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># format=="DIN-A1":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">16</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">12</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># format=="DIN-A0":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">24</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">16</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1">#- indexCenter and indexMiddle contain strings but floating point</span>
    <span class="c1">#   numbers are needed to calculate</span>
    <span class="n">floatCenter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span>
    <span class="n">floatMiddle</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span>

    <span class="c1">#- horizontal index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">    font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- position point values of indexes</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">+</span><span class="n">sFR</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">+</span><span class="n">sFB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#- horizontal indexes, numbers</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical indexes, letters</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">9</span> <span class="p">:</span>  <span class="c1"># to avoid the letter J</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- puncher mark</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">puncher mark</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shWidth</span> <span class="ow">in</span><span class="p">[</span><span class="s2">"1189"</span><span class="p">,</span> <span class="s2">"841"</span><span class="p">,</span> <span class="s2">"594"</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># A3 and A4 have extended middle markings</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">297</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- folding marks</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">folding marks</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># DIN-A3</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># DIN-A2</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># DIN-A1</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># DIN-A0</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1"># --- Main section ---</span>

<span class="n">CreateDecoration</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
</pre></div>
<dl><dd>Comment.</dd>
<dd>More comments.</dd></dl>
</div>
</div>
<h4><span class="mw-headline" id="..._create_title_block_elements">... create title block elements</span></h4>
<p>Code segments (to create the svg-instructions) to draw 
</p>
<dl><dd><ul><li>a title block outline</li>
<li>the inner segmentation</li>
<li>static texts like e.g.labels for the text boxes</li>
<li>editable texts, at least their placeholders</li></ul></dd></dl>
<p>The first two points can be combined if only one line type and a single thickness is use.
</p><p>All except the editable texts can be drawn in relation to the svg-file's origin as the base point of the title block and then be grouped to move them to the desired position in a single step.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Additional code to create a title block
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">#- Title block movable</span>
<span class="k">def</span> <span class="nf">CreateTitleBlock</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- lower left corner</span>
    <span class="n">tbX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- group to move allelements in one step</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span><span class="o">+</span><span class="n">tbX</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">tbY</span><span class="o">+</span><span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- title block</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-16"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-46.5"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 50"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 25"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-26"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 50"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-59"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"140"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-12"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"160"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">" -7"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-14"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-21"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-28"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-35"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-42"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-49"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-56"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- small texts, left-aligned</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-60  "</span><span class="p">,</span><span class="s2">"Author Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-52  "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Supervisor Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-35.5 "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Format:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Scale:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 26.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Weight:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Company:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Version:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"141.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Sheet"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- revision indexes, centered</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-revision-indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -1.5  "</span><span class="p">,</span><span class="s2">"A"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -8.5  "</span><span class="p">,</span><span class="s2">"B"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-15.5  "</span><span class="p">,</span><span class="s2">"C"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-22.5  "</span><span class="p">,</span><span class="s2">"D"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-29.5  "</span><span class="p">,</span><span class="s2">"E"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-36.5  "</span><span class="p">,</span><span class="s2">"F"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-43.5  "</span><span class="p">,</span><span class="s2">"G"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-50.5  "</span><span class="p">,</span><span class="s2">"H"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-57.5  "</span><span class="p">,</span><span class="s2">"I"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>


<span class="c1"># --- Main section ---</span>

<span class="n">CreateTitleBlock</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
</pre></div>
<p>Now there will be a supergroup "title block" containing the groups "titleblock-frame", "titleblock-text-non-editable", and"titleblock-revision-indexes" in the resulting svg-file.
</p>
</div>
</div>
<p>The editable texts are put into a separate group as they require absolute coordinates
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Additional code to create a editable texts
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">#- Function to generate an svg-instruction to place an editable text element with the given values</span>
<span class="k">def</span> <span class="nf">FCeditext</span><span class="p">(</span><span class="n">entryName</span><span class="p">,</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">entryName</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span> \
    <span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Title block editable texts</span>
<span class="k">def</span> <span class="nf">CreateEditableText</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- offsets for editable texts</span>
    <span class="n">edX</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span>

    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-owner</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Owner"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">27.0</span><span class="p">),</span><span class="s2">"Owner"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-address</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">23.5</span><span class="p">),</span><span class="s2">"Address1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">20.0</span><span class="p">),</span><span class="s2">"Address2"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"MailTo"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">16.5</span><span class="p">),</span><span class="s2">"MailTo"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Copyright"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="s2">"Copyright"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-medium</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Author"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">55.0</span><span class="p">),</span><span class="s2">"Author"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"AuDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">47.5</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Supervisor"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">38.5</span><span class="p">),</span><span class="s2">"Supervisor"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SvDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">31.0</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SubTitle"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">42.0</span><span class="p">),</span><span class="s2">"Sub-title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Version"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.0</span><span class="p">),</span> <span class="s2">"Version"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-A"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-B"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-C"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">15.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-D"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">22.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-E"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">29.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-F"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">36.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-G"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">43.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-H"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">50.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-I"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">57.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-centered</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:middle;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Format"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">21</span><span class="p">),</span><span class="s2">"A3"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Sheets"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">148</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1 / 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Scale"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1Â : 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">35</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"___ kg"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-Large</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Title"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">50</span><span class="p">),</span><span class="s2">"Drawing Title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"PtNumber"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">32</span><span class="p">),</span><span class="s2">"Part Number"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1"># --- Main section ---</span>

<span class="n">CreateEditableText</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<h3><span class="mw-headline" id="The_resulting_macro">The resulting macro</span></h3>
<p>All sections put together give a macro like this:
</p>
<dl><dd>(Don't forget to edit the template path and start the macro from within FreeCAD.)</dd></dl>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Complete code to create a template 
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#- set the template path to the directory where your templates are stored</span>
<span class="n">templatePath</span> <span class="o">=</span> <span class="s2">"/Users/.../FreeCAD/Templates/"</span>
<span class="n">templateName</span> <span class="o">=</span> <span class="s2">"MyTemplate.svg"</span>

<span class="c1"># - SVG creation -</span>

<span class="k">class</span> <span class="nc">ToteBag</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1"># This class is empty to act as a container for several variables</span>
<span class="c1">#- one bag for drawing borders</span>
<span class="n">borders</span> <span class="o">=</span> <span class="n">ToteBag</span><span class="p">()</span>

<span class="c1">#- set values according to DIN XXX</span>
<span class="k">def</span> <span class="nf">setDINBorderValues</span><span class="p">(</span><span class="nb">format</span><span class="p">):</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>    <span class="o">=</span> <span class="mi">10</span> <span class="c1"># distance from page boundary</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>   <span class="o">=</span> <span class="mi">20</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>  <span class="o">=</span> <span class="mi">10</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>     <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># distance from drawing area border</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>  <span class="o">=</span> <span class="mi">5</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>    <span class="o">=</span> <span class="mi">5</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>   <span class="o">=</span> <span class="mi">5</span>

<span class="c1">#- Function to generate an svg-instruction to draw a rectangle with the given values</span>
<span class="k">def</span> <span class="nf">svgrect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">width</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to draw a path element (line) with the given values</span>
<span class="k">def</span> <span class="nf">svgpath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" l "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place a text element with the given values</span>
<span class="k">def</span> <span class="nf">svgtext</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place an editable text element with the given values</span>
<span class="k">def</span> <span class="nf">FCeditext</span><span class="p">(</span><span class="n">entryName</span><span class="p">,</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">entryName</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span> \
    <span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Create a file and insert a header line</span>
<span class="k">def</span> <span class="nf">CreateSvgFile</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"w"</span><span class="p">)</span> <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Create opening svg-tag</span>
<span class="c1">#   Namespace section</span>
<span class="k">def</span> <span class="nf">StartSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span> <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecadweb.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
<span class="c1">#   Sheet size section</span>
<span class="k">def</span> <span class="nf">CreateSheet</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">shWidth</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">shHeight</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span><span class="o">+</span><span class="n">shWidth</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">shHeight</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height will synchronise mm and svg-units</span>

<span class="c1">#- Create closing svg-tag</span>
<span class="k">def</span> <span class="nf">EndSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Frame creation</span>
<span class="k">def</span> <span class="nf">CreateFrame</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>
    <span class="c1"># inner Frame, drawing area</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># outer frame</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFL</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFT</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Indexes and folding marks creation</span>
<span class="k">def</span> <span class="nf">CreateDecoration</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">index-separators</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>

    <span class="c1">#- starting point values of center lines</span>
    <span class="n">indexCenter</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexMiddle</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1">#- centre and middle markings of drawing area</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"210"</span><span class="p">:</span> <span class="c1"># format=="DIN-A4":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-15"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-20"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- starting point values of separator lines</span>
    <span class="n">indexLeft</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>

    <span class="c1">#- set number of horizontal and vertical indexes</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">6</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># format=="DIN-A2":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">12</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">8</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># format=="DIN-A1":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">16</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">12</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># format=="DIN-A0":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">24</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">16</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1">#- indexCenter and indexMiddle contain strings but floating point</span>
    <span class="c1">#   numbers are needed to calculate</span>
    <span class="n">floatCenter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span>
    <span class="n">floatMiddle</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span>

    <span class="c1">#- horizontal index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">    font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- position point values of indexes</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">+</span><span class="n">sFR</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">+</span><span class="n">sFB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#- horizontal indexes, numbers</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical indexes, letters</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">9</span> <span class="p">:</span>  <span class="c1"># to avoid the letter J</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- puncher mark</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">puncher mark</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shWidth</span> <span class="ow">in</span><span class="p">[</span><span class="s2">"1189"</span><span class="p">,</span> <span class="s2">"841"</span><span class="p">,</span> <span class="s2">"594"</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># A3 and A4 have extended middle markings</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">297</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- folding marks</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">folding marks</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># DIN-A3</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># DIN-A2</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># DIN-A1</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># DIN-A0</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Title block movable</span>
<span class="k">def</span> <span class="nf">CreateTitleBlock</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- lower left corner</span>
    <span class="n">tbX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- group to move allelements in one step</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span><span class="o">+</span><span class="n">tbX</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">tbY</span><span class="o">+</span><span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- title block</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-16"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-46.5"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 50"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 25"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-26"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 50"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-59"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"140"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-12"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"160"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">" -7"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-14"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-21"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-28"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-35"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-42"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-49"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-56"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- small texts, left-aligned</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-60  "</span><span class="p">,</span><span class="s2">"Author Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-52  "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Supervisor Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-35.5 "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Format:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Scale:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 26.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Weight:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Owner:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Version:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"141.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Sheet"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- revision indexes, centered</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-revision-indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -1.5  "</span><span class="p">,</span><span class="s2">"A"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -8.5  "</span><span class="p">,</span><span class="s2">"B"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-15.5  "</span><span class="p">,</span><span class="s2">"C"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-22.5  "</span><span class="p">,</span><span class="s2">"D"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-29.5  "</span><span class="p">,</span><span class="s2">"E"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-36.5  "</span><span class="p">,</span><span class="s2">"F"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-43.5  "</span><span class="p">,</span><span class="s2">"G"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-50.5  "</span><span class="p">,</span><span class="s2">"H"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-57.5  "</span><span class="p">,</span><span class="s2">"I"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Title block editable texts</span>
<span class="k">def</span> <span class="nf">CreateEditableText</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- offsets for editable texts</span>
    <span class="n">edX</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span>

    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-owner</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Owner"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">27.0</span><span class="p">),</span><span class="s2">"Owner"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-address</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">23.5</span><span class="p">),</span><span class="s2">"Address1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">20.0</span><span class="p">),</span><span class="s2">"Address2"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"MailTo"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">16.5</span><span class="p">),</span><span class="s2">"MailTo"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Copyright"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="s2">"Copyright"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-medium</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Author"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">55.0</span><span class="p">),</span><span class="s2">"Author"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"AuDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">47.5</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Supervisor"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">38.5</span><span class="p">),</span><span class="s2">"Supervisor"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SvDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">31.0</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SubTitle"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">42.0</span><span class="p">),</span><span class="s2">"Sub-title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Version"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.0</span><span class="p">),</span> <span class="s2">"Version"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-A"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-B"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-C"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">15.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-D"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">22.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-E"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">29.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-F"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">36.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-G"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">43.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-H"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">50.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-I"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">57.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-centered</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:middle;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Format"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">21</span><span class="p">),</span><span class="s2">"A3"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Sheets"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">148</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1 / 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Scale"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1Â : 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">35</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"___ kg"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-Large</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Title"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">50</span><span class="p">),</span><span class="s2">"Drawing Title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"PtNumber"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">32</span><span class="p">),</span><span class="s2">"Part Number"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1"># --- Main section ---</span>

<span class="n">CreateSvgFile</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span> <span class="c1"># overwrites existing File</span>

<span class="c1"># Set sheet format (DIN A3)</span>
<span class="n">formatWidth</span>  <span class="o">=</span> <span class="s2">"420"</span>
<span class="n">formatHeight</span> <span class="o">=</span> <span class="s2">"297"</span>

<span class="c1">#borders = ToteBag()</span>
<span class="n">setDINBorderValues</span><span class="p">(</span><span class="s1">'DIN'</span><span class="p">)</span>

<span class="n">StartSvg</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span>  <span class="c1"># adds Start tag and namespaces</span>
<span class="n">CreateSheet</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateFrame</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateDecoration</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateTitleBlock</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateEditableText</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">EndSvg</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span>
<span class="c1"># At this point a new SVG-file is generated and saved</span>
</pre></div>
</div>
</div>
<p>The tote bag concept could be used to shorten function calls as the needed parameters could be distributed by global classes...
</p><p><br/>
And this is the resulting Page:
</p><p><span typeof="mw:File"><a class="mw-file-description" href="File/TechDraw_TemplateHelper_A3.png" title="TechDraw page A3"><img alt="TechDraw page A3" decoding="async" height="295" src="File/TechDraw_TemplateHelper_A3.png" width="400"/></a></span>
</p>
<h2><span class="mw-headline" id="Set_up_a_user_interface">Set up a user interface</span></h2>
<p>A single format template generator is a bit lame and so a way to choose a format is needed.
</p><p>As a user interface a pop-up window with a list to choose from would be nice, but let's start simple:
</p>
<h3><span class="mw-headline" id="A_simple_user_interface_window">A simple user interface window</span></h3>
<p>There are some changes in coming versions of Python or Qt and so some principles described in the FreeCAD wiki will not be supported anymore.
</p><p>If FreeCAD has Python 3.4 or later pre-installed then deprecation warnings are shown in the console window to remind us that some code should be modified to still work in the future.
</p><p>This is my try to code future-proof.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>This opens a window on the screen - no more, no less
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QDialog</span>

<span class="k">class</span> <span class="nc">InputWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for InputWindow.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InputWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">InputWindow</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
<p>The action will take place within the initUI function in further steps. And the main part is a function itself to get a bit more object oriented...
</p>
</div>
</div>
<p><br/>
</p>
<h3><span class="mw-headline" id="A_user_interface_window_with_buttons">A user interface window with buttons</span></h3>
<p>Like the one above plus OK and cancel buttons and adjusted window dimensions.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>This opens a window on the screen which can be closed with an OK or a cancel button.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QPushButton</span>

<span class="k">class</span> <span class="nc">InputWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for InputWindow.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InputWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span> <span class="c1"># Default return status</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- allways larger</span>
        <span class="c1"># self.setMinimumWidth(700)</span>
        <span class="c1"># self.setMinimumHeight(800)</span>
        <span class="c1">#- allways smaller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">())</span> <span class="c1"># just to check dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">'Input window'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># cancel button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'Cancel'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onCancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># no AutoDefault with okButton!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="c1"># OK button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'OK'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">onCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">onOk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"OK"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">InputWindow</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Each button launches a function setting a result value and closing the window.
</p>
<dl><dd>Two print instructions to check if it does what it should...</dd></dl>
</div>
</div>
<p><br/>
</p>
<h3><span class="mw-headline" id="A_user_interface_window_with_combo-box">A user interface window with combo-box</span></h3>
<p>Like the one above plus a label and a combo-box to select a sheet format.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>This opens a window on the screen which can used to select a sheet format.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QComboBox</span>

<span class="k">class</span> <span class="nc">InputWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for InputWindow.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InputWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span> <span class="c1"># Default return status</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">'Input window'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>
        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelFormat</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">"Set drawing format: "</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelFormat</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">'osifont'</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelFormat</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="c1"># set up lists for pop-ups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"ISO A0"</span><span class="p">,</span><span class="s2">"ISO A1"</span><span class="p">,</span><span class="s2">"ISO A2"</span><span class="p">,</span><span class="s2">"ISO A3"</span><span class="p">,</span><span class="s2">"ISO A4"</span><span class="p">,</span>\
<span class="s2">"ANSI A"</span><span class="p">,</span><span class="s2">"ANSI B"</span><span class="p">,</span><span class="s2">"ANSI C"</span><span class="p">,</span><span class="s2">"ANSI D"</span><span class="p">,</span><span class="s2">"ANSI E"</span><span class="p">,</span>\
<span class="s2">"Arch A"</span><span class="p">,</span><span class="s2">"Arch B"</span><span class="p">,</span><span class="s2">"Arch C"</span><span class="p">,</span><span class="s2">"Arch D"</span><span class="p">,</span><span class="s2">"Arch E"</span><span class="p">,</span><span class="s2">"Arch E1"</span><span class="p">)</span>
        <span class="c1"># create some result containers and set default values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResultFormat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">"ISO A4"</span><span class="p">)</span> <span class="c1">#"ISO A4"</span>
        <span class="c1"># create some input elements</span>
        <span class="c1">#- set up pop-up menu - ComboBox - Format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">"ISO A4"</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopupFormat</span><span class="p">)</span>

        <span class="c1">#- cancel button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'Cancel'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onCancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># no AutoDefault with okButton!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="c1">#- OK button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'OK'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">onPopupFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selectedText</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResultFormat</span> <span class="o">=</span> <span class="n">selectedText</span>

    <span class="k">def</span> <span class="nf">onCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">onOk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"OK"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">InputWindow</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="s2">"Cancelled"</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">ResultFormat</span><span class="p">)</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
<p>The combo-box is setting another result value without closing the window.
</p>
<dl><dd>Two print instructions to check if it does what it should...</dd></dl>
</div>
</div>
<p><br/>
</p>
<h2><span class="mw-headline" id="Manipulate_editable_texts">Manipulate editable texts</span></h2>
<p>Whenever a new page is generated and inserted, default values are used for the editable texts. 
</p><p>To change the values we use the green handlers and change them one by one. That is acceptable for one page, but quickly becomes annoying if the file contains several pages (sheets) and it would be fine to change entries, that are identical on all pages, in one step.
</p><p>What do we need beforehand:
</p>
<dl><dd><ul><li>a FreeCAD file containing one or more pages that are named/labeled in a compatible way</li>
<li>editable text objects for each page which must be named/labeled identical on all pages</li></ul></dd></dl>
<p>Steps to achieve the goal:
</p>
<dl><dd><ol><li>scan the active document for drawing pages</li>
<li>read the values of the first page as default values</li>
<li>use a user interface to check and change the values</li>
<li>distribute the values to all pages</li></ol></dd></dl>
<p><br/>
</p>
<h3><span class="mw-headline" id="Look_for_existing_Pages">Look for existing Pages</span></h3>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Code to search and count pages in the active document 
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">existingPages</span><span class="p">():</span>
    <span class="c1"># this counts existing pages in the active document</span>
    <span class="n">NrOfPages</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">Entry</span> <span class="ow">in</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Entry</span><span class="o">.</span><span class="n">Name</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Page"</span><span class="p">:</span>
            <span class="n">NrOfPages</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">NrOfPages</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">):</span>
    <span class="c1"># this handles the editable texts</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Number of Pages:"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>

<span class="c1"># decide to run the main part or quit</span>
<span class="n">HowMany</span> <span class="o">=</span> <span class="n">existingPages</span><span class="p">()</span>

<span class="k">if</span> <span class="n">HowMany</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">HowMany</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Nothing to do - No page found"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><br/>
</p>
<h3><span class="mw-headline" id="Read_and_write_editable_texts">Read and write editable texts</span></h3>
<p>Now that we can be sure that there are pages in the active document it is time to read and write some editable texts.
</p><p>All entries for part number, title, and subtitle should be identical on all pages within a document. to achieve this the values are read from the first page and distributed to the following page. (In preparation for the next step the values are written to the first page as well)
</p><p><br/>
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>The above code extended to read entries from the first pages and copy them to the following pages 
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">existingPages</span><span class="p">():</span>
    <span class="c1"># this counts existing pages in the active document</span>
    <span class="n">NrOfPages</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">Entry</span> <span class="ow">in</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Entry</span><span class="o">.</span><span class="n">Name</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Page"</span><span class="p">:</span>
            <span class="n">NrOfPages</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">NrOfPages</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">):</span>
    <span class="c1"># this handles the editable texts</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Number of Pages:"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>
    <span class="n">ActiveDoc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span>
    <span class="c1">#- read first page's editable texts (dictionary)</span>
    <span class="n">EdTexts</span>   <span class="o">=</span> <span class="n">ActiveDoc</span><span class="o">.</span><span class="n">Page01</span><span class="o">.</span><span class="n">Template</span><span class="o">.</span><span class="n">EditableTexts</span>

    <span class="c1">#- set start PageName</span>
    <span class="c1">#- Fill in the editale texts on each page</span>
    <span class="k">while</span> <span class="n">NrOfPages</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">NrOfPages</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="c1"># insert leading zero</span>
            <span class="n">PageName</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Page"</span><span class="o">+</span> <span class="s2">"0"</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">PageName</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Page"</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>

        <span class="c1">#- read current page's editable texts (dictionary)</span>
        <span class="n">EdiTexts</span> <span class="o">=</span> <span class="n">ActiveDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">PageName</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span><span class="o">.</span><span class="n">EditableTexts</span>
        <span class="c1">#- replace current page's values with first page's values</span>
        <span class="n">EdiTexts</span><span class="p">[</span><span class="s2">"PtNumber"</span><span class="p">]</span> <span class="o">=</span> <span class="n">EdTexts</span><span class="p">[</span><span class="s2">"PtNumber"</span><span class="p">]</span>
        <span class="n">EdiTexts</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">]</span>    <span class="o">=</span> <span class="n">EdTexts</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">]</span>
        <span class="n">EdiTexts</span><span class="p">[</span><span class="s2">"SubTitle"</span><span class="p">]</span> <span class="o">=</span> <span class="n">EdTexts</span><span class="p">[</span><span class="s2">"SubTitle"</span><span class="p">]</span>
        <span class="c1">#- update current page's editable texts</span>
        <span class="n">ActiveDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">PageName</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span><span class="o">.</span><span class="n">EditableTexts</span> <span class="o">=</span> <span class="n">EdiTexts</span>
        <span class="n">NrOfPages</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="c1"># --- Launch area ---</span>
<span class="c1"># decide to run the main part or quit</span>
<span class="n">HowMany</span> <span class="o">=</span> <span class="n">existingPages</span><span class="p">()</span>
<span class="k">if</span> <span class="n">HowMany</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">HowMany</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Nothing to do - No page found"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><br/>
</p>
<h3><span class="mw-headline" id="Add_a_user_interface">Add a user interface</span></h3>
<p>Between reading and writing there should be the opportunity to check and modify the values.
</p><p>We create a gui window and use the first page's entries as default values. The entry fields offer some choices to select from (right mouse button) or the entries can be overwritten.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>The above code extended to create a user interface and to handle input data 
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># import statements</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QComboBox</span><span class="p">,</span>
                                <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QAction</span><span class="p">)</span>

<span class="c1"># UI Class definition</span>
<span class="k">class</span> <span class="nc">TitleBlockEntries</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for InputWindow.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TitleBlockEntries</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">InputDocument</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span>
        <span class="n">EdiTexts</span>      <span class="o">=</span> <span class="n">InputDocument</span><span class="o">.</span><span class="n">Page01</span><span class="o">.</span><span class="n">Template</span><span class="o">.</span><span class="n">EditableTexts</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span> <span class="c1"># Default return status</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- setting window dimensions this way keeps the window centered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">"Title-block entries"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>
        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">"Part number: "</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">'osifont'</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">"Title: "</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">'osifont'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">"Sub-title: "</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">'osifont'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelPartNr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="c1"># create some input elements</span>
        <span class="c1">#- set up text input field - Part Number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">EdiTexts</span><span class="p">[</span><span class="s2">"PtNumber"</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="c1"># set contextual menu options for text editing widget</span>
        <span class="c1">#- set text field to some preformatted string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberAction1</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberAction1</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"load new project dummy"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberAction1</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopMenuAction1</span><span class="p">)</span>
        <span class="c1"># remove all text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberAction2</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberAction2</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"clear"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberAction2</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopMenuAction2</span><span class="p">)</span>
        <span class="c1">#- define RMB-menu and add options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ActionsContextMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NumberAction1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NumberAction2</span><span class="p">)</span>

        <span class="c1">#- set up text input field - Title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">EdiTexts</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">190</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="c1"># set contextual menu options for text editing widget</span>
        <span class="c1">#- set text field to some preformatted string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitleAction3</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitleAction3</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"load title dummy"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitleAction3</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopMenuAction3</span><span class="p">)</span>
        <span class="c1">#- remove all text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitleAction4</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitleAction4</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"clear"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitleAction4</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopMenuAction4</span><span class="p">)</span>
        <span class="c1"># define RMB-menu and add options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ActionsContextMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TitleAction3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TitleAction4</span><span class="p">)</span>

        <span class="c1"># set up text input field - SubTitle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSubTitle</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSubTitle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">EdiTexts</span><span class="p">[</span><span class="s2">"SubTitle"</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSubTitle</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">160</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSubTitle</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="c1"># set contextual menu options for text editing widget</span>
        <span class="c1"># nothing but devider</span>
        <span class="c1"># menu dividers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SubTitleDivider</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SubTitleDivider</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">'---------'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SubTitleDivider</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopMenuDivider</span><span class="p">)</span>
        <span class="c1"># define RMB-menu and add options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSubTitle</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ActionsContextMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSubTitle</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SubTitleDivider</span><span class="p">)</span>

        <span class="c1"># cancel button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'Cancel'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onCancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">280</span><span class="p">)</span>
        <span class="c1"># OK button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'OK'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">280</span><span class="p">)</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">onPopMenuAction1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># load some text into field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"F21-XX-001"</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">onPopMenuDivider</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># this option is the divider and is really there as a spacer on the menu list</span>
        <span class="c1"># consequently it has no functional code to execute if user selects it</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">onPopMenuAction2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># clear the text from the field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">onPopMenuAction3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># load some text into field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Enter name"</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">onPopMenuAction4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># load some text into field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">onOk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"OK"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">existingPages</span><span class="p">():</span>
    <span class="c1"># this counts existing pages in the active document</span>
    <span class="n">NrOfPages</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">Entry</span> <span class="ow">in</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Entry</span><span class="o">.</span><span class="n">Name</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Page"</span><span class="p">:</span>
            <span class="n">NrOfPages</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">NrOfPages</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">):</span>
    <span class="c1"># this handles the editable texts</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Number of Pages:"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>
    <span class="n">ActiveDoc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span>

    <span class="c1"># Launch input window</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">TitleBlockEntries</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="c1"># deal with the results</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="s2">"Cancelled"</span><span class="p">:</span>
        <span class="k">pass</span> <span class="c1"># steps to handle when selecting Cancel</span>

    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="s2">"OK"</span><span class="p">:</span>
        <span class="c1"># steps to handle when selecting OK</span>
        <span class="c1">#- Fill in the editable texts on each page</span>
        <span class="k">while</span> <span class="n">NrOfPages</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NrOfPages</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="c1"># insert leading zero</span>
                <span class="n">PageName</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Page"</span><span class="o">+</span> <span class="s2">"0"</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">PageName</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Page"</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NrOfPages</span><span class="p">))</span>
            <span class="c1">#- read current page's editable texts (dictionary)</span>
            <span class="n">EdTexts</span> <span class="o">=</span> <span class="n">ActiveDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">PageName</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span><span class="o">.</span><span class="n">EditableTexts</span>
            <span class="c1">#- replace values with gui results</span>
            <span class="n">EdTexts</span><span class="p">[</span><span class="s2">"PtNumber"</span><span class="p">]</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">inputPartNr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">EdTexts</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">]</span>    <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">inputTitle</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">EdTexts</span><span class="p">[</span><span class="s2">"SubTitle"</span><span class="p">]</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">inputSubTitle</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="c1"># print (EdiTexts) # use for debugging only</span>
            <span class="c1">#- update current page's editable texts</span>
            <span class="n">ActiveDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">PageName</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span><span class="o">.</span><span class="n">EditableTexts</span> <span class="o">=</span> <span class="n">EdTexts</span>
            <span class="n">NrOfPages</span> <span class="o">-=</span> <span class="mi">1</span>
        

<span class="c1"># --- Launch area ---</span>
<span class="c1"># decide to run the main part or quit</span>
<span class="n">HowMany</span> <span class="o">=</span> <span class="n">existingPages</span><span class="p">()</span>

<span class="k">if</span> <span class="n">HowMany</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">HowMany</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Nothing to do - No page found"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><br/>
More results:
</p>
<h2><span class="mw-headline" id="Combined_code">Combined code</span></h2>
<h3><span class="mw-headline" id="Generate_A3_template_and_insert_it">Generate A3 template and insert it</span></h3>
<p>Just copy this code and paste it into an empty *.py file, edit the template path, save and start the macro from within FreeCAD:
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Complete code to create an A3 template and insert it into the active document 
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#- set the template path to the directory where your templates are stored</span>
<span class="n">templatePath</span> <span class="o">=</span> <span class="s2">"/Users/.../FreeCAD/Templates/"</span>
<span class="n">templateName</span> <span class="o">=</span> <span class="s2">"MyTemplate.svg"</span>

<span class="c1"># - SVG creation -</span>

<span class="k">class</span> <span class="nc">ToteBag</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1"># This class is empty to act as a container for several variables</span>
<span class="c1">#- one bag for drawing borders</span>
<span class="n">borders</span> <span class="o">=</span> <span class="n">ToteBag</span><span class="p">()</span>

<span class="c1">#- set values according to DIN XXX</span>
<span class="k">def</span> <span class="nf">setDINBorderValues</span><span class="p">(</span><span class="nb">format</span><span class="p">):</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>    <span class="o">=</span> <span class="mi">10</span> <span class="c1"># distance from page boundary</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>   <span class="o">=</span> <span class="mi">20</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>  <span class="o">=</span> <span class="mi">10</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>     <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># distance from drawing area border</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>  <span class="o">=</span> <span class="mi">5</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>    <span class="o">=</span> <span class="mi">5</span>
    <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>   <span class="o">=</span> <span class="mi">5</span>

<span class="c1">#- Function to generate an svg-instruction to draw a rectangle with the given values</span>
<span class="k">def</span> <span class="nf">svgrect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">width</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to draw a path element (line) with the given values</span>
<span class="k">def</span> <span class="nf">svgpath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" l "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place a text element with the given values</span>
<span class="k">def</span> <span class="nf">svgtext</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place an editable text element with the given values</span>
<span class="k">def</span> <span class="nf">FCeditext</span><span class="p">(</span><span class="n">entryName</span><span class="p">,</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">entryName</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span> \
    <span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Create a file and insert a header line</span>
<span class="k">def</span> <span class="nf">CreateSvgFile</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"w"</span><span class="p">)</span> <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Create opening svg-tag</span>
<span class="c1">#   Namespace section</span>
<span class="k">def</span> <span class="nf">StartSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span> <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecadweb.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
<span class="c1">#   Sheet size section</span>
<span class="k">def</span> <span class="nf">CreateSheet</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">shWidth</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">shHeight</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span><span class="o">+</span><span class="n">shWidth</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">shHeight</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height will synchronise mm and svg-units</span>

<span class="c1">#- Create closing svg-tag</span>
<span class="k">def</span> <span class="nf">EndSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Frame creation</span>
<span class="k">def</span> <span class="nf">CreateFrame</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>
    <span class="c1"># inner Frame, drawing area</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># outer frame</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFL</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFT</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Indexes and folding marks creation</span>
<span class="k">def</span> <span class="nf">CreateDecoration</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">index-separators</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>

    <span class="c1">#- starting point values of center lines</span>
    <span class="n">indexCenter</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexMiddle</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1">#- centre and middle markings of drawing area</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"210"</span><span class="p">:</span> <span class="c1"># format=="DIN-A4":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-15"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-20"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- starting point values of separator lines</span>
    <span class="n">indexLeft</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>

    <span class="c1">#- set number of horizontal and vertical indexes</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">6</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># format=="DIN-A2":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">12</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">8</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># format=="DIN-A1":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">16</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">12</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># format=="DIN-A0":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">24</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">16</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1">#- indexCenter and indexMiddle contain strings but floating point</span>
    <span class="c1">#   numbers are needed to calculate</span>
    <span class="n">floatCenter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span>
    <span class="n">floatMiddle</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span>

    <span class="c1">#- horizontal index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">    font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- position point values of indexes</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">+</span><span class="n">sFR</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">+</span><span class="n">sFB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#- horizontal indexes, numbers</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical indexes, letters</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">9</span> <span class="p">:</span>  <span class="c1"># to avoid the letter J</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- puncher mark</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">puncher mark</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shWidth</span> <span class="ow">in</span><span class="p">[</span><span class="s2">"1189"</span><span class="p">,</span> <span class="s2">"841"</span><span class="p">,</span> <span class="s2">"594"</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># A3 and A4 have extended middle markings</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">297</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- folding marks</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">folding marks</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># DIN-A3</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># DIN-A2</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># DIN-A1</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># DIN-A0</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">formatWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Title block movable</span>
<span class="k">def</span> <span class="nf">CreateTitleBlock</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- lower left corner</span>
    <span class="n">tbX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- group to move allelements in one step</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span><span class="o">+</span><span class="n">tbX</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">tbY</span><span class="o">+</span><span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- title block</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-16"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-46.5"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 50"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 25"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-26"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 50"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-59"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"140"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-12"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"160"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">" -7"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-14"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-21"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-28"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-35"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-42"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-49"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-56"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- small texts, left-aligned</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-60  "</span><span class="p">,</span><span class="s2">"Author Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-52  "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Supervisor Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-35.5 "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Format:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Scale:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 26.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Weight:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Owner:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Version:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"141.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Sheet"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- revision indexes, centered</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-revision-indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -1.5  "</span><span class="p">,</span><span class="s2">"A"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -8.5  "</span><span class="p">,</span><span class="s2">"B"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-15.5  "</span><span class="p">,</span><span class="s2">"C"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-22.5  "</span><span class="p">,</span><span class="s2">"D"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-29.5  "</span><span class="p">,</span><span class="s2">"E"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-36.5  "</span><span class="p">,</span><span class="s2">"F"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-43.5  "</span><span class="p">,</span><span class="s2">"G"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-50.5  "</span><span class="p">,</span><span class="s2">"H"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-57.5  "</span><span class="p">,</span><span class="s2">"I"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Title block editable texts</span>
<span class="k">def</span> <span class="nf">CreateEditableText</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="n">shWidth</span><span class="p">,</span><span class="n">shHeight</span><span class="p">):</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- offsets for editable texts</span>
    <span class="n">edX</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span>

    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-owner</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Owner"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">27.0</span><span class="p">),</span><span class="s2">"Owner"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-address</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">23.5</span><span class="p">),</span><span class="s2">"Address1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">20.0</span><span class="p">),</span><span class="s2">"Address2"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"MailTo"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">16.5</span><span class="p">),</span><span class="s2">"MailTo"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Copyright"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="s2">"Copyright"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-medium</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Author"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">55.0</span><span class="p">),</span><span class="s2">"Author"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"AuDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">47.5</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Supervisor"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">38.5</span><span class="p">),</span><span class="s2">"Supervisor"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SvDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">31.0</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SubTitle"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">42.0</span><span class="p">),</span><span class="s2">"Sub-title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Version"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.0</span><span class="p">),</span> <span class="s2">"Version"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-A"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-B"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-C"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">15.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-D"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">22.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-E"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">29.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-F"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">36.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-G"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">43.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-H"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">50.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-I"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">57.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-centered</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:middle;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Format"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">21</span><span class="p">),</span><span class="s2">"A3"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Sheets"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">148</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1 / 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Scale"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1Â : 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">35</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"___ kg"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-Large</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Title"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">50</span><span class="p">),</span><span class="s2">"Drawing Title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"PtNumber"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">32</span><span class="p">),</span><span class="s2">"Part Number"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1"># --- Main section ---</span>

<span class="n">CreateSvgFile</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span> <span class="c1"># overwrites existing File</span>

<span class="c1"># Set sheet format (DIN A3)</span>
<span class="n">formatWidth</span>  <span class="o">=</span> <span class="s2">"420"</span>
<span class="n">formatHeight</span> <span class="o">=</span> <span class="s2">"297"</span>

<span class="c1">#borders = ToteBag()</span>
<span class="n">setDINBorderValues</span><span class="p">(</span><span class="s1">'DIN'</span><span class="p">)</span>

<span class="n">StartSvg</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span>  <span class="c1"># adds Start tag and namespaces</span>
<span class="n">CreateSheet</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateFrame</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateDecoration</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateTitleBlock</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">CreateEditableText</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">,</span> <span class="n">formatWidth</span><span class="p">,</span> <span class="n">formatHeight</span><span class="p">)</span>
<span class="n">EndSvg</span><span class="p">(</span><span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span><span class="p">)</span>
<span class="c1"># At this point a new SVG-file is generated and saved</span>
<span class="c1"># and shall be attached to the active document</span>

<span class="c1"># -- Add a page and a template to the active document --</span>

<span class="n">activeDoc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>

<span class="c1"># add a page to the active document</span>
<span class="n">newPage</span> <span class="o">=</span> <span class="s1">'Page01'</span> <span class="c1"># first page name to start search</span>

<span class="c1"># to find the current page number to create</span>
<span class="n">pageCount</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pageFound</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">while</span> <span class="n">pageFound</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">newPage</span> <span class="o">+</span> <span class="s2">" to be created"</span><span class="p">)</span>
        <span class="n">pageFound</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pageCount</span> <span class="o">=</span> <span class="n">pageCount</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">pageCount</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">newPage</span> <span class="o">=</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'0'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newPage</span> <span class="o">=</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span>

<span class="c1"># set template number according to page number</span>
<span class="n">newTemplate</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Template'</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>

<span class="c1"># add a page object to the active document</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawPage'</span><span class="p">,</span><span class="n">newPage</span><span class="p">)</span>

<span class="c1"># add a template object to the active document</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawSVGTemplate'</span><span class="p">,</span><span class="n">newTemplate</span><span class="p">)</span>

<span class="c1"># load the svg template into the template object</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span>

<span class="c1"># add the template object to the page's object list</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span>

<span class="c1"># rename 'Page' to 'Sheet'</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="s1">'Sheet '</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># open the page object for editing</span>
<span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">ViewObject</span><span class="o">.</span><span class="n">doubleClicked</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><br/>
</p>
<h3><span class="mw-headline" id="Select_format_and_generate_a_template_then_insert_it">Select format and generate a template then insert it</span></h3>
<p>This combines the tasks to set up an input window to select the sheet format, to generate a template with the chosen dimensions, and to insert it into our active document.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Complete code to select the sheet format, generate a template with the chosen dimensions, and insert it into the active document (In this macro the sheet dimensions are no longer handed over to the functions as parameter but will be read from a global variable)
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QComboBox</span>
<span class="c1">#- set the template path to the directory where your templates are stored</span>
<span class="n">templatePath</span> <span class="o">=</span> <span class="s2">"/Users/.../FreeCAD/Templates/"</span>
<span class="n">templateName</span> <span class="o">=</span> <span class="s2">"MyTemplate.svg"</span>

<span class="c1"># - SVG creation -</span>

<span class="k">class</span> <span class="nc">ToteBag</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1"># This class is empty to act as a container for several variables</span>

<span class="n">borders</span> <span class="o">=</span> <span class="n">ToteBag</span><span class="p">()</span> <span class="c1">#- one bag for drawing border offsets#- one bag for page dimensions</span>
<span class="n">sheetFormat</span> <span class="o">=</span> <span class="n">ToteBag</span><span class="p">()</span> <span class="c1">#- one bag for page dimensions</span>

<span class="k">class</span> <span class="nc">InputWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for InputWindow.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InputWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span> <span class="c1"># Default return status</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">'Input window'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>
        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelFormat</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">"Set drawing format: "</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelFormat</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">'osifont'</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelFormat</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="c1"># set up lists for pop-ups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"ISO A0"</span><span class="p">,</span><span class="s2">"ISO A1"</span><span class="p">,</span><span class="s2">"ISO A2"</span><span class="p">,</span><span class="s2">"ISO A3"</span><span class="p">,</span><span class="s2">"ISO A4"</span><span class="p">,</span>\
<span class="s2">"ANSI A"</span><span class="p">,</span><span class="s2">"ANSI B"</span><span class="p">,</span><span class="s2">"ANSI C"</span><span class="p">,</span><span class="s2">"ANSI D"</span><span class="p">,</span><span class="s2">"ANSI E"</span><span class="p">,</span>\
<span class="s2">"Arch A"</span><span class="p">,</span><span class="s2">"Arch B"</span><span class="p">,</span><span class="s2">"Arch C"</span><span class="p">,</span><span class="s2">"Arch D"</span><span class="p">,</span><span class="s2">"Arch E"</span><span class="p">,</span><span class="s2">"Arch E1"</span><span class="p">)</span>
        <span class="c1"># create some result containers and set default values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResultFormat</span> <span class="o">=</span> <span class="s2">"ISO A4"</span>
        <span class="c1"># create some input elements</span>
        <span class="c1">#- set up pop-up menu - ComboBox - Format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FormatList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">"ISO A4"</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popupFormat</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onPopupFormat</span><span class="p">)</span>

        <span class="c1">#- cancel button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'Cancel'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onCancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># no AutoDefault with okButton!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="c1">#- OK button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">'OK'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">okButton</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">onPopupFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selectedText</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResultFormat</span> <span class="o">=</span> <span class="n">selectedText</span>

    <span class="k">def</span> <span class="nf">onCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Cancelled"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">onOk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"OK"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">#- set values according to ISO, ANSI, Arch</span>
<span class="k">def</span> <span class="nf">setBorderValues</span><span class="p">(</span><span class="nb">format</span><span class="p">):</span>
    <span class="c1"># customise values if needed</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">format</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"ANS"</span><span class="p">:</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>    <span class="o">=</span> <span class="mi">10</span> <span class="c1"># distance from page boundary</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>   <span class="o">=</span> <span class="mi">20</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>  <span class="o">=</span> <span class="mi">10</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>     <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># distance from drawing area border</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>  <span class="o">=</span> <span class="mi">5</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>    <span class="o">=</span> <span class="mi">5</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>   <span class="o">=</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Arc"</span><span class="p">:</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>    <span class="o">=</span> <span class="mi">10</span> <span class="c1"># distance from page boundary</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>   <span class="o">=</span> <span class="mi">20</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>  <span class="o">=</span> <span class="mi">10</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>     <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># distance from drawing area border</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>  <span class="o">=</span> <span class="mi">5</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>    <span class="o">=</span> <span class="mi">5</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>   <span class="o">=</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>    <span class="o">=</span> <span class="mi">10</span> <span class="c1"># distance from page boundary</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>   <span class="o">=</span> <span class="mi">20</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>  <span class="o">=</span> <span class="mi">10</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>     <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># distance from drawing area border</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>  <span class="o">=</span> <span class="mi">5</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>    <span class="o">=</span> <span class="mi">5</span>
        <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>   <span class="o">=</span> <span class="mi">5</span>

<span class="k">def</span> <span class="nf">SetSheetDimensions</span><span class="p">(</span><span class="nb">format</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">format</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"ANS"</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"A"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"216"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"279"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"B"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"432"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"279"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"C"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"559"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"432"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"D"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"864"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"559"</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># E</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"1118"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"864"</span>
    <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Arc"</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"A"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"229"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"305"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"B"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"457"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"305"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"C"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"610"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"457"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"D"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"914"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"610"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"E"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"1219"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"914"</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># E1</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"1067"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"762"</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># ISO</span>
        <span class="k">if</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"4"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"210"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"297"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"3"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"420"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"297"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"2"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"594"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"420"</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"1"</span><span class="p">:</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"841"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"594"</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># A0</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>  <span class="o">=</span> <span class="s2">"1189"</span>
            <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">"841"</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

<span class="c1">#- Function to generate an svg-instruction to draw a rectangle with the given values</span>
<span class="k">def</span> <span class="nf">svgrect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">width</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to draw a path element (line) with the given values</span>
<span class="k">def</span> <span class="nf">svgpath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span><span class="o">==</span><span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y1</span><span class="o">+</span><span class="s2">" l "</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">y2</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place a text element with the given values</span>
<span class="k">def</span> <span class="nf">svgtext</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Function to generate an svg-instruction to place an editable text element with the given values</span>
<span class="k">def</span> <span class="nf">FCeditext</span><span class="p">(</span><span class="n">entryName</span><span class="p">,</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">strValue</span><span class="p">):</span>
    <span class="n">svgLine</span><span class="o">=</span><span class="p">(</span><span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">entryName</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posX</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">posY</span> \
    <span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span><span class="o">+</span><span class="n">strValue</span><span class="o">+</span><span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svgLine</span>

<span class="c1">#- Create a file and insert a header line</span>
<span class="k">def</span> <span class="nf">CreateSvgFile</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"w"</span><span class="p">)</span> <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Create opening svg-tag</span>
<span class="c1">#   Namespace section</span>
<span class="k">def</span> <span class="nf">StartSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span> <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecadweb.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
<span class="c1">#   Sheet size section</span>
<span class="k">def</span> <span class="nf">CreateSheet</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="c1">#- set sheet dimensions</span>
    <span class="n">sWidth</span>  <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>
    <span class="n">sHeight</span> <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">sWidth</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span><span class="o">+</span><span class="n">sHeight</span><span class="o">+</span><span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span><span class="o">+</span><span class="n">sWidth</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="n">sHeight</span><span class="o">+</span><span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height will synchronise mm and svg-units</span>

<span class="c1">#- Create closing svg-tag</span>
<span class="k">def</span> <span class="nf">EndSvg</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Frame creation</span>
<span class="k">def</span> <span class="nf">CreateFrame</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set sheet dimensions</span>
    <span class="n">sWidth</span>  <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>
    <span class="n">sHeight</span> <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>
    <span class="c1"># inner Frame, drawing area</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># outer frame</span>
    <span class="c1">#- upper left corner</span>
    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">)</span>
    <span class="c1">#- lower right corner</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFL</span><span class="o">+</span><span class="n">sFR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFT</span><span class="o">+</span><span class="n">sFB</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">svgrect</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">,</span><span class="n">drawingHeight</span><span class="p">,</span><span class="n">drawingX</span><span class="p">,</span><span class="n">drawingY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Indexes and folding marks creation</span>
<span class="k">def</span> <span class="nf">CreateDecoration</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">index-separators</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- set sheet dimensions</span>
    <span class="n">sWidth</span>  <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>
    <span class="n">sHeight</span> <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaTop</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaLeft</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>
    <span class="n">sFT</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameTop</span>
    <span class="n">sFB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameBottom</span>
    <span class="n">sFL</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameLeft</span>
    <span class="n">sFR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">sheetFrameRight</span>

    <span class="n">drawingX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">drawingY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">drawingWidth</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAL</span><span class="o">-</span><span class="n">dAR</span><span class="p">)</span>
    <span class="n">drawingHeight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAT</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>

    <span class="c1">#- starting point values of center lines</span>
    <span class="n">indexCenter</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexMiddle</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1">#- centre and middle markings of drawing area</span>
    <span class="k">if</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"210"</span><span class="p">:</span> <span class="c1"># format=="DIN-A4":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-15"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-20"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexCenter</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexMiddle</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- starting point values of separator lines</span>
    <span class="n">indexLeft</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="p">)</span>

    <span class="c1">#- set number of horizontal and vertical indexes</span>
    <span class="c1"># this needs to be extended for American formats</span>
    <span class="k">if</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># format=="DIN-A3":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">6</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># format=="DIN-A2":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">12</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">8</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># format=="DIN-A1":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">16</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">12</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># format=="DIN-A0":</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">24</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">16</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">indexCountX</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">indexCountY</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1">#- indexCenter and indexMiddle contain strings but floating point</span>
    <span class="c1">#   numbers are needed to calculate</span>
    <span class="n">floatCenter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAL</span>
    <span class="n">floatMiddle</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">dAT</span>

    <span class="c1">#- horizontal index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical index separators</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span> <span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">    font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- position point values of indexes</span>
    <span class="n">indexLeft</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexRight</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingWidth</span><span class="p">)</span><span class="o">+</span><span class="n">dAL</span><span class="o">+</span><span class="n">sFR</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">indexUpper</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">indexLower</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drawingHeight</span><span class="p">)</span><span class="o">+</span><span class="n">dAT</span><span class="o">+</span><span class="n">sFB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#- horizontal indexes, numbers</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatCenter</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexUpper</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexX</span><span class="p">,</span><span class="n">indexLower</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountX</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- vertical indexes, letters</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">):</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">+</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">9</span> <span class="p">:</span>  <span class="c1"># to avoid the letter J</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">indexY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">floatMiddle</span><span class="o">-</span><span class="n">value</span><span class="o">*</span><span class="mi">50</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexLeft</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="n">indexRight</span><span class="p">,</span><span class="n">indexY</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">64</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">indexCountY</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">value</span><span class="p">)))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- puncher mark</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">puncher mark</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sWidth</span> <span class="ow">in</span><span class="p">[</span><span class="s2">"1189"</span><span class="p">,</span> <span class="s2">"841"</span><span class="p">,</span> <span class="s2">"594"</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># A3 and A4 have extended middle markings</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dAL</span><span class="o">-</span><span class="n">sFL</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">297</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"-10"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1">#- folding marks</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">folding marks</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#b0b0b0;stroke-width:0.25;</span><span class="se">\</span>
<span class="s2">    stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"420"</span><span class="p">:</span> <span class="c1"># DIN-A3</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"125"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"230"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"594"</span><span class="p">:</span> <span class="c1"># DIN-A2</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"402"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"123"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"841"</span><span class="p">:</span> <span class="c1"># DIN-A1</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"651"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"297"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sWidth</span><span class="o">==</span><span class="s2">"1189"</span><span class="p">:</span> <span class="c1"># DIN-A0</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"210"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"400"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"590"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"780"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"999"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="o">+</span><span class="n">sFB</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"105"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">dAT</span><span class="o">-</span><span class="n">sFT</span><span class="p">),</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"247"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  5"</span><span class="p">,</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" -5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">+</span><span class="n">sFR</span><span class="p">),</span><span class="s2">"544"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"  5"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Title block movable</span>
<span class="k">def</span> <span class="nf">CreateTitleBlock</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="c1">#- set sheet dimensions</span>
    <span class="n">sWidth</span>  <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>
    <span class="n">sHeight</span> <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- lower left corner</span>
    <span class="n">tbX</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span><span class="p">)</span>
    <span class="c1">#- group to move allelements in one step</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span><span class="o">+</span><span class="n">tbX</span><span class="o">+</span><span class="s2">","</span><span class="o">+</span><span class="n">tbY</span><span class="o">+</span><span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      </span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- title block</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-16"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-46.5"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 50"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 25"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-26"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">" 50"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-59"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"140"</span><span class="p">,</span><span class="s2">" -4"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-12"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"160"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">" -7"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-14"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-21"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-28"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-35"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-42"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-49"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgpath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"-56"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">" 25"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- small texts, left-aligned</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-60  "</span><span class="p">,</span><span class="s2">"Author Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-52  "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Supervisor Name:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-35.5 "</span><span class="p">,</span><span class="s2">"Date:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Format:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"  1.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Scale:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 26.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Weight:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-27  "</span><span class="p">,</span><span class="s2">"Owner:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">" 51.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Version:"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"141.5"</span><span class="p">,</span><span class="s2">"-13  "</span><span class="p">,</span><span class="s2">"Sheet"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- revision indexes, centered</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-revision-indexes</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:middle;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -1.5  "</span><span class="p">,</span><span class="s2">"A"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">" -8.5  "</span><span class="p">,</span><span class="s2">"B"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-15.5  "</span><span class="p">,</span><span class="s2">"C"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-22.5  "</span><span class="p">,</span><span class="s2">"D"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-29.5  "</span><span class="p">,</span><span class="s2">"E"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-36.5  "</span><span class="p">,</span><span class="s2">"F"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-43.5  "</span><span class="p">,</span><span class="s2">"G"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-50.5  "</span><span class="p">,</span><span class="s2">"H"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span><span class="o">+</span><span class="n">svgtext</span><span class="p">(</span><span class="s2">"157.5"</span><span class="p">,</span><span class="s2">"-57.5  "</span><span class="p">,</span><span class="s2">"I"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="c1">#- Title block editable texts</span>
<span class="k">def</span> <span class="nf">CreateEditableText</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="c1">#- set sheet dimensions</span>
    <span class="n">sWidth</span>  <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">width</span>
    <span class="n">sHeight</span> <span class="o">=</span> <span class="n">sheetFormat</span><span class="o">.</span><span class="n">height</span>
    <span class="c1">#- set frame offsets</span>
    <span class="n">dAB</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaBottom</span>
    <span class="n">dAR</span> <span class="o">=</span> <span class="n">borders</span><span class="o">.</span><span class="n">drawingAreaRight</span>

    <span class="c1">#- offsets for editable texts</span>
    <span class="n">edX</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sWidth</span><span class="p">)</span><span class="o">-</span><span class="n">dAR</span><span class="o">-</span><span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sHeight</span><span class="p">)</span><span class="o">-</span><span class="n">dAB</span>

    <span class="n">t</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="s2">"a"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-owner</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:3.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Owner"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">27.0</span><span class="p">),</span><span class="s2">"Owner"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-address</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:2.5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">23.5</span><span class="p">),</span><span class="s2">"Address1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Address-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">20.0</span><span class="p">),</span><span class="s2">"Address2"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"MailTo"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">16.5</span><span class="p">),</span><span class="s2">"MailTo"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Copyright"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="s2">"Copyright"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-medium</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Author"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">55.0</span><span class="p">),</span><span class="s2">"Author"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"AuDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">47.5</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Supervisor"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">38.5</span><span class="p">),</span><span class="s2">"Supervisor"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SvDate"</span><span class="p">,</span>    <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">7</span><span class="p">),</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">31.0</span><span class="p">),</span><span class="s2">"YYYY/MM/DD"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"SubTitle"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">42.0</span><span class="p">),</span><span class="s2">"Sub-title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Version"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.0</span><span class="p">),</span> <span class="s2">"Version"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-A"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-B"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">8.5</span><span class="p">),</span> <span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-C"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">15.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-D"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">22.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-E"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">29.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-F"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">36.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-G"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">43.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-H"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">50.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Revision-I"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">162</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mf">57.5</span><span class="p">),</span><span class="s2">"______"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-centered</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:5;text-anchor:middle;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Format"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">21</span><span class="p">),</span><span class="s2">"A3"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Sheets"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">148</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1 / 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Scale"</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"1Â : 1"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">35</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="s2">"___ kg"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-Large</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"Title"</span><span class="p">,</span>   <span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">50</span><span class="p">),</span><span class="s2">"Drawing Title"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span><span class="o">+</span><span class="n">FCeditext</span><span class="p">(</span><span class="s2">"PtNumber"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span><span class="o">+</span><span class="mi">62</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span><span class="o">-</span><span class="mi">32</span><span class="p">),</span><span class="s2">"Part Number"</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">templateFile</span> <span class="o">=</span> <span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span>

    <span class="c1"># Gui to select some presets</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">InputWindow</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="s2">"Cancelled"</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">ResultFormat</span><span class="p">)</span>
        <span class="n">setBorderValues</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">ResultFormat</span><span class="p">)</span>
        <span class="n">SetSheetDimensions</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">ResultFormat</span><span class="p">)</span>

        <span class="n">CreateSvgFile</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span> <span class="c1"># overwrites existing File</span>
        <span class="n">StartSvg</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>  <span class="c1"># adds Start tag and namespaces</span>
        <span class="n">CreateSheet</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>
        <span class="n">CreateFrame</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>
        <span class="n">CreateDecoration</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>
        <span class="n">CreateTitleBlock</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>
        <span class="n">CreateEditableText</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>
        <span class="n">EndSvg</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>
        <span class="c1"># At this point a new SVG-file is generated and saved</span>
        <span class="c1"># and shall be attached to the active document</span>

        <span class="c1"># -- Add a page and a template to the active document --</span>

        <span class="n">activeDoc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
        <span class="c1"># add a page to the active document</span>
        <span class="n">newPage</span> <span class="o">=</span> <span class="s2">"Page01"</span> <span class="c1"># first page name to start search</span>
        <span class="c1"># to find the current page number to create</span>
        <span class="n">pageCount</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pageFound</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="n">pageFound</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">newPage</span> <span class="o">+</span> <span class="s2">" to be created"</span><span class="p">)</span>
                <span class="n">pageFound</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pageCount</span> <span class="o">=</span> <span class="n">pageCount</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">pageCount</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">newPage</span> <span class="o">=</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'0'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newPage</span> <span class="o">=</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span>

        <span class="c1"># set template number according to page number</span>
        <span class="n">newTemplate</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Template'</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>
        <span class="c1"># add a page object to the active document</span>
        <span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawPage'</span><span class="p">,</span><span class="n">newPage</span><span class="p">)</span>
        <span class="c1"># add a template object to the active document</span>
        <span class="n">activeDoc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'TechDraw::DrawSVGTemplate'</span><span class="p">,</span><span class="n">newTemplate</span><span class="p">)</span>
        <span class="c1"># load the svg template into the template object</span>
        <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">templatePath</span><span class="o">+</span><span class="n">templateName</span>
        <span class="c1"># add the template object to the page's object list</span>
        <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Template</span> <span class="o">=</span> <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newTemplate</span><span class="p">)</span>
        <span class="c1"># rename 'Page' to 'Sheet'</span>
        <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="s1">'Sheet '</span> <span class="o">+</span> <span class="n">newPage</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
        <span class="c1"># open the page object for editing</span>
        <span class="n">activeDoc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newPage</span><span class="p">)</span><span class="o">.</span><span class="n">ViewObject</span><span class="o">.</span><span class="n">doubleClicked</span><span class="p">()</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><br/>
</p>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
<div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="File/Freecad.svg" width="16"/></span></span></div>
<div style="margin: 4px 0; float: right;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="File/Freecad.svg" width="16"/></span></span></div>
<div style="text-align:center"><a href="Online_Help_Toc.html" title="Online Help Toc">Index</a> <span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="24" src="File/Online_Help_Toc.svg" width="24"/></span></span></div>
</div>
<p><br/>
This is a sandbox / Dies ist eine Sandbox
</p>
<!-- 
NewPP limit report
Cached time: 20241214202901
Cache expiry: 86400
Reduced expiry: false
Complications: [showâtoc, noâtocâconversion]
CPU time usage: 0.634 seconds
Real time usage: 4.122 seconds
Preprocessor visited node count: 427/1000000
Postâexpand include size: 2738/2097152 bytes
Template argument size: 109228/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 17/100
Unstrip recursion depth: 0/20
Unstrip postâexpand size: 702159/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 3499.112      1 -total
 99.74% 3490.108     17 Template:Code
  0.13%    4.687      2 Template:Docnav
  0.02%    0.640      1 Template:TOCright
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:236737-0!canonical and timestamp 20241214202857 and revision id 1097189. Rendering was triggered because: api-parse
 -->
</div></div><script src="script.js"></script>
