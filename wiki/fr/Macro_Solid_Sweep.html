<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro Solid Sweep/fr</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Solid_Sweep.html" lang="de" title="Makro Solid Sweep (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Solid_Sweep.html" lang="en" title="Macro Solid Sweep (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Solid_Sweep.html" lang="es" title="Macro Solid Sweep (82% translated)">español</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="fr">français</span></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Solid_Sweep.html" lang="it" title="Macro Solid Sweep (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Macro_Solid_Sweep.html" lang="pl" title="Makrodefinicja: Solid Sweep (9% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Solid_Sweep.html" lang="cs" title="Makro Těleso vlečením profilu (82% translated)">čeština</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Solid_Sweep.png"><img decoding="async" height="32" src="../File/Macro_Solid_Sweep.png" srcset="/images/thumb/6/6d/Macro_Solid_Sweep.png/48px-Macro_Solid_Sweep.png 1.5x, /images/6/6d/Macro_Solid_Sweep.png 2x" width="32"/></a></span><span> </span>
Balayage solide
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Créé un solide en balayant un profil le long d'une trajectoire.<br/><br/>Version macro : 1.0<br/>Date dernière modification : 2011-12-03<br/>Version FreeCAD : Toutes versions<br/>Téléchargement : [<a class="external free" href="https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png" rel="nofollow">https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png</a>
<p>Icône pour votre barre d'outils]<br/>Auteur: Normandc<br/>
</p>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="User;Normandc.html" title="User:Normandc">Normandc</a>
</td></tr>
<tr>
<th class="ctOdd">Téléchargement
</th></tr>
<tr>
<td class="ctEven macro-download">[<a class="external free" href="https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png" rel="nofollow">https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png</a>
<p>Icône pour votre barre d'outils]
</p>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br/><a href="How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br/><a href="Customize_Toolbars.html" title="Customize Toolbars/fr">Comment créer une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Dernière modification
</th></tr>
<tr>
<td class="ctEven macro-date">2011-12-03
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes versions
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Utilisation"><span class="tocnumber">2</span> <span class="toctext">Utilisation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Éléments_2D_supportés"><span class="tocnumber">3</span> <span class="toctext">Éléments 2D supportés</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Conseils"><span class="tocnumber">4</span> <span class="toctext">Conseils</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Le_script"><span class="tocnumber">5</span> <span class="toctext">Le script</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remerciements"><span class="tocnumber">6</span> <span class="toctext">Remerciements</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Cette macro créé un solide en balayant un profil le long d'une trajectoire, les deux éléments ayant précédemment été sélectionnés dans la vue 3D. Les éléments 2D peuvent être créés à l'aide des outils existants de l'interface graphique de FreeCAD.
</p><p>Il est à noter que le solide généré ne sera <b>pas</b> paramétrique. Si vous décidez de modifier le profil ou la trajectoire, vous devrez exécuter la macro à nouveau.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Solid_sweep.png" title="Quelques exemples de balayages utilisant une même section oblongue et trois types de trajectoires."><img alt="Quelques exemples de balayages utilisant une même section oblongue et trois types de trajectoires." decoding="async" height="331" src="../File/Solid_sweep.png" srcset="/images/thumb/f/fd/Solid_sweep.png/750px-Solid_sweep.png 1.5x, /images/f/fd/Solid_sweep.png 2x" width="500"/></a></span>
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<ol><li>Créez deux éléments 2D, un pour la section et un pour la trajectoire, des types répertoriés ci-dessous.</li>
<li>Sélectionnez, soit dans la <a href="Tree_view.html" title="Tree view/fr">vue en arborescence</a> soit dans <a href="3D_view.html" title="3D view/fr">Vue 3D</a> (<b>L'ordre est important!</b>):
<ol><li>La trajectoire</li>
<li>Puis le profil</li></ol></li>
<li>Ouvrez le <a href="Macros.html" title="Macros/fr">Gestionnaire de macros</a></li>
<li>Sélectionnez la macro <b>Solid Sweep</b></li>
<li>Cliquez sur <span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;">Execute</span></li></ol>
<p><b>Résultat:</b> un <b>Balayage</b> sera créé dans l'arborescence du Projet.
</p>
<h2><span id=".C3.89l.C3.A9ments_2D_support.C3.A9s"></span><span class="mw-headline" id="Éléments_2D_supportés">Éléments 2D supportés</span></h2>
<ul><li>Filaires</li>
<li><span typeof="mw:File"><a class="mw-file-description" href="../File/Sketcher_NewSketch.svg"><img decoding="async" height="24" src="../File/Sketcher_NewSketch.svg" width="24"/></a></span> <a href="Sketcher_Workbench.html" title="Sketcher Workbench/fr">Esquisses</a></li>
<li><span typeof="mw:File"><a class="mw-file-description" href="../File/Draft_BSpline.svg"><img decoding="async" height="24" src="../File/Draft_BSpline.svg" width="24"/></a></span> <a href="Draft_BSpline.html" title="Draft BSpline/fr">BSplines</a></li>
<li>Primitives 2D depuis le menu <i>Pièce → <span typeof="mw:File"><a class="mw-file-description" href="../File/Part_Primitives.svg"><img decoding="async" height="24" src="../File/Part_Primitives.svg" width="24"/></a></span> <a href="Part_Primitives.html" title="Part Primitives/fr">Créer des primitives</a>...</i> (cercle, hélice)</li></ul>
<h2><span class="mw-headline" id="Conseils">Conseils</span></h2>
<ul><li>La section doit être un profil fermé sinon la forme résultante ne sera pas solide.</li>
<li>La section n'a pas besoin d'être située sur la trajectoire, mais il est préférable qu'elle lui soit normale (perpendiculaire).</li>
<li>La trajectoire peut indifféremment être un profil ouvert ou fermé (cercle, ou une suite de segments de lignes et d'arcs) mais tous les éléments doivent être tangents, sinon le résultat pourrait être inattendu. Par exemple, une trajectoire avec des coins carrés comme un rectangle ne produira pas un solide.</li>
<li>S'il y a un nœud dans la forme résultante, modifiez la macro et changez la valeur <i>isFrenet</i> à 0 (zéro), puis essayez à nouveau.</li>
<li>Réglez la variable <i>makeSolid</i> à 0 (zéro) pour obtenir une forme non solide faite de surfaces avec des extrémités ouvertes.</li></ul>
<h2><span class="mw-headline" id="Le_script">Le script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Solid_Sweep.png"><img decoding="async" height="64" src="../File/Macro_Solid_Sweep.png" width="64"/></a></span>
</p><p><b>Macro_Solid_Sweep.FCMacro</b>
</p>
<pre>import Part, FreeCAD, math, PartGui, FreeCADGui
from FreeCAD import Base

# get the selected objects, with first selection for the trajectory and second for the section
s = FreeCADGui.Selection.getSelection()
try:
     shape1=s[0].Shape
     shape2=s[1].Shape
except:
     print "Wrong selection"

traj = Part.Wire([shape1])
section = Part.Wire([shape2])

# create Part objec in the current document
myObject=App.ActiveDocument.addObject("Part::Feature","Sweep")

# variable makeSolid = 1 to create solid, 0 to create surfaces
makeSolid = True #1
isFrenet = True #1

# create a 3D shape and assigh it to the current document
Sweep = Part.Wire(traj).makePipeShell([section],makeSolid,isFrenet)
myObject.Shape = Sweep</pre>
<p><br/>
</p>
<h2><span class="mw-headline" id="Remerciements">Remerciements</span></h2>
<p>Merci à <a href="User;Wmayer.html" title="User:Wmayer">Wmayer</a> sans l'aide de qui je n'aurais pu rédiger ce script.
</p><p>Deux exemples d'utilisation peuvent être consultés dans <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=8&amp;t=1222&amp;start=50#p11120" rel="nofollow">cette discussion du forum (en anglais)</a>, ainsi que des liens de téléchargement des fichiers FCStd. En utilisant une hélice comme trajectoire, un balayage solide peut être utilisé pour créer un filet de vis.
</p>
<!-- 
NewPP limit report
Cached time: 20241129210902
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.080 seconds
Real time usage: 0.121 seconds
Preprocessor visited node count: 112/1000000
Post‐expand include size: 2424/2097152 bytes
Template argument size: 1263/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2034/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.953      1 -total
 43.76%    1.730      1 Template:Macro/fr
 33.40%    1.320      1 Template:MacroCode
 17.91%    0.708      1 Template:Button
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:1878-0!canonical and timestamp 20241129210902 and revision id 808096. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
