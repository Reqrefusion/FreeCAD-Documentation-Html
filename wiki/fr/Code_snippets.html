<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Code snippets/fr</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Code_snippets.html" lang="id" title="Code snippets (1% translated)">Bahasa Indonesia</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Code_snippets.html" lang="de" title="Code Schnipsel (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Code_snippets.html" lang="en" title="Code snippets (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Code_snippets.html" lang="tr" title="Code snippets (1% translated)">Türkçe</a></li>
<li><a class="mw-pt-progress mw-pt-progress--high" dir="ltr" href="Code_snippets.html" lang="es" title="Fragmentos Código (68% translated)">español</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="fr">français</span></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Code_snippets.html" lang="it" title="Frammenti di codice (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Code_snippets.html" lang="pl" title="Wycinki kodów (100% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="Code_snippets.html" lang="ro" title="Fragmente de cod (30% translated)">română</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Code_snippets.html" lang="sv" title="Code snippets (12% translated)">svenska</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Code_snippets.html" lang="cs" title="Code snippets (1% translated)">čeština</a></li>
<li><a class="mw-pt-progress mw-pt-progress--med" dir="ltr" href="Code_snippets.html" lang="ru" title="Code snippets (43% translated)">русский</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Code_snippets.html" lang="ja" title="Code snippets (10% translated)">日本語</a></li></ul></div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Extraits"><span class="tocnumber">2</span> <span class="toctext">Extraits</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Un_fichier_typique_InitGui.py"><span class="tocnumber">2.1</span> <span class="toctext">Un fichier typique InitGui.py</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Un_fichier_module_typique"><span class="tocnumber">2.2</span> <span class="toctext">Un fichier module typique</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Importer_un_nouveau_type_de_fichier"><span class="tocnumber">2.3</span> <span class="toctext">Importer un nouveau type de fichier</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Ajouter_une_ligne"><span class="tocnumber">2.4</span> <span class="toctext">Ajouter une ligne</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Ajouter_un_polygone"><span class="tocnumber">2.5</span> <span class="toctext">Ajouter un polygone</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Ajouter_et_supprimer_un_objet_dans/d'un_groupe"><span class="tocnumber">2.6</span> <span class="toctext">Ajouter et supprimer un objet dans/d'un groupe</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Ajouter_une_maille_(Mesh)"><span class="tocnumber">2.7</span> <span class="toctext">Ajouter une maille (Mesh)</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Ajouter_un_arc_ou_un_cercle"><span class="tocnumber">2.8</span> <span class="toctext">Ajouter un arc ou un cercle</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Accéder_et_changer_la_représentation_d'un_objet"><span class="tocnumber">2.9</span> <span class="toctext">Accéder et changer la représentation d'un objet</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Remplacer_la_forme_de_la_souris_par_une_image"><span class="tocnumber">2.10</span> <span class="toctext">Remplacer la forme de la souris par une image</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Remplacer_la_forme_de_la_souris_par_une_image_(croix)"><span class="tocnumber">2.11</span> <span class="toctext">Remplacer la forme de la souris par une image (croix)</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Observer_le_changement_de_la_caméra_dans_la_vue_3D_via_Python"><span class="tocnumber">2.12</span> <span class="toctext">Observer le changement de la caméra dans la vue 3D via Python</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Observer_des_évènements_de_la_souris_dans_la_vue_3D_via_Python"><span class="tocnumber">2.13</span> <span class="toctext">Observer des évènements de la souris dans la vue 3D via Python</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Afficher_les_évènements_claviers_et_commandes"><span class="tocnumber">2.14</span> <span class="toctext">Afficher les évènements claviers et commandes</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Manipuler_des_graphes_de_scène_en_Python"><span class="tocnumber">2.15</span> <span class="toctext">Manipuler des graphes de scène en Python</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Ajouter_et_effacer_des_objets_au/de_graphe_de_scène"><span class="tocnumber">2.16</span> <span class="toctext">Ajouter et effacer des objets au/de graphe de scène</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Enregistrer_le_graphe_de_scène_en_3_séries_de_36_fichiers"><span class="tocnumber">2.17</span> <span class="toctext">Enregistrer le graphe de scène en 3 séries de 36 fichiers</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Ajouter_des_widgets_personnalisés_à_l'interface"><span class="tocnumber">2.18</span> <span class="toctext">Ajouter des widgets personnalisés à l'interface</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Ajouter_un_onglet_à_la_vue_combinée"><span class="tocnumber">2.19</span> <span class="toctext">Ajouter un onglet à la vue combinée</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Activer_ou_désactiver_une_fenêtre"><span class="tocnumber">2.20</span> <span class="toctext">Activer ou désactiver une fenêtre</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Ouvrir_une_page_web_personnalisée"><span class="tocnumber">2.21</span> <span class="toctext">Ouvrir une page web personnalisée</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Obtenir_le_code_HTML_d'une_page_Web_ouverte"><span class="tocnumber">2.22</span> <span class="toctext">Obtenir le code HTML d'une page Web ouverte</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Extraire_les_coordonnées_de_3_points_ou_3_objets_sélectionnés"><span class="tocnumber">2.23</span> <span class="toctext">Extraire les coordonnées de 3 points ou 3 objets sélectionnés</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Lister_les_objets"><span class="tocnumber">2.24</span> <span class="toctext">Lister les objets</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Lister_les_dimensions_en_donnant_le_nom_de_l'objet"><span class="tocnumber">2.25</span> <span class="toctext">Lister les dimensions en donnant le nom de l'objet</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Fonction_résidente_avec_action_au_clic_de_souris"><span class="tocnumber">2.26</span> <span class="toctext">Fonction résidente avec action au clic de souris</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Afficher_le_document_actif"><span class="tocnumber">2.27</span> <span class="toctext">Afficher le document actif</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Rechercher_et_sélectionner_tous_les_éléments_sous_le_curseur"><span class="tocnumber">2.28</span> <span class="toctext">Rechercher et sélectionner tous les éléments sous le curseur</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Lister_les_composantes_d'un_objet"><span class="tocnumber">2.29</span> <span class="toctext">Lister les composantes d'un objet</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Lister_les_PropertiesList"><span class="tocnumber">2.30</span> <span class="toctext">Lister les PropertiesList</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Ajouter_un_seul_commentaire_de_propriété"><span class="tocnumber">2.31</span> <span class="toctext">Ajouter un seul commentaire de propriété</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Rechercher_et_extraire_des_données"><span class="tocnumber">2.32</span> <span class="toctext">Rechercher et extraire des données</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Rechercher_manuellement_un_élément_par_son_label"><span class="tocnumber">2.33</span> <span class="toctext">Rechercher manuellement un élément par son label</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Coordonnées_cartésiennes"><span class="tocnumber">2.34</span> <span class="toctext">Coordonnées cartésiennes</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Sélectionner_tous_les_objets_du_document"><span class="tocnumber">2.35</span> <span class="toctext">Sélectionner tous les objets du document</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Sélectionner_une_face_d'un_objet_par_le_nom_de_l'objet_et_numéro_de_la_face"><span class="tocnumber">2.36</span> <span class="toctext">Sélectionner une face d'un objet par le nom de l'objet et numéro de la face</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Obtenir_le_vecteur_normal_d'une_face_d'un_objet_par_le_nom_de_l'objet_et_numéro_de_la_face_(r.Q)"><span class="tocnumber">2.37</span> <span class="toctext">Obtenir le vecteur normal d'une face d'un objet par le nom de l'objet et numéro de la face (r.Q)</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Obtenir_le_vecteur_normal_d'une_face_d'un_objet_par_le_nom_de_l'objet_et_numéro_de_la_face"><span class="tocnumber">2.38</span> <span class="toctext">Obtenir le vecteur normal d'une face d'un objet par le nom de l'objet et numéro de la face</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Obtenir_le_vecteur_normal_d'un_objet_sélectionné_et_le_numéro_de_la_face"><span class="tocnumber">2.39</span> <span class="toctext">Obtenir le vecteur normal d'un objet sélectionné et le numéro de la face</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Obtenir_le_vecteur_normal_sur_une_surface"><span class="tocnumber">2.40</span> <span class="toctext">Obtenir le vecteur normal sur une surface</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Crée_une_ligne_sur_la_normale_de_la_face_au_point_cliqué_par_la_souris"><span class="tocnumber">2.41</span> <span class="toctext">Crée une ligne sur la normale de la face au point cliqué par la souris</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Obtenir_le_vecteur_normal_d'une_surface_à_partir_d'un_fichier_STL"><span class="tocnumber">2.42</span> <span class="toctext">Obtenir le vecteur normal d'une surface à partir d'un fichier STL</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#Créer_un_objet_dans_la_position_de_la_caméra"><span class="tocnumber">2.43</span> <span class="toctext">Créer un objet dans la position de la caméra</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Lire_et_écrire_une_Expression"><span class="tocnumber">2.44</span> <span class="toctext">Lire et écrire une Expression</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Créer_une_esquisse_sur_une_surface_dans_PartDesign"><span class="tocnumber">2.45</span> <span class="toctext">Créer une esquisse sur une surface dans PartDesign</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Comment_simuler_un_clic_de_souris_sur_une_coordonnée_donnée"><span class="tocnumber">2.46</span> <span class="toctext">Comment simuler un clic de souris sur une coordonnée donnée</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#Comment_créer_une_face_avec_des_trous_à_l'aide_de_l'API_Python"><span class="tocnumber">2.47</span> <span class="toctext">Comment créer une face avec des trous à l'aide de l'API Python</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Fermer_et_redémarrer_FreeCAD"><span class="tocnumber">2.48</span> <span class="toctext">Fermer et redémarrer FreeCAD</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-51"><a href="#Coin3D"><span class="tocnumber">3</span> <span class="toctext">Coin3D</span></a></li>
<li class="toclevel-1 tocsection-52"><a href="#En_relation"><span class="tocnumber">4</span> <span class="toctext">En relation</span></a></li>
</ul>
</div>
</div>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>Cette page contient des exemples, des pièces, des extraits de code FreeCAD en Python, recueillis auprès d'utilisateurs expérimentés et de discussions sur les <a class="external text" href="https://forum.freecadweb.org/viewforum.php?f=22" rel="nofollow">forums</a>. Lisez les et utilisez les comme point de départ pour vos propres scripts...
</p><p><span id="Snippets"></span>
</p>
<h2><span class="mw-headline" id="Extraits">Extraits</span></h2>
<p><span id="A_typical_InitGui.py_file"></span>
</p>
<h3><span class="mw-headline" id="Un_fichier_typique_InitGui.py">Un fichier typique InitGui.py</span></h3>
<p>Chaque module doit contenir, en plus de votre fichier de module principal, un fichier InitGui.py, chargé d'insérer le module dans l'interface graphique principale. Ceci est un exemple simple. 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ScriptWorkbench</span> <span class="p">(</span><span class="n">Workbench</span><span class="p">):</span> 
    <span class="n">MenuText</span> <span class="o">=</span> <span class="s2">"Scripts"</span>
    <span class="k">def</span> <span class="nf">Initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">Scripts</span> <span class="c1"># assuming Scripts.py is your module</span>
        <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Script_Cmd"</span><span class="p">]</span> <span class="c1"># That list must contain command names, that can be defined in Scripts.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendToolbar</span><span class="p">(</span><span class="s2">"My Scripts"</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> 
        
<span class="n">Gui</span><span class="o">.</span><span class="n">addWorkbench</span><span class="p">(</span><span class="n">ScriptWorkbench</span><span class="p">())</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="A_typical_module_file"></span>
</p>
<h3><span class="mw-headline" id="Un_fichier_module_typique">Un fichier module typique</span></h3>
<p>Ceci est un exemple de fichier de module principal, contenant tout ce que fait votre module. Il s'agit du fichier Scripts.py appelé par l'exemple précédent. Vous pouvez avoir toutes vos commandes personnalisées ici.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span> 
 
<span class="k">class</span> <span class="nc">ScriptCmd</span><span class="p">:</span> 
   <span class="k">def</span> <span class="nf">Activated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
       <span class="c1"># Here your write what your ScriptCmd does...</span>
       <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">GetResources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
       <span class="k">return</span> <span class="p">{</span><span class="s1">'Pixmap'</span> <span class="p">:</span> <span class="s1">'path_to_an_icon/myicon.png'</span><span class="p">,</span> <span class="s1">'MenuText'</span><span class="p">:</span> <span class="s1">'Short text'</span><span class="p">,</span> <span class="s1">'ToolTip'</span><span class="p">:</span> <span class="s1">'More detailed text'</span><span class="p">}</span> 
       
<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">addCommand</span><span class="p">(</span><span class="s1">'Script_Cmd'</span><span class="p">,</span> <span class="n">ScriptCmd</span><span class="p">())</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Import_a_new_filetype"></span>
</p>
<h3><span class="mw-headline" id="Importer_un_nouveau_type_de_fichier">Importer un nouveau type de fichier</span></h3>
<p>Créer un importateur pour un nouveau type de fichier dans FreeCAD est facile. FreeCAD ne considère pas que vous importez des données dans un document ouvert mais plutôt que vous pouvez simplement ouvrir directement le nouveau type de fichier. Donc, ce que vous devez faire est d'ajouter la nouvelle extension de fichier à la liste des extensions connues de FreeCAD et d'écrire le code qui lira le fichier et créera les objets FreeCAD que vous voulez:
</p><p>Cette ligne doit être ajoutée au fichier <b>InitGui.py</b> pour ajouter la nouvelle extension de fichier à la liste:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># Assumes Import_Ext.py is the file that has the code for opening and reading .ext files</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">addImportType</span><span class="p">(</span><span class="s2">"Your new File Type (*.ext)"</span><span class="p">,</span><span class="s2">"Import_Ext"</span><span class="p">)</span>
</pre></div>
<p>Puis, dans le fichier <b>Import_Ext.py</b>, faites:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span> 
   <span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
   <span class="c1"># here you do all what is needed with filename, read, classify data, create corresponding FreeCAD objects</span>
   <span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p>Pour exporter votre document avec une  nouvelle extension, le fonctionnement est le même, mais vous devrez faire:
</p>
<pre>FreeCAD.addExportType("Your new File Type (*.ext)","Export_Ext")
</pre>
<p><a href="#top">En haut</a></p>
<p><span id="Add_a_line"></span>
</p>
<h3><span class="mw-headline" id="Ajouter_une_ligne">Ajouter une ligne</span></h3>
<p>Une ligne a uniquement deux points.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span><span class="nn">PartGui</span> 
<span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> 
<span class="c1"># add a line element to the document and set its points </span>
<span class="n">l</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">LineSegment</span><span class="p">()</span>
<span class="n">l</span><span class="o">.</span><span class="n">StartPoint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">EndPoint</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span><span class="o">.</span><span class="n">Shape</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span> 
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_a_polygon"></span>
</p>
<h3><span class="mw-headline" id="Ajouter_un_polygone">Ajouter un polygone</span></h3>
<p>Un polygone est simplement un ensemble de segments connnectés (une polyligne dans AutoCAD). Il n'est pas obligatoirement fermé.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">PartGui</span> 
<span class="n">doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span> 

<span class="c1"># create a 3D vector, set its coordinates and add it to the list </span>
<span class="n">v</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="n">v</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="c1">#... repeat for all nodes </span>

<span class="c1"># Create a polygon object and set its nodes </span>
<span class="n">p</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Polygon"</span><span class="p">,</span><span class="s2">"Polygon"</span><span class="p">)</span> 
<span class="n">p</span><span class="o">.</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">n</span> 
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_and_remove_an_object_to/from_a_group"></span>
</p>
<h3><span id="Ajouter_et_supprimer_un_objet_dans.2Fd.27un_groupe"></span><span class="mw-headline" id="Ajouter_et_supprimer_un_objet_dans/d'un_groupe">Ajouter et supprimer un objet dans/d'un groupe</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> 
<span class="n">grp</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::DocumentObjectGroup"</span><span class="p">,</span> <span class="s2">"Group"</span><span class="p">)</span> 
<span class="n">lin</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span> <span class="s2">"Line"</span><span class="p">)</span>
<span class="n">grp</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">lin</span><span class="p">)</span> <span class="c1"># adds the lin object to the group grp</span>
<span class="n">grp</span><span class="o">.</span><span class="n">removeObject</span><span class="p">(</span><span class="n">lin</span><span class="p">)</span> <span class="c1"># removes the lin object from the group grp</span>
</pre></div>
<p>Remarque: vous pouvez aussi ajouter d'autres groupes à un groupe...
</p>
<p><a href="#top">En haut</a></p>
<p><span id="Add_a_Mesh"></span>
</p>
<h3><span id="Ajouter_une_maille_.28Mesh.29"></span><span class="mw-headline" id="Ajouter_une_maille_(Mesh)">Ajouter une maille (Mesh)</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Mesh</span>
<span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="c1"># create a new empty mesh</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">Mesh</span><span class="p">()</span>
<span class="c1"># build up box out of 12 facets</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="c1"># scale to a edge langth of 100</span>
<span class="n">m</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
<span class="c1"># add the mesh to the active document</span>
<span class="n">me</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Mesh::Feature"</span><span class="p">,</span><span class="s2">"Cube"</span><span class="p">)</span>
<span class="n">me</span><span class="o">.</span><span class="n">Mesh</span><span class="o">=</span><span class="n">m</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_an_arc_or_a_circle"></span>
</p>
<h3><span class="mw-headline" id="Ajouter_un_arc_ou_un_cercle">Ajouter un arc ou un cercle</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Circle</span><span class="p">()</span> 
<span class="n">c</span><span class="o">.</span><span class="n">Radius</span><span class="o">=</span><span class="mf">10.0</span>  
<span class="n">f</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span> <span class="s2">"Circle"</span><span class="p">)</span> <span class="c1"># create a document with a circle feature </span>
<span class="n">f</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span> <span class="c1"># Assign the circle shape to the shape property </span>
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Access_and_change_the_representation_of_an_object"></span>
</p>
<h3><span id="Acc.C3.A9der_et_changer_la_repr.C3.A9sentation_d.27un_objet"></span><span class="mw-headline" id="Accéder_et_changer_la_représentation_d'un_objet">Accéder et changer la représentation d'un objet</span></h3>
<p>Chaque objet dans un document FreeCAD a un objet de représentation de vue associé qui stocke tous les paramètres qui définissent la façon dont cet objet apparaît: c'est-à-dire la couleur, la largeur de ligne, etc... Voir aussi l'extrait ci-dessous <a href="#Lister_les_composantes_d.27un_objet">Lister les composantes d'un objet</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">gad</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> <span class="c1"># access the active document containing all </span>
                           <span class="c1"># view representations of the features in the</span>
                           <span class="c1"># corresponding App document </span>

<span class="n">v</span> <span class="o">=</span> <span class="n">gad</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">"Cube"</span><span class="p">)</span>  <span class="c1"># access the view representation to the Mesh feature 'Cube' </span>
<span class="n">v</span><span class="o">.</span><span class="n">ShapeColor</span>               <span class="c1"># prints the color to the console </span>
<span class="n">v</span><span class="o">.</span><span class="n">ShapeColor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># sets the shape color to white</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Replace_the_form_of_mouse_with_one_image"></span>
</p>
<h3><span class="mw-headline" id="Remplacer_la_forme_de_la_souris_par_une_image">Remplacer la forme de la souris par une image</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QCursor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<span class="n">myImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">"Complete_Path_to_image.bmp"</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">myImage</span><span class="p">)</span>
<span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Replace_the_form_of_mouse_with_one_image_(cross)_include"></span>
</p>
<h3><span id="Remplacer_la_forme_de_la_souris_par_une_image_.28croix.29"></span><span class="mw-headline" id="Remplacer_la_forme_de_la_souris_par_une_image_(croix)">Remplacer la forme de la souris par une image (croix)</span></h3>
<p>L'image est créée par Gimp et exportée dans un fichier .XPM. Copiez et utilisez le code entre le crochet <b>"{"</b>  code to copy  <b>"}"</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QCursor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<span class="n">cross32x32Icon</span> <span class="o">=</span> <span class="p">[</span>
<span class="s2">"32 32 2 1"</span><span class="p">,</span>
<span class="s2">" 	c None"</span><span class="p">,</span>
<span class="s2">".	c #FF0000"</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                                "</span><span class="p">,</span>
<span class="s2">"............... . .............."</span><span class="p">,</span>
<span class="s2">"                                "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span>
<span class="p">]</span>

<span class="n">myImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">cross32x32Icon</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">myImage</span><span class="p">)</span>
<span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Observe_camera_change_in_the_3D_viewer_via_Python"></span>
</p>
<h3><span id="Observer_le_changement_de_la_cam.C3.A9ra_dans_la_vue_3D_via_Python"></span><span class="mw-headline" id="Observer_le_changement_de_la_caméra_dans_la_vue_3D_via_Python">Observer le changement de la caméra dans la vue 3D via Python</span></h3>
<p>Cela peut être fait en ajoutant un <a class="external text" href="https://www.coin3d.org/Coin/html/classSoNodeSensor.html" rel="nofollow">capteur Node</a> à la caméra. 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">cam</span><span class="p">,</span> <span class="n">sensor</span> <span class="o">=</span> <span class="n">args</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Cam position : </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Cam rotation : </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>

<span class="n">camera_node</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraNode</span><span class="p">()</span>
<span class="n">node_sensor</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoNodeSensor</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">camera_node</span><span class="p">)</span>
<span class="n">node_sensor</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">camera_node</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Observe_mouse_events_in_the_3D_viewer_via_Python"></span>
</p>
<h3><span id="Observer_des_.C3.A9v.C3.A8nements_de_la_souris_dans_la_vue_3D_via_Python"></span><span class="mw-headline" id="Observer_des_évènements_de_la_souris_dans_la_vue_3D_via_Python">Observer des évènements de la souris dans la vue 3D via Python</span></h3>
<p>La structure Inventor permet d'ajouter un ou plusieurs nœuds de rappel au graphe de scène de la vue. Par défaut dans FreeCAD, un nœud de rappel est installé par vue, ce qui permet d'ajouter des fonctions C ++ globales ou statiques. Dans la liaison Python appropriée, certaines méthodes sont fournies pour utiliser cette technique à partir du code Python.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
 
<span class="c1">#This class logs any mouse button events. As the registered callback function fires twice for 'down' and</span>
<span class="c1">#'up' events we need a boolean flag to handle this.</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"State"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"DOWN"</span><span class="p">)</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">"Position"</span><span class="p">]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">down</span><span class="p">):</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Clicked on position: ("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">", "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">")</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       
<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>
</pre></div>
<p><br/>
Maintenant, choisissez une zone dans l'écran (surface de travail) 3D et observez les messages affichés dans la fenêtre de sortie. Pour terminer l'observation il suffit de faire:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">removeEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
<p>Les types d’évènements suivants sont pris en charge:
</p>
<ul><li>SoEvent -- tous types d'évènements</li>
<li>SoButtonEvent -- tous les évènements, boutons, molette</li>
<li>SoLocation2Event -- tous les évènements 2D (déplacements normaux de la souris)</li>
<li>SoMotion3Event -- tous les évènements 3D (pour le spaceball)</li>
<li>SoKeyboardEvent -- évènements des touches <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">flèche haut</span> et <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">flèche bas</span></li>
<li>SoMouseButtonEvent -- tous les évènements boutons Haut et Bas de la souris</li>
<li>SoSpaceballButtonEvent -- tous les évènements Haut et Bas (pour le spaceball)</li></ul>
<p>Les fonctions Python qui peuvent être enregistrées avec addEventCallback()<b> attendent la définition d'une bibliothèque.</b>
</p><p>Suivant la façon dont l’évènement survient, la bibliothèque peut disposer de différentes clefs.
</p><p>Il y a une clef pour chaque événement:
</p>
<ul><li>Type -- le nom du type d'évènement par exemple SoMouseEvent, SoLocation2Event, ...<b> </b></li>
<li>Time -- l'heure courante codée dans une chaîne string</li>
<li>Position -- un tuple de deux <b><a class="external text" href="http://docs.python.org/library/functions.html#int" rel="nofollow">integers</a></b>, donant la  position x,y de la souris</li>
<li>ShiftDown -- type boolean, true si <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Shift</span> est pressé sinon, false</li>
<li>CtrlDown -- type boolean, true si <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Ctrl</span> est pressé sinon, false</li>
<li>AltDown -- type boolean, true si <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Alt</span> est pressé sinon, false</li></ul>
<p>Pour un évènement bouton comme clavier, souris ou spaceball
</p>
<ul><li>State -- la chaîne UP si le bouton est relevé, DOWN si le bouton est enfoncé ou UNKNOWN si rien ne se passe</li></ul>
<p>Pour un évènement clavier: 
</p>
<ul><li>Key -- le caractère de la touche qui est pressée</li></ul>
<p>Pour un évènement bouton de souris:
</p>
<ul><li>Button -- le bouton pressé peut être BUTTON1, ..., BUTTON5 ou tous</li></ul>
<p>Pour un évènement spaceball: 
</p>
<ul><li>Button -- le bouton pressé peut être BUTTON1, ..., BUTTON7 ou tous</li></ul>
<p>Et finalement les évènement de mouvements: 
</p>
<ul><li>Translation -- un tuple de trois <a class="external text" href="http://docs.python.org/library/functions.html#float" rel="nofollow">float()</a></li>
<li>Rotation -- un quaternion, tuple de quattre <a class="external text" href="http://docs.python.org/library/functions.html#float" rel="nofollow">float()</a></li></ul>
<p><a href="#top">En haut</a></p>
<p><span id="Display_keys_pressed_and_Events_command"></span>
</p>
<h3><span id="Afficher_les_.C3.A9v.C3.A8nements_claviers_et_commandes"></span><span class="mw-headline" id="Afficher_les_évènements_claviers_et_commandes">Afficher les évènements claviers et commandes</span></h3>
<p>Cette macro affiche dans la vue du rapport les touches enfoncées et tous les événements commande 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="k">try</span><span class="p">:</span>
           <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"Key"</span><span class="p">])</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">down</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># here the character pressed</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># list all events command</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"_______________________________________"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
           <span class="kc">None</span>
 
<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>

<span class="c1">#v.removeEventCallback("SoEvent",c) # remove ViewObserver</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Manipulate_the_scenegraph_in_Python"></span>
</p>
<h3><span id="Manipuler_des_graphes_de_sc.C3.A8ne_en_Python"></span><span class="mw-headline" id="Manipuler_des_graphes_de_scène_en_Python">Manipuler des graphes de scène en Python</span></h3>
<p>Il est également possible d'obtenir et de modifier le graphe de scène en Python, avec le module 'pivy' - une liaison Python pour Coin.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy.coin</span> <span class="kn">import</span> <span class="o">*</span>                <span class="c1"># load the pivy module</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>   <span class="c1"># get the active viewer</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">getSceneGraph</span><span class="p">()</span>            <span class="c1"># the root is an SoSeparator node</span>
<span class="n">root</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">SoCube</span><span class="p">())</span>
<span class="n">view</span><span class="o">.</span><span class="n">fitAll</span><span class="p">()</span>
</pre></div>
<p>L'API Python de pivy est créé en utilisant l'outil <a class="external text" href="http://www.swig.org/" rel="nofollow">SWIG</a>. Comme dans FreeCAD nous utilisons certains noeuds (nodes) écrits automatiquement nous ne pouvons pas les créer directement en Python.
Il est cependant, possible de créer un noeud avec son nom interne. Un exemple de type 'SoFCSelection' peut être créé avec:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">type</span> <span class="o">=</span> <span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s2">"SoFCSelection"</span><span class="p">)</span>
<span class="n">node</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_and_remove_objects_to/from_the_scenegraph"></span>
</p>
<h3><span id="Ajouter_et_effacer_des_objets_au.2Fde_graphe_de_sc.C3.A8ne"></span><span class="mw-headline" id="Ajouter_et_effacer_des_objets_au/de_graphe_de_scène">Ajouter et effacer des objets au/de graphe de scène</span></h3>
<p>Ajouter de nouveaux noeuds dans le graphe de scène peut être fait de cette façon. Prenez toujours soin d'ajouter un SoSeparator pour contenir les propriétés de la forme géométrique, les coordonnées et l'information du matériau d'un même objet. L'exemple suivant ajoute une ligne rouge à partir de (0,0,0) à (10,0,0):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="n">sg</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getSceneGraph</span><span class="p">()</span>
<span class="n">co</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">co</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">),</span><span class="n">pts</span><span class="p">)</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>
<span class="n">ma</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">li</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoLineSet</span><span class="p">()</span>
<span class="n">li</span><span class="o">.</span><span class="n">numVertices</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">no</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">co</span><span class="p">)</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
</pre></div>
<p>Pour le supprimer, il suffit de:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">sg</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p><div class="mw-collapsible mw-collapsed toccolours">
<p><span id="Save_the_sceneGraph_in_3_series_of_36_files"></span>
</p>
<h3><span id="Enregistrer_le_graphe_de_sc.C3.A8ne_en_3_s.C3.A9ries_de_36_fichiers"></span><span class="mw-headline" id="Enregistrer_le_graphe_de_scène_en_3_séries_de_36_fichiers">Enregistrer le graphe de scène en 3 séries de 36 fichiers</span></h3>
<p>Affichez l'extrait de code en développant cette section
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">dirname</span> <span class="o">=</span> <span class="s2">"C:/Temp/animation/"</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">36</span>
<span class="n">angle</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">steps</span>

<span class="n">matX</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matX</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsX</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matX</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">matY</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matY</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsY</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matY</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">matZ</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matZ</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsZ</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matZ</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">view</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
<span class="n">cam</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="n">getCameraNode</span><span class="p">()</span>
<span class="n">rotCamera</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="o">*</span><span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>

<span class="c1"># this sets the lookat point to the center of circumsphere of the global bounding box</span>
<span class="n">view</span><span class="o">.</span><span class="n">fitAll</span><span class="p">()</span>

<span class="c1"># the camera's position, i.e. the user's eye point</span>
<span class="n">position</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
<span class="n">distance</span><span class="o">=</span><span class="n">cam</span><span class="o">.</span><span class="n">focalDistance</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>

<span class="c1"># view direction</span>
<span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># this is the point on the screen the camera looks at</span>
<span class="c1"># when rotating the camera we should make this point fix</span>
<span class="n">lookat</span><span class="o">=</span><span class="n">position</span><span class="o">+</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>

<span class="c1"># around x axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsX</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"x-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># around y axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsY</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"y-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># around z axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsZ</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"z-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_custom_widgets_to_the_interface"></span>
</p>
<h3><span id="Ajouter_des_widgets_personnalis.C3.A9s_.C3.A0_l.27interface"></span><span class="mw-headline" id="Ajouter_des_widgets_personnalisés_à_l'interface">Ajouter des widgets personnalisés à l'interface</span></h3>
<p>Vous pouvez créer des widgets personnalisés avec Qt Designer, les transformer en script Python, puis les charger dans l'interface FreeCAD avec PySide.
</p><p>Le code python produit par le compilateur python Ui (l'outil qui convertit les fichiers .ui de qt-designer en code python) généralement codé comme ceci (il est simple, vous pouvez aussi le coder directement en Python):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">myWidget_Ui</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">myWidget</span><span class="p">):</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"my Nice New Widget"</span><span class="p">)</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">())</span><span class="o">.</span><span class="n">expandedTo</span><span class="p">(</span><span class="n">myWidget</span><span class="o">.</span><span class="n">minimumSizeHint</span><span class="p">()))</span> <span class="c1"># sets size of the widget</span>
 
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">myWidget</span><span class="p">)</span> <span class="c1"># creates a label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span> <span class="c1"># sets its size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"label"</span><span class="p">)</span> <span class="c1"># sets its name, so it can be found by name</span>

    <span class="k">def</span> <span class="nf">retranslateUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draftToolbar</span><span class="p">):</span> <span class="c1"># built-in QT function that manages translations of widgets</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">"myWidget"</span><span class="p">,</span> <span class="s2">"My Widget"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">UnicodeUTF8</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">"myWidget"</span><span class="p">,</span> <span class="s2">"Welcome to my new widget!"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">UnicodeUTF8</span><span class="p">))</span>
</pre></div>
<p>Puis, vous devez créer une référence à la fenêtre FreeCAD Qt, lui insérer le widget personnalisé, et transférer le code Ui du widget que nous venons de faire dans le vôtre avec:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span>
<span class="n">FCmw</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">activeWindow</span><span class="p">()</span> <span class="c1"># the active qt window, = the freecad window since we are inside it</span>
<span class="c1"># FCmw = FreeCADGui.getMainWindow() # use this line if the 'addDockWidget' error is declared</span>
<span class="n">myNewFreeCADWidget</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">()</span> <span class="c1"># create a new dckwidget</span>
<span class="n">myNewFreeCADWidget</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">myWidget_Ui</span><span class="p">()</span> <span class="c1"># load the Ui script</span>
<span class="n">myNewFreeCADWidget</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="n">myNewFreeCADWidget</span><span class="p">)</span> <span class="c1"># setup the ui</span>
<span class="n">FCmw</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">,</span><span class="n">myNewFreeCADWidget</span><span class="p">)</span> <span class="c1"># add the widget to the main window</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_a_Tab_to_the_Combo_View"></span>
</p>
<h3><span id="Ajouter_un_onglet_.C3.A0_la_vue_combin.C3.A9e"></span><span class="mw-headline" id="Ajouter_un_onglet_à_la_vue_combinée">Ajouter un onglet à la vue combinée</span></h3>
<p>Le code suivant vous permet d'ajouter un onglet à la <a href="Combo_view.html" title="Combo view/fr">Vue combinée</a>, distinct des onglets "Modèle" et "Tâches" éxistants. Il utilise également le module <code>uic</code> pour charger un fichier d'interface utilisateur directement dans cet onglet.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># create new Tab in ComboView</span>
<span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span><span class="n">QtCore</span>
<span class="c1">#from PySide import uic</span>

<span class="k">def</span> <span class="nf">getMainWindow</span><span class="p">():</span>
   <span class="s2">"returns the main window"</span>
   <span class="c1"># using QtGui.qApp.activeWindow() isn't very reliable because if another</span>
   <span class="c1"># widget than the mainwindow is active (e.g. a dialog) the wrong widget is</span>
   <span class="c1"># returned</span>
   <span class="n">toplevel</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span><span class="o">.</span><span class="n">topLevelWidgets</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">toplevel</span><span class="p">:</span>
       <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">metaObject</span><span class="p">()</span><span class="o">.</span><span class="n">className</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Gui::MainWindow"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span>
   <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"No main window found"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getComboView</span><span class="p">(</span><span class="n">mw</span><span class="p">):</span>
   <span class="n">dw</span><span class="o">=</span><span class="n">mw</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dw</span><span class="p">:</span>
       <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span> <span class="o">==</span> <span class="s2">"Combo View"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">)</span>
       <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span> <span class="o">==</span> <span class="s2">"Python Console"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">)</span>
   <span class="k">raise</span> <span class="ne">Exception</span> <span class="p">(</span><span class="s2">"No tab widget found"</span><span class="p">)</span>

<span class="n">mw</span> <span class="o">=</span> <span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">getComboView</span><span class="p">(</span><span class="n">getMainWindow</span><span class="p">())</span>
<span class="n">tab2</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDialog</span><span class="p">()</span>
<span class="n">tab</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="s2">"A Special Tab"</span><span class="p">)</span>

<span class="c1">#uic.loadUi("/myTaskPanelforTabs.ui",tab2)</span>
<span class="n">tab2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#tab.removeTab(2)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Enable_or_disable_a_window"></span>
</p>
<h3><span id="Activer_ou_d.C3.A9sactiver_une_fen.C3.AAtre"></span><span class="mw-headline" id="Activer_ou_désactiver_une_fenêtre">Activer ou désactiver une fenêtre</span></h3>
<p>Ce script donne la possibilité de manipuler l'interface utilisateur de la <a href="Python_console.html" title="Python console/fr">console Python</a> pour afficher/masquer différents composants dans de l'<a href="Interface.html" title="Interface/fr">interface</a> de FreeCAD tels que:
</p>
<ul><li><a href="Report_view.html" title="Report view/fr">Vue rapport</a></li>
<li><a href="Tree_view.html" title="Tree view/fr">vue en arborescence</a></li>
<li><a href="Property_editor.html" title="Property editor/fr">Éditeur de propriétés</a></li>
<li><a href="Selection_view.html" title="Selection view/fr">Fenêtre de sélection</a></li>
<li><a href="Combo_view.html" title="Combo view/fr">Vue Combinée</a></li>
<li><a href="Python_console.html" title="Python console/fr">console Python</a></li>
<li>draftToolbar</li></ul>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">dws</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">)</span>

<span class="c1"># objectName may be :</span>
<span class="c1"># "Report view"</span>
<span class="c1"># "Tree view"</span>
<span class="c1"># "Property view"</span>
<span class="c1"># "Selection view"</span>
<span class="c1"># "Combo View"</span>
<span class="c1"># "Python console"</span>
<span class="c1"># "draftToolbar"</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dws</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Report view"</span><span class="p">:</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">break</span>

<span class="n">va</span> <span class="o">=</span> <span class="n">dw</span><span class="o">.</span><span class="n">toggleViewAction</span><span class="p">()</span>
<span class="n">va</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>        <span class="c1"># True or False</span>
<span class="n">dw</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>        <span class="c1"># True or False</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Open_a_custom_webpage"></span>
</p>
<h3><span id="Ouvrir_une_page_web_personnalis.C3.A9e"></span><span class="mw-headline" id="Ouvrir_une_page_web_personnalisée">Ouvrir une page web personnalisée</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">WebGui</span>
<span class="n">WebGui</span><span class="o">.</span><span class="n">openBrowser</span><span class="p">(</span><span class="s2">"http://www.example.com"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_HTML_contents_of_an_opened_webpage"></span>
</p>
<h3><span id="Obtenir_le_code_HTML_d.27une_page_Web_ouverte"></span><span class="mw-headline" id="Obtenir_le_code_HTML_d'une_page_Web_ouverte">Obtenir le code HTML d'une page Web ouverte</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span><span class="n">QtWebKit</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">activeWindow</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtWebKit</span><span class="o">.</span><span class="n">QWebFrame</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">unicode</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">toHtml</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">html</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Retrieve_the_coordinates_of_3_selected_points_or_objects"></span>
</p>
<h3><span id="Extraire_les_coordonn.C3.A9es_de_3_points_ou_3_objets_s.C3.A9lectionn.C3.A9s"></span><span class="mw-headline" id="Extraire_les_coordonnées_de_3_points_ou_3_objets_sélectionnés">Extraire les coordonnées de 3 points ou 3 objets sélectionnés</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># the line above to put the accentuated in the remarks</span>
<span class="c1"># If this line is missing, an error will be returned</span>
<span class="c1"># extract and use the coordinates of 3 objects selected</span>
<span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">PartGui</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span><span class="p">,</span> <span class="n">Console</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span> <span class="c1"># " sel " contains the items selected</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span><span class="o">!=</span><span class="mi">3</span> <span class="p">:</span>
  <span class="c1"># If there are no 3 objects selected, an error is displayed in the report view</span>
  <span class="c1"># The \r and \n at the end of line mean return and the newline CR + LF.</span>
  <span class="n">Console</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">"Select 3 points exactly</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">else</span> <span class="p">:</span>
  <span class="n">points</span><span class="o">=</span><span class="p">[]</span>
  <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">BoundBox</span><span class="o">.</span><span class="n">Center</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
    <span class="c1"># display of the coordinates in the report view</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>

  <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="List_all_objects"></span>
</p>
<h3><span class="mw-headline" id="Lister_les_objets">Lister les objets</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span><span class="nn">Draft</span>
<span class="c1"># List all objects of the document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span>
<span class="n">objs</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span>
<span class="c1">#App.Console.PrintMessage(str(objs) + "\n")</span>
<span class="c1">#App.Console.PrintMessage(str(len(FreeCAD.ActiveDocument.Objects)) + " Objects"  + "\n")</span>

<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span>                                             <span class="c1"># list the Name  of the object  (not modifiable)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Label</span>                                            <span class="c1"># list the Label of the object  (modifiable)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">LabelText</span>                                    <span class="c1"># list the LabeText of the text (modifiable)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># Displays the Name the Label and the text</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># Displays the Name and the Label of the object</span>

<span class="c1">#doc.removeObject("Box") # Clears the designated object</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="List_the_dimensions_of_an_object,_given_its_name"></span>
</p>
<h3><span id="Lister_les_dimensions_en_donnant_le_nom_de_l.27objet"></span><span class="mw-headline" id="Lister_les_dimensions_en_donnant_le_nom_de_l'objet">Lister les dimensions en donnant le nom de l'objet</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">MyObjectName</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">:</span> <span class="c1"># replace "MyObjectName" for list</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">edge</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Function_resident_with_the_mouse_click_action"></span>
</p>
<h3><span id="Fonction_r.C3.A9sidente_avec_action_au_clic_de_souris"></span><span class="mw-headline" id="Fonction_résidente_avec_action_au_clic_de_souris">Fonction résidente avec action au clic de souris</span></h3>
<p>Ici avec <b>SelObserver</b> sur un objet selectionné
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># causes an action to the mouse click on an object</span>
<span class="c1"># This function remains resident (in memory) with the function "addObserver(s)"</span>
<span class="c1"># "removeObserver(s) # Uninstalls the resident function</span>
<span class="k">class</span> <span class="nc">SelObserver</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">setPreselection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">):</span>                <span class="c1"># Preselection object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># The part of the object name</span>

    <span class="k">def</span> <span class="nf">addSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">,</span><span class="n">pnt</span><span class="p">):</span>               <span class="c1"># Selection object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"addSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Name of the document</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Name of the object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># The part of the object name</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Coordinates of the object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"______"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">):</span>                <span class="c1"># Remove the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"removeSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>                           <span class="c1"># Set selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"setSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clearSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>                         <span class="c1"># If click on the screen, clear the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"clearSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># If click on another object, clear the previous object</span>
<span class="n">s</span> <span class="o">=</span><span class="n">SelObserver</span><span class="p">()</span>
<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addObserver</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>                       <span class="c1"># install the function mode resident</span>
<span class="c1">#FreeCADGui.Selection.removeObserver(s)                   # Uninstall the resident function</span>
</pre></div>
<p>Autre exemple avec <b>ViewObserver</b> sur un objet selectionné
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
 
<span class="c1">#This class logs any mouse button events. As the registered callback function fires twice for 'down' and</span>
<span class="c1">#'up' events we need a boolean flag to handle this.</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">view</span>
   
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"State"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"DOWN"</span><span class="p">)</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">"Position"</span><span class="p">]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">down</span><span class="p">):</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Clicked on position: ("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">", "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">")</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
           <span class="n">pnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"World coordinates: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
           <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getObjectInfo</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Object info: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Display_the_active_document"></span>
</p>
<h3><span class="mw-headline" id="Afficher_le_document_actif">Afficher le document actif</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">DocObserver</span><span class="p">:</span>                      <span class="c1"># document Observer</span>
    <span class="k">def</span> <span class="nf">slotActivateDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>

<span class="n">obs</span><span class="o">=</span><span class="n">DocObserver</span><span class="p">()</span>
<span class="n">App</span><span class="o">.</span><span class="n">addDocumentObserver</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="c1">#App.removeDocumentObserver(obs)                 # desinstalle la fonction residente</span>
</pre></div>
<p>Pour effacer l'observateur de la mémoire tapez :
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">removeDocumentObserver</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>                 <span class="c1"># desinstalle la fonction residente</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Find/select_all_elements_below_the_cursor"></span>
</p>
<h3><span id="Rechercher_et_s.C3.A9lectionner_tous_les_.C3.A9l.C3.A9ments_sous_le_curseur"></span><span class="mw-headline" id="Rechercher_et_sélectionner_tous_les_éléments_sous_le_curseur">Rechercher et sélectionner tous les éléments sous le curseur</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>

<span class="k">def</span> <span class="nf">mouse_over_cb</span><span class="p">(</span> <span class="n">event_callback</span><span class="p">):</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">event_callback</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
    <span class="n">listObjects</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getObjectsInfo</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">listObjects</span><span class="p">:</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> *** Objects under mouse pointer ***"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">listObjects</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="s2">"Object"</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>


<span class="n">view</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>

<span class="n">mouse_over</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoLocation2Event</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">mouse_over_cb</span> <span class="p">)</span>

<span class="c1"># to remove Callback :</span>
<span class="c1">#view.removeEventCallbackPivy( coin.SoLocation2Event.getClassTypeId(), mouse_over)</span>

<span class="c1">####</span>
<span class="c1">#The easy way is probably to use FreeCAD's selection.</span>
<span class="c1">#FreeCADGui.ActiveDocument.ActiveView.getObjectsInfo(mouse_coords)</span>

<span class="c1">####</span>
<span class="c1">#you get that kind of result :</span>
<span class="c1">#'Document': 'Unnamed', 'Object': 'Box', 'Component': 'Face2', 'y': 8.604081153869629, 'x': 21.0, 'z': 8.553047180175781</span>

<span class="c1">####</span>
<span class="c1">#You can use this data to add your element to FreeCAD's selection :</span>
<span class="c1">#FreeCADGui.Selection.addSelection(FreeCAD.ActiveDocument.Box,'Face2',21.0,8.604081153869629,8.553047180175781)</span>
</pre></div>
<p><a href="#top">En haut</a></p><div class="mw-collapsible mw-collapsed toccolours">
<p><span id="List_the_components_of_an_object"></span>
</p>
<h3><span id="Lister_les_composantes_d.27un_objet"></span><span class="mw-headline" id="Lister_les_composantes_d'un_objet">Lister les composantes d'un objet</span></h3>
<p>Cette fonction répertorie les composants d'un objet et extrait:
</p>
<ul><li>de cet objet, ses coordonnées XYZ,</li>
<li>ses bords et leurs longueurs centre de masse et coordonnées</li>
<li>ses faces et leur centre de masse</li>
<li>ses faces et leurs surfaces et coordonnées</li></ul>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># This function list the components of an object</span>
<span class="c1"># and extract this object its XYZ coordinates,</span>
<span class="c1"># its edges and their lengths center of mass and coordinates</span>
<span class="c1"># its faces and their center of mass</span>
<span class="c1"># its faces and their surfaces and coordinates</span>
<span class="c1"># 8/05/2014</span>

<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span><span class="nn">Part</span>
<span class="k">def</span> <span class="nf">detail</span><span class="p">():</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>   <span class="c1"># Select an object</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>                           <span class="c1"># If there is a selection then</span>
        <span class="n">Vertx</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Edges</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Faces</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">compt_V</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">compt_E</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">compt_F</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">pas</span>    <span class="o">=</span><span class="mi">0</span>
        <span class="n">perimetre</span> <span class="o">=</span> <span class="mf">0.0</span>   
        <span class="n">EdgesLong</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Displays the "Name" and the "Label" of the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Selection &gt; "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"  "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Label</span><span class="p">)</span> <span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">):</span>                                     <span class="c1"># Search the "Edges" and their lengths</span>
            <span class="n">compt_E</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">Edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Edge</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">EdgesLong</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">))</span>
            <span class="n">perimetre</span> <span class="o">+=</span> <span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span>                     <span class="c1"># calculates the perimeter</span>

            <span class="c1"># Displays the "Edge" and its length</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edge"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_E</span><span class="p">)</span><span class="o">+</span><span class="s2">" Length &gt; "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays the "Edge" and its center mass</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edge"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_E</span><span class="p">)</span><span class="o">+</span><span class="s2">" Center &gt; "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="n">num</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="c1"># Displays the coordinates 1</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">" Y1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" Z1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">num</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
            <span class="c1"># Displays the coordinates 2</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">" Y2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" Z2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Perimeter of the form  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perimetre</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> 

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">FacesSurf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">):</span>                                      <span class="c1"># Search the "Faces" and their surface</span>
            <span class="n">compt_F</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">Faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Face</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">FacesSurf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span><span class="p">))</span>

            <span class="c1"># Displays 'Face' and its surface</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Surface "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its CenterOfMass</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Center  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its Coordinates</span>
            <span class="n">FacesCoor</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">fco</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">f0</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>                        <span class="c1"># Search the Vertexes of the face</span>
                <span class="n">fco</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>

            <span class="c1"># Displays 'Face' and its Coordinates</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Coordinate"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FacesCoor</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its Volume</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Volume  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Displays the total surface of the form</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Surface of the form    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Displays the total Volume of the form</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Volume  of the form    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">detail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><a href="#top">En haut</a></p>
<p><span id="List_the_PropertiesList"></span>
</p>
<h3><span class="mw-headline" id="Lister_les_PropertiesList">Lister les PropertiesList</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveObject</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">PropertiesList</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">op</span><span class="p">:</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Property: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span> <span class="s2">" Value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Add_a_single_Property_Comment"></span>
</p>
<h3><span id="Ajouter_un_seul_commentaire_de_propri.C3.A9t.C3.A9"></span><span class="mw-headline" id="Ajouter_un_seul_commentaire_de_propriété">Ajouter un seul commentaire de propriété</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span><span class="s2">"GComment"</span><span class="p">,</span><span class="s2">"Draft"</span><span class="p">,</span><span class="s2">"Font name"</span><span class="p">)</span><span class="o">.</span><span class="n">GComment</span> <span class="o">=</span> <span class="s2">"Comment here"</span>
<span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<div class="mw-collapsible mw-collapsed toccolours">
<p><span id="Search_and_data_extraction"></span>
</p>
<h3><span id="Rechercher_et_extraire_des_donn.C3.A9es"></span><span class="mw-headline" id="Rechercher_et_extraire_des_données">Rechercher et extraire des données</span></h3>
<p>Exemple de recherche et décodage des informations d'un objet
</p><p>Chaque section est séparée par des dièses "############" vous pouvez les copier directement dans la console, les utiliser dans vos macro ou utiliser la macro complète. La description de la commande est dans le commentaire.
</p><p>L'affichage se fait dans la "vue rapport" (Menu Affichage → Vues → Vue rapport)
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
 
<span class="c1"># Exemples de recherche et de decodage d'informations sur un objet</span>
<span class="c1"># Chaque section peut etre copiee directement dans la console Python ou dans une macro ou utilisez la macro tel quel</span>
<span class="c1"># Certaines commandes se repetent seul l'approche est differente</span>
<span class="c1"># L'affichage se fait dans la Vue rapport : Menu Affichage &gt; Vues &gt; Vue rapport</span>
<span class="c1">#</span>
<span class="c1"># Examples of research and decoding information on an object</span>
<span class="c1"># Each section can be copied directly into the Python console, or in a macro or uses this macro</span>
<span class="c1"># Certain commands as repeat alone approach is different</span>
<span class="c1"># Displayed in Report view: View &gt; Views &gt; report view</span>
<span class="c1">#</span>
<span class="c1"># rev:30/08/2014:29/09/2014:17/09/2015 22/11/2019 30/12/2022</span>
 
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">import</span> <span class="nn">DraftVecUtils</span><span class="o">,</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">Part</span>

<span class="c1">##################################################################################</span>
<span class="c1"># info in the object</span>

<span class="n">box</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s1">'Box'</span><span class="p">)</span>                                 <span class="c1"># object </span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>                                                           <span class="c1"># all options disponible in the object</span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>                                                           <span class="c1"># object name</span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">Content</span><span class="p">)</span>                                                        <span class="c1"># content of the object in XML format</span>
<span class="c1">##################################################################################</span>
<span class="c1">#</span>
<span class="c1"># example of using the information listed</span>
<span class="c1">#</span>
<span class="c1"># search the name of the active document </span>
<span class="n">mydoc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">Name</span>                                     <span class="c1"># Name of active Document</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Active docu    : "</span><span class="o">+</span><span class="p">(</span><span class="n">mydoc</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the document name and the name of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_FullName</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">FullName</span>                                         <span class="c1"># file Name and Name of the object selected</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_FullName: "</span><span class="o">+</span><span class="p">(</span><span class="n">object_FullName</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the label of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_Label</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Label</span>                                               <span class="c1"># Label of the object (modifiable)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_Label   : "</span><span class="o">+</span><span class="p">(</span><span class="n">object_Label</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1">#TypeID object FreeCAD selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"sel            : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># sel[0] first object selected</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the Name of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_Name</span>  <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Name</span>                                                <span class="c1"># Name of the object (not modifiable)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_Name    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">object_Name</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the Sub Element Name of the sub object selected</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SubElement</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>                    <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">element_</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                           <span class="c1"># name of 1 element selected</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"elementSelec   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">element_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="k">except</span><span class="p">:</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="c1">##################################################################################</span>

<span class="c1"># give the length of the subObject selected</span>
<span class="n">SubElementLength</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span> <span class="c1"># sub element or element name with getSelectionEx()</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"SubElement length: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SubElementLength</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span><span class="c1"># length</span>
<span class="c1">##################################################################################</span>

<span class="c1"># list the edges and the coordinates of the object[0] selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">):</span>                                   <span class="c1"># list all Edges</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edges n : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X1             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1"># coordinate XYZ first point</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Y1             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1">#</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Z1             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X2             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># coordinate XYZ second point</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Y2             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1">#</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Z2             : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1">#</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>    
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>    
<span class="c1">##################################################################################</span>

<span class="c1"># give the sub element name, length, coordinates, BoundBox, BoundBox.Center, Area of the SubObjects selected</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SubElement</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>                                        <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">subElementName</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                     <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subElementName : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subElementName</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectLength</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span>                  <span class="c1"># sub element Length</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectLength: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectLength</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectX1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span>         <span class="c1"># sub element coordinate X1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_X1   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectX1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">subObjectY1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span>         <span class="c1"># sub element coordinate Y1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Y1   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectY1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">subObjectZ1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span>         <span class="c1"># sub element coordinate Z1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Z1   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectZ1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">subObjectX2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span>     <span class="c1"># sub element coordinate X2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_X2   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectX2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">subObjectY2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span>     <span class="c1"># sub element coordinate Y2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Y2   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectY2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">subObjectZ2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span>     <span class="c1"># sub element coordinate Z2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Z2   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectZ2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            

    <span class="n">subObjectBoundBox</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">BoundBox</span>              <span class="c1"># sub element BoundBox coordinates</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectBBox  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectBoundBox</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectBoundBoxCenter</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">BoundBox</span><span class="o">.</span><span class="n">Center</span> <span class="c1"># sub element BoundBoxCenter</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectBBoxCe: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectBoundBoxCenter</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">surfaceFace</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span>                        <span class="c1"># Area of the face selected</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"surfaceFace    : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">surfaceFace</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="c1">##################################################################################</span>

<span class="c1"># give the area of the object</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">surface</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Area</span>                                               <span class="c1"># Area object complete</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"surfaceObjet   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the Center Of Mass and coordinates of the object</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">CenterOfMass</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">CenterOfMass</span>                                  <span class="c1"># Center of Mass of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMass   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassX  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>   <span class="c1"># coordinates [0]=X [1]=Y [2]=Z</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassY  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>   <span class="c1"># or CenterOfMass.x, CenterOfMass.y, CenterOfMass.z</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassZ  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># list the all faces of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">):</span>                                   <span class="c1"># List alles faces of the object</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face           : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"Face</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the volume of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">volume_</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Volume</span>                                             <span class="c1"># Volume of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"volume_        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">volume_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
 
<span class="c1"># give the BoundBox of the oject selected all type</span>
<span class="n">objs</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>                                                         <span class="c1"># serch the object type</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Shape"</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Mesh"</span><span class="p">):</span>      <span class="c1"># upgrade with wmayer thanks #http://forum.freecadweb.org/viewtopic.php?f=13&amp;t=22331</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Mesh</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Points"</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Points</span>

<span class="n">boundBox_</span><span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">BoundBox</span>                                                     <span class="c1"># BoundBox of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBox_      : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBox_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>         <span class="c1"># </span>
 
<span class="n">boundBoxLX</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XLength</span>                                          <span class="c1"># Length x boundBox rectangle</span>
<span class="n">boundBoxLY</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YLength</span>                                          <span class="c1"># Length y boundBox rectangle</span>
<span class="n">boundBoxLZ</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZLength</span>                                          <span class="c1"># Length z boundBox rectangle</span>

<span class="n">boundBoxXMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XMin</span>                                             <span class="c1"># coordonate XMin</span>
<span class="n">boundBoxYMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YMin</span>                                             <span class="c1"># coordonate YMin</span>
<span class="n">boundBoxZMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZMin</span>                                             <span class="c1"># coordonate ZMin</span>
<span class="n">boundBoxXMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XMax</span>                                             <span class="c1"># coordonate XMax</span>
<span class="n">boundBoxYMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YMax</span>                                             <span class="c1"># coordonate YMax</span>
<span class="n">boundBoxZMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZMax</span>                                             <span class="c1"># coordonate ZMax</span>

<span class="n">boundBoxDiag</span><span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">DiagonalLength</span>                                    <span class="c1"># Diagonal Length boundBox rectangle</span>
<span class="n">boundBoxCenter</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">Center</span>                                         <span class="c1"># BoundBox Center</span>
<span class="n">boundBoxCenterOfGravity</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">CenterOfGravity</span>                       <span class="c1"># BoundBox CenterOfGravity</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLX     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLX</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLY     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLZ     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLZ</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxXMin   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxXMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxYMin   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxYMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxZMin   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxZMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxXMax   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxXMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxYMax   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxYMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxZMax   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxZMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxDiag   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxDiag</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxCenter : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxCenter</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBox Center of Gravity : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxCenterOfGravity</span> <span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1">##################################################################################</span>

<span class="c1"># give the complete placement of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span>                                               <span class="c1"># Placement Vector XYZ and Yaw-Pitch-Roll</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement      : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement Base (xyz) of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span>                                          <span class="c1"># Placement Vector XYZ</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"PlacementBase  : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
 
<span class="c1"># give the placement Base (xyz) of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">oripl_X</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                        <span class="c1"># decode Placement X</span>
<span class="n">oripl_Y</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                        <span class="c1"># decode Placement Y</span>
<span class="n">oripl_Z</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                                        <span class="c1"># decode Placement Z</span>

<span class="c1"># same </span>
<span class="c1">#oripl_X = sel[0].Placement.Base.x                                        # decode Placement X</span>
<span class="c1">#oripl_Y = sel[0].Placement.Base.y                                        # decode Placement Y</span>
<span class="c1">#oripl_Z = sel[0].Placement.Base.z                                        # decode Placement Z</span>
 
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_X        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_X</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_Y        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_Y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_Z        : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_Z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement rotation of the object selected (x, y, z, angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">rotation</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span>                                      <span class="c1"># decode Placement Rotation</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"rotation              : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement rotation of the object selected (x, y, z, angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span>                                      <span class="c1"># decode Placement Rotation other method</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement Rot         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation of the object selected (angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span>                                <span class="c1"># decode Placement Rotation Angle</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement Rot Angle   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation.Q of the object selected (angle rotation in Radian) for convert: math.degrees(angleInRadian)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">Rot</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span>                                       <span class="c1"># Placement Rotation Q</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot           : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
 
<span class="n">Rot_0</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation Q</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_0         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_0</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_0</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>
 
<span class="n">Rot_1</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 1</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_1         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_1</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_1</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>
 
<span class="n">Rot_2</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 2</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_2         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_2</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_2</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>

<span class="n">Rot_3</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 3</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_3         : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_3</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">Rot_Axis</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Axis</span>                                 <span class="c1"># Placement Rotation .Axis</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_Axis      : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_Axis</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
 
<span class="n">Rot_Angle</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span>                               <span class="c1"># Placement Rotation .Angle</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_Angle     : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_Angle</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation of the object selected toEuler (angle rotation in degrees)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                             <span class="c1"># select object with getSelection()</span>
<span class="n">angle</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()</span>                   <span class="c1"># angle Euler</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Angle          : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Yaw</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Yaw (Z) lacet (alpha)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Yaw            : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Yaw</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Pitch</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Pitch (Y) tangage (beta)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Pitch          : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Pitch</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Roll</span>  <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Roll (X) roulis (gamma)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Roll           : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Roll</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">rot</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">()</span>
<span class="n">rot</span><span class="o">.</span><span class="n">setYawPitchRoll</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Angle: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Angle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Axis: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Axis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"RawAxis: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">RawAxis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"YawPitchRoll: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">getYawPitchRoll</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation: "</span><span class="p">,</span> <span class="n">rot</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Quaternion: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>

<span class="c1">##################################################################################</span>

<span class="c1"># find Midpoint of the selected line</span>
<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">DraftGeomUtils</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
<span class="n">vecteur</span> <span class="o">=</span> <span class="n">DraftGeomUtils</span><span class="o">.</span><span class="n">findMidpoint</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>              <span class="c1"># find Midpoint</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="n">vecteur</span><span class="p">)</span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makePoint</span><span class="p">(</span><span class="n">vecteur</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
</pre></div>
</div>
</div>
<p><a href="#top">En haut</a></p>
<p><span id="Manual_search_of_an_element_with_label"></span>
</p>
<h3><span id="Rechercher_manuellement_un_.C3.A9l.C3.A9ment_par_son_label"></span><span class="mw-headline" id="Rechercher_manuellement_un_élément_par_son_label">Rechercher manuellement un élément par son label</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># Extract the coordinate X,Y,Z and Angle giving the label (here "Cylindre")</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.x       : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.y       : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.z       : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.Angle   : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
</pre></div>
<p><b>Remarque:</b> les angles sont généralement affichés en radian. Pour les convertir:
</p>
<ol><li>angle en degré vers radian:
<ul><li>Angle en radian = <b>pi * (angle en degré) / 180</b></li>
<li>Angle en radian = math.radians(angle en degré)</li></ul></li>
<li>angle en radian vers degré :
<ul><li>Angle en degré = <b>180 * (angle en radian) / pi</b></li>
<li>Angle en degré = math.degrees(angle en radian)</li></ul></li></ol>
<p><a href="#top">En haut</a></p>
<p><span id="Cartesian_coordinates"></span>
</p>
<h3><span id="Coordonn.C3.A9es_cart.C3.A9siennes"></span><span class="mw-headline" id="Coordonnées_cartésiennes">Coordonnées cartésiennes</span></h3>
<p>Ce code affiche les coordonnées cartésiennes de l'objet sélectionné.
</p><p>Changer la valeur "numberOfPoints" si vous voulez plus ou moins de précision
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">numberOfPoints</span> <span class="o">=</span> <span class="mi">100</span>                                                         <span class="c1"># Decomposition number (or precision you can change)</span>
<span class="n">selectedEdge</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># select one element</span>
<span class="n">points</span>  <span class="o">=</span> <span class="n">selectedEdge</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">numberOfPoints</span><span class="p">)</span>                            <span class="c1"># discretize the element</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>                                                             <span class="c1"># list and display the coordinates</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="s2">" X"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</pre></div>
<p>Autre méthode d'affichage "Int" et "Float"
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">c</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>        <span class="c1"># create the circle</span>
<span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>                     <span class="c1"># display the shape</span>

<span class="c1"># slice accepts two arguments:</span>
<span class="c1">#+ the normal of the cross section plane</span>
<span class="c1">#+ the distance from the origin to the cross section plane. Here you have to find a value so that the plane intersects your object</span>
<span class="n">s</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># </span>

<span class="c1"># here the result is a single wire</span>
<span class="c1"># depending on the source object this can be several wires</span>
<span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># if you only need the vertexes of the shape you can use</span>
<span class="n">v</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>
    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span>

<span class="c1"># but you can also sub-sample the section to have a certain number of points (int) ...</span>
<span class="n">p1</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p1</span><span class="p">:</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>                                             <span class="c1"># Vector()</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">ii</span><span class="p">,</span> <span class="s2">": X:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">z</span> <span class="p">)</span>       <span class="c1"># Vector decode</span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makeWire</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>    <span class="c1"># to see the difference accuracy (20)</span>

<span class="c1">## uncomment to use</span>
<span class="c1">#import Draft</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # first transform the DWire in Wire         "downgrade"</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # second split the Wire in single objects   "downgrade"</span>
<span class="c1">#</span>
<span class="c1">##Draft.upgrade(FreeCADGui.Selection.getSelection(),delete=True) # to attach lines contiguous SELECTED use "upgrade"</span>


<span class="c1"># ... or define a sampling distance (float)</span>
<span class="n">p2</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p2</span><span class="p">:</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>                                             <span class="c1"># Vector()</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">ii</span><span class="p">,</span> <span class="s2">": X:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">z</span> <span class="p">)</span>       <span class="c1"># Vector decode </span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makeWire</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># to see the difference accuracy (0.5)</span>

<span class="c1">## uncomment to use</span>
<span class="c1">#import Draft</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # first transform the DWire in Wire         "downgrade"</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # second split the Wire in single objects   "downgrade"</span>
<span class="c1">#</span>
<span class="c1">##Draft.upgrade(FreeCADGui.Selection.getSelection(),delete=True) # to attach lines contiguous SELECTED use "upgrade"</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Select_all_objects_in_the_document"></span>
</p>
<h3><span id="S.C3.A9lectionner_tous_les_objets_du_document"></span><span class="mw-headline" id="Sélectionner_tous_les_objets_du_document">Sélectionner tous les objets du document</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span> <span class="p">)</span>                               <span class="c1"># display the object Name</span>
    <span class="n">objName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">objName</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>                 <span class="c1"># select the object</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Select_a_face_of_an_object_by_Name_object_and_Face_number"></span>
</p>
<h3><span id="S.C3.A9lectionner_une_face_d.27un_objet_par_le_nom_de_l.27objet_et_num.C3.A9ro_de_la_face"></span><span class="mw-headline" id="Sélectionner_une_face_d'un_objet_par_le_nom_de_l'objet_et_numéro_de_la_face">Sélectionner une face d'un objet par le nom de l'objet et numéro de la face</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># select one face of the object</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">Draft</span>
<span class="n">App</span><span class="o">=</span><span class="n">FreeCAD</span>
<span class="n">nameObject</span> <span class="o">=</span> <span class="s2">"Box"</span>                             <span class="c1"># objet</span>
<span class="n">faceSelect</span> <span class="o">=</span> <span class="s2">"Face3"</span>                           <span class="c1"># face to selection</span>
<span class="n">loch</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nameObject</span><span class="p">)</span>  <span class="c1"># objet</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>                 <span class="c1"># clear all selection</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">loch</span><span class="p">,</span><span class="n">faceSelect</span><span class="p">)</span>    <span class="c1"># select the face specified</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>
<span class="c1">#Draft.makeFacebinder(s)                       #</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_Face_(r.Q)"></span>
</p>
<h3><span id="Obtenir_le_vecteur_normal_d.27une_face_d.27un_objet_par_le_nom_de_l.27objet_et_num.C3.A9ro_de_la_face_.28r.Q.29"></span><span class="mw-headline" id="Obtenir_le_vecteur_normal_d'une_face_d'un_objet_par_le_nom_de_l'objet_et_numéro_de_la_face_(r.Q)">Obtenir le vecteur normal d'une face d'un objet par le nom de l'objet et numéro de la face (r.Q)</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">## normal of a face by giving the number of the face and the name of the object (rotation Q with yL, uV) = (App.Vector (x, y, z), angle))</span>
<span class="c1">## normal d'une face en donnant le numero de la face et le nom de l'objet (rotation Q avec yL, uV) = (App.Vector(x, y, z),angle))</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Vector</span>

<span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># number of the face searched (begin 0, 1, 2, 3 .....)</span>
<span class="n">nomObjet</span>    <span class="o">=</span> <span class="s2">"Box"</span>  <span class="c1"># object name</span>
<span class="n">yL</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">yL</span><span class="p">)</span>

<span class="n">nv</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">direction</span> <span class="o">=</span> <span class="n">yL</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">nv</span> <span class="o">+</span> <span class="n">yL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Direction  : "</span><span class="p">,</span><span class="n">direction</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">direction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation   : "</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation Q : "</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_of_Face"></span>
</p>
<h3><span id="Obtenir_le_vecteur_normal_d.27une_face_d.27un_objet_par_le_nom_de_l.27objet_et_num.C3.A9ro_de_la_face"></span><span class="mw-headline" id="Obtenir_le_vecteur_normal_d'une_face_d'un_objet_par_le_nom_de_l'objet_et_numéro_de_la_face">Obtenir le vecteur normal d'une face d'un objet par le nom de l'objet et numéro de la face</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># number of the face searched (begin 0, 1, 2, 3 .....)</span>
<span class="n">nomObjet</span>    <span class="o">=</span> <span class="s2">"Box"</span>   <span class="c1"># object name</span>
<span class="n">normal</span>      <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numero_Face</span><span class="p">),</span> <span class="s2">" : "</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_normal_vector_of_an_object_selected_and_number_of_Face"></span>
</p>
<h3><span id="Obtenir_le_vecteur_normal_d.27un_objet_s.C3.A9lectionn.C3.A9_et_le_num.C3.A9ro_de_la_face"></span><span class="mw-headline" id="Obtenir_le_vecteur_normal_d'un_objet_sélectionné_et_le_numéro_de_la_face">Obtenir le vecteur normal d'un objet sélectionné et le numéro de la face</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">## normal of a face by giving the number of the face of the selected object</span>
<span class="n">selectionObjects</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>     
<span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">3</span>    <span class="c1"># numero de la face recherchee</span>
<span class="n">normal</span> <span class="o">=</span> <span class="n">selectionObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
<span class="c1"># selectionne la face numerotee</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">selectionObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numero_Face</span><span class="p">))</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_normal_vector_on_the_surface"></span>
</p>
<h3><span class="mw-headline" id="Obtenir_le_vecteur_normal_sur_une_surface">Obtenir le vecteur normal sur une surface</span></h3>
<p>Cet exemple montre comment trouver le vecteur normal() d'une face en cherchant les paramètres uv d'un point sur la surface et utiliser les paramètres u, v pour trouver le vecteur normal()
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   <span class="n">ss</span><span class="o">=</span><span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="c1">#SubObjects[0] is the edge list</span>
   <span class="n">points</span>  <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="c1">#points on the surface edge, </span>
             <span class="c1">#this example just use points on the edge for example. </span>
             <span class="c1">#However point is not necessary on the edge, it can be anywhere on the surface. </span>
   <span class="n">face</span><span class="o">=</span><span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
   <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
      <span class="n">pt</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="c1">#a point on the surface edge</span>
      <span class="n">uv</span><span class="o">=</span><span class="n">face</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="c1"># find the surface u,v parameter of a point on the surface edge</span>
      <span class="n">u</span><span class="o">=</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">v</span><span class="o">=</span><span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">normal</span><span class="o">=</span><span class="n">face</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="c1">#use u,v to find normal vector</span>
      <span class="nb">print</span><span class="p">(</span> <span class="n">normal</span><span class="p">)</span>
      <span class="n">line</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">((</span><span class="n">pp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">normal</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">normal</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">normal</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
      <span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_normal_vector_of_the_face_and_create_a_line_at_the_point_mouse_clicked"></span>
</p>
<h3><span id="Cr.C3.A9e_une_ligne_sur_la_normale_de_la_face_au_point_cliqu.C3.A9_par_la_souris"></span><span class="mw-headline" id="Crée_une_ligne_sur_la_normale_de_la_face_au_point_cliqué_par_la_souris">Crée une ligne sur la normale de la face au point cliqué par la souris</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span> <span class="k">as</span> <span class="nn">Gui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">openTransaction</span><span class="p">(</span><span class="s2">"Tyty"</span><span class="p">)</span>    <span class="c1"># memorise les actions (avec annuler restore)</span>
<span class="n">selectedFace</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pointClick</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">PickedPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">########## section direction</span>
<span class="n">plr</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">yL</span> <span class="o">=</span> <span class="n">pointClick</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">selectedFace</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">yL</span><span class="p">)</span>
<span class="n">nv</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">selectedFace</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nv</span><span class="p">)</span>
<span class="n">plr</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">Q</span>
<span class="n">plr</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">pointClick</span>
<span class="c1">########## section direction</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">make_wire</span><span class="p">([</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">)]</span> <span class="p">)</span>    <span class="c1"># create line</span>
<span class="n">line</span><span class="o">.</span><span class="n">Placement</span><span class="o">=</span><span class="n">plr</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">"Direction (radian) : "</span><span class="p">,</span><span class="n">direction</span> <span class="p">)</span>    <span class="c1"># direction in radian</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Get_the_normal_vector_of_a_surface_from_a_STL_file"></span>
</p>
<h3><span id="Obtenir_le_vecteur_normal_d.27une_surface_.C3.A0_partir_d.27un_fichier_STL"></span><span class="mw-headline" id="Obtenir_le_vecteur_normal_d'une_surface_à_partir_d'un_fichier_STL">Obtenir le vecteur normal d'une surface à partir d'un fichier STL</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">getNormal</span><span class="p">(</span><span class="n">cb</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span> <span class="o">==</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoButtonEvent</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">getPickedPoint</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pp</span><span class="p">:</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getNormal</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">getDetail</span><span class="p">(),</span> <span class="s2">"SoFaceDetail"</span><span class="p">)</span><span class="o">.</span><span class="n">getFaceIndex</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Normal: </span><span class="si">{}</span><span class="s2">, Face index: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vec</span><span class="p">),</span> <span class="n">index</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="n">meth</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">getNormal</span><span class="p">)</span>
</pre></div>
<p>Vous avez terminé et voulez quitter : 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">removeEventCallbackPivy</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">meth</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Create_one_object_to_the_position_of_the_Camera"></span>
</p>
<h3><span id="Cr.C3.A9er_un_objet_dans_la_position_de_la_cam.C3.A9ra"></span><span class="mw-headline" id="Créer_un_objet_dans_la_position_de_la_caméra">Créer un objet dans la position de la caméra</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># create one object of the position to camera with "getCameraOrientation()"</span>
<span class="c1"># the object is still facing the screen</span>
<span class="kn">import</span> <span class="nn">Draft</span>

<span class="n">plan</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraOrientation</span><span class="p">()</span>
<span class="n">plan</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="c1">###### extract data</span>
<span class="n">a</span>    <span class="o">=</span> <span class="s2">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plan</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"0123456789e.- "</span><span class="p">):</span>
        <span class="n">a</span><span class="o">+=</span><span class="n">i</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
<span class="c1">####### extract data</span>

<span class="c1">#print( a)</span>
<span class="c1">#print( a[0])</span>
<span class="c1">#print( a[1])</span>
<span class="c1">#print( a[2])</span>
<span class="c1">#print( a[3])</span>

<span class="n">xP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">yP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">zP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">pl</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">xP</span><span class="p">,</span><span class="n">yP</span><span class="p">,</span><span class="n">zP</span><span class="p">,</span><span class="n">qP</span><span class="p">)</span>         <span class="c1"># rotation of object</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1"># here coordinates XYZ of Object</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># create rectangle</span>
<span class="c1">#rec = Draft.makeCircle(radius=5,placement=pl,face=False,support=None)                   # create circle</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">rec</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
</pre></div>
<p>Ici le même code simplifié
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraOrientation</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Read_And_write_one_Expression"></span>
</p>
<h3><span id="Lire_et_.C3.A9crire_une_Expression"></span><span class="mw-headline" id="Lire_et_écrire_une_Expression">Lire et écrire une Expression</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span>

<span class="n">pl</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeCircle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>    <span class="c1"># create circle</span>

<span class="nb">print</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">PropertiesList</span> <span class="p">)</span>                                                  <span class="c1"># properties disponible in the obj</span>

<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'Radius'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'2mm'</span><span class="p">)</span>                    <span class="c1"># modify the radius</span>
<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'Placement.Base.x'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'10mm'</span><span class="p">)</span>         <span class="c1"># modify the placement </span>
<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'FirstAngle'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'90'</span><span class="p">)</span>                 <span class="c1"># modify the first angle</span>
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>

<span class="n">expressions</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ExpressionEngine</span>                                         <span class="c1"># read the expression list</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">expressions</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>                                                      <span class="c1"># list and separate the data expression</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">" = "</span><span class="p">,</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Create_a_Sketch_on_a_Surface_in_PartDesign"></span>
</p>
<h3><span id="Cr.C3.A9er_une_esquisse_sur_une_surface_dans_PartDesign"></span><span class="mw-headline" id="Créer_une_esquisse_sur_une_surface_dans_PartDesign">Créer une esquisse sur une surface dans PartDesign</span></h3>
<p>Cet extrait de code peut être utile si vous souhaitez créer une esquisse sur une surface dans PartDesign à partir d'une macro.
Notez que ce corps peut être Aucun si aucun corps actif n'est sélectionné et que la sélection peut être vide.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">body</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getActiveObject</span><span class="p">(</span><span class="s1">'pdbody'</span><span class="p">)</span>
<span class="n">first_selection</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">first_selection</span><span class="o">.</span><span class="n">Object</span>
<span class="n">face_name</span> <span class="o">=</span> <span class="n">first_selection</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">sketch</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Sketcher::SketchObject'</span><span class="p">,</span><span class="s1">'MySketch'</span><span class="p">)</span>
<span class="n">body</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
<span class="n">sketch</span><span class="o">.</span><span class="n">MapMode</span> <span class="o">=</span> <span class="s1">'FlatFace'</span>
<span class="n">sketch</span><span class="o">.</span><span class="n">Support</span> <span class="o">=</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">face_name</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="How_to_Simulate_a_Mouse_Click_at_a_given_Coordinate"></span>
</p>
<h3><span id="Comment_simuler_un_clic_de_souris_sur_une_coordonn.C3.A9e_donn.C3.A9e"></span><span class="mw-headline" id="Comment_simuler_un_clic_de_souris_sur_une_coordonnée_donnée">Comment simuler un clic de souris sur une coordonnée donnée</span></h3>
<p>La position est relative au widget GL. Voir <a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=22&amp;t=44008" rel="nofollow">fil du forum</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span>

<span class="n">mw</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QOpenGLWidget</span><span class="p">)</span>
<span class="n">me</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonRelease</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">sendEvent</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="n">me</span><span class="p">)</span>
</pre></div>
<p>Si vous avez un point 3d et que vous voulez obtenir le point 2d sur le widget opengl, alors utilisez ceci: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
<span class="n">point3d</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">point2d</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getPointOnScreen</span><span class="p">(</span><span class="n">point3d</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">coordX</span> <span class="o">=</span> <span class="n">point2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coordY</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">me</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonRelease</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">coordX</span><span class="p">,</span><span class="n">coordY</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="How_to_create_a_face_with_holes_using_Python_API"></span>
</p>
<h3><span id="Comment_cr.C3.A9er_une_face_avec_des_trous_.C3.A0_l.27aide_de_l.27API_Python"></span><span class="mw-headline" id="Comment_créer_une_face_avec_des_trous_à_l'aide_de_l'API_Python">Comment créer une face avec des trous à l'aide de l'API Python</span></h3>
<p>Cet extrait montre comment créer une face avec des trous à l'aide de l'API Python. Voir <a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=22&amp;t=56308" rel="nofollow">fil du forum</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">Part</span>

<span class="c1"># Create poles that will define the Face</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="n">bs</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">BSplineCurve</span><span class="p">()</span>
<span class="n">bs</span><span class="o">.</span><span class="n">buildFromPoles</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># True makes this periodic/closed</span>

<span class="c1"># Make the Face from the curve</span>
<span class="n">myFace</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeFilledFace</span><span class="p">([</span><span class="n">bs</span><span class="o">.</span><span class="n">toShape</span><span class="p">()])</span>

<span class="c1"># Create geometry for holes that will be cut in the surface</span>
<span class="n">hole0</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Geom2d</span><span class="o">.</span><span class="n">Circle2d</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">hole1</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Geom2d</span><span class="o">.</span><span class="n">Circle2d</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">edge0</span> <span class="o">=</span> <span class="n">hole0</span><span class="o">.</span><span class="n">toShape</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
<span class="n">edge1</span> <span class="o">=</span> <span class="n">hole1</span><span class="o">.</span><span class="n">toShape</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
<span class="n">wireb</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">bs</span><span class="o">.</span><span class="n">toShape</span><span class="p">())</span>
<span class="n">wire0</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
<span class="n">wire1</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">edge1</span><span class="p">)</span>

<span class="c1"># Cut holes in the face</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">cutHoles</span><span class="p">([</span><span class="n">wire0</span><span class="p">])</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>  <span class="c1"># This is required</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">cutHoles</span><span class="p">([</span><span class="n">wire1</span><span class="p">])</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<p><span id="Close_and_restart_FreeCAD"></span>
</p>
<h3><span id="Fermer_et_red.C3.A9marrer_FreeCAD"></span><span class="mw-headline" id="Fermer_et_redémarrer_FreeCAD">Fermer et redémarrer FreeCAD</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span> 
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>

<span class="k">def</span> <span class="nf">restart_freecad</span><span class="p">():</span>
    <span class="sd">"""Shuts down and restarts FreeCAD"""</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">arguments</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">():</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QProcess</span><span class="o">.</span><span class="n">startDetached</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">applicationFilePath</span><span class="p">(),</span> <span class="n">args</span>
        <span class="p">)</span>
</pre></div>
<p><a href="#top">En haut</a></p>
<h2><span class="mw-headline" id="Coin3D">Coin3D</span></h2>
<p>Voir <a href="Coin3d_snippets.html" title="Coin3d snippets/fr">Bouts de codes Coin3d</a>
</p>
<p><a href="#top">En haut</a></p>
<p><span id="Related"></span>
</p>
<h2><span class="mw-headline" id="En_relation">En relation</span></h2>
<ul><li><a href="Scripted_objects.html" title="Scripted objects/fr">Objets crées par script</a></li>
<li><a href="Macros.html" title="Macros/fr">Macros</a></li>
<li><a href="Topological_data_scripting.html" title="Topological data scripting/fr">Script de données topologiques</a></li></ul>
<p><a href="#top">En haut</a></p>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
<div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Power_user_hub.png"><img decoding="async" height="24" src="../File/Power_user_hub.png" srcset="/images/thumb/8/8f/Power_user_hub.png/36px-Power_user_hub.png 1.5x, /images/thumb/8/8f/Power_user_hub.png/48px-Power_user_hub.png 2x" width="24"/></a></span> <a href="Power_users_hub.html" title="Power users hub/fr">Hub utilisateurs expérimentés</a>
<div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>Scripts FreeCAD :</b> <a href="Python.html" title="Python/fr">Python</a>, <a href="Introduction_to_Python.html" title="Introduction to Python/fr">Introduction à Python</a>, <a href="Python_scripting_tutorial.html" title="Python scripting tutorial/fr">Tutoriel sur les scripts Python</a>, <a href="FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/fr">Débuter avec les scripts</a></li></ul>
<hr/>
<ul><li><b>Modules :</b> <a href="Builtin_modules.html" title="Builtin modules/fr">Modules intégrés</a>, <a href="Units.html" title="Units/fr">Unités</a>, <a href="Quantity.html" title="Quantity/fr">Quantity</a></li>
<li><b>Ateliers :</b> <a href="Workbench_creation.html" title="Workbench creation/fr">Création d'atelier</a>, <a href="Gui_Command.html" title="Gui Command/fr">Commands Gui</a>, <a href="Command.html" title="Command/fr">Les commandes</a>, <a href="Installing_more_workbenches.html" title="Installing more workbenches/fr">Installer des ateliers supplémentaires</a></li>
<li><b>Maillages et objets Parts :</b> <a href="Mesh_Scripting.html" title="Mesh Scripting/fr">Scripts Mesh</a>, <a href="Topological_data_scripting.html" title="Topological data scripting/fr">Script de données topologiques</a>, <a href="Mesh_to_Part.html" title="Mesh to Part/fr">Conversion objet Mesh en Part</a>, <a href="PythonOCC.html" title="PythonOCC/fr">PythonOCC</a></li></ul>
<hr/>
<ul><li><b>Objets paramétriques :</b> <a href="Scripted_objects.html" title="Scripted objects/fr">Objets créés par script</a>, <a href="Viewprovider.html" title="Viewprovider/fr">Viewproviders</a> <small>(<a href="Custom_icon_in_tree_view.html" title="Custom icon in tree view/fr">Icône personnalisée dans l'arborescence</a>)</small></li>
<li><b>Scénographie :</b> <a href="Scenegraph.html" title="Scenegraph/fr">Graphe de scène Coin (Inventor)</a>, <a href="Pivy.html" title="Pivy/fr">Pivy</a></li>
<li><b>Interface graphique :</b> <a href="Interface_creation.html" title="Interface creation/fr">Création d'interface</a>, <a href="Dialog_creation.html" title="Dialog creation/fr">Création d'une boite de dialogue</a> <small>(<a href="Dialog_creation_with_various_widgets.html" title="Dialog creation with various widgets/fr">1</a>, <a href="Dialog_creation_reading_and_writing_files.html" title="Dialog creation reading and writing files/fr">2</a>, <a href="Dialog_creation_setting_colors.html" title="Dialog creation setting colors/fr">3</a>, <a href="Dialog_creation_image_and_animated_GIF.html" title="Dialog creation image and animated GIF/fr">4</a>, <a href="PySide_usage_snippets.html" title="PySide usage snippets/fr">5</a>)</small>, <a href="PySide.html" title="PySide/fr">PySide</a>, Exemples PySide <a href="PySide_Beginner_Examples.html" title="PySide Beginner Examples/fr">débutant</a>, <a href="PySide_Intermediate_Examples.html" title="PySide Intermediate Examples/fr">intermédiaire</a>, <a href="PySide_Advanced_Examples.html" title="PySide Advanced Examples/fr">expérimenté</a></li>
<li><b>Macros :</b> <a href="Macros.html" title="Macros/fr">Macros</a>, <a href="How_to_install_macros.html" title="How to install macros/fr">Comment installer des macros</a></li>
<li><b>Intégration :</b> <a href="Embedding_FreeCAD.html" title="Embedding FreeCAD/fr">Intégrer FreeCAD</a>, <a href="Embedding_FreeCADGui.html" title="Embedding FreeCADGui/fr">Intégration de FreeCADGui</a></li></ul>
<hr/>
<ul><li><b>Autre :</b> <a href="Expressions.html" title="Expressions/fr">Expressions</a>, <a class="mw-selflink selflink">Extraits de codes</a>, <a href="Line_drawing_function.html" title="Line drawing function/fr">Fonction - tracer une ligne</a>, <a href="FreeCAD_vector_math_library.html" title="FreeCAD vector math library/fr">Bibliothèque mathématique vectorielle de FreeCAD</a> <small>(déprécié)</small></li></ul>
<hr/>
<ul><li><b>Hubs :</b> <a href="User_hub.html" title="User hub/fr">Hub utilisateurs</a>, <a href="Power_users_hub.html" title="Power users hub/fr">Hub utilisateurs expérimentés</a>, <a href="Developer_hub.html" title="Developer hub/fr">Hub développeurs</a></li></ul></div>
</div></div>
<!-- 
NewPP limit report
Cached time: 20241129212744
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.424 seconds
Real time usage: 5.943 seconds
Preprocessor visited node count: 1270/1000000
Post‐expand include size: 14074/2097152 bytes
Template argument size: 56804/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 59/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 268380/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 5565.620      1 -total
 99.66% 5546.623     59 Template:Code
  0.05%    2.919      1 Template:Powerdocnavi/fr
  0.04%    2.115     50 Template:Top
  0.03%    1.513      1 Template:TOCright
  0.02%    1.339      1 Template:Navigation_menu_2
  0.02%    0.862      1 Template:Incode
  0.02%    0.835      5 Template:KEY
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:2433-0!canonical and timestamp 20241129212738 and revision id 1419677. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
