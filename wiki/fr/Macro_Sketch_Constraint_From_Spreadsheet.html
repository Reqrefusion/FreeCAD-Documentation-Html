<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro Sketch Constraint From Spreadsheet/fr</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Macro_Sketch_Constraint_From_Spreadsheet.html" lang="en" title="Macro Sketch Constraint From Spreadsheet (100% translated)">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="fr">français</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../pl\Macro_Sketch_Constraint_From_Spreadsheet.html" lang="pl" title="Makrodefinicja: Wiązania szkicownika z arkusza kalkulacyjnego (3% translated)">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg"><img decoding="async" height="32" src="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg" width="32"/></a></span><span> </span>
Macro Sketch Constraint From Spreadsheet
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Macro qui, par un simple clic sur une cellule du tableur, ajoute une contrainte de longueur à une ligne, un cercle ou entre 2 points en utilisant un alias ou une adresse de cellule du tableur (ex. C2). Les modifications futures de la feuille de calcul mettront à jour la contrainte. La macro peut créer des alias pour vous.<br/>Il suffit de sélectionner une ligne, deux points ou une contrainte, de cliquer sur une cellule de la feuille de calcul et d'exécuter la macro. Vous pouvez sélectionner des lignes, des points aux extrémités d'une ligne, des points, des cercles ou des arcs de cercle.<br/><br/>Version macro : 01.04<br/>Date dernière modification : 2024-11-25<br/>Version FreeCAD : Toutes<br/>Téléchargement : <a class="external text" href="https://wiki.freecad.org/images/d/dc/Macro_Sketch_Constraint_From_Spreadsheet.svg" rel="nofollow">Icône de la barre d'outils</a><br/>Auteur: 2cv001<br/>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a class="new" href="../index.php?title=User;2cv001&amp;action=edit&amp;redlink=1.html" title="User:2cv001 (page does not exist)">2cv001</a>
</td></tr>
<tr>
<th class="ctOdd">Téléchargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://wiki.freecad.org/images/d/dc/Macro_Sketch_Constraint_From_Spreadsheet.svg" rel="nofollow">Icône de la barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr\Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br/><a href="../fr\How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br/><a href="../fr\Customize_Toolbars.html" title="Customize Toolbars/fr">Comment créer une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">01.04
</td></tr>
<tr>
<th class="ctOdd">Dernière modification
</th></tr>
<tr>
<td class="ctEven macro-date">2024-11-25
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Utilisation"><span class="tocnumber">2</span> <span class="toctext">Utilisation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Création_automatique_d'objets"><span class="tocnumber">2.1</span> <span class="toctext">Création automatique d'objets</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Création_automatique_d'alias"><span class="tocnumber">2.2</span> <span class="toctext">Création automatique d'alias</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Mode_automatique"><span class="tocnumber">2.2.1</span> <span class="toctext">Mode automatique</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Mode_manuel"><span class="tocnumber">2.2.2</span> <span class="toctext">Mode manuel</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Création_de_contraintes"><span class="tocnumber">2.3</span> <span class="toctext">Création de contraintes</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Liens"><span class="tocnumber">3</span> <span class="toctext">Liens</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Crédits"><span class="tocnumber">4</span> <span class="toctext">Crédits</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Script"><span class="tocnumber">5</span> <span class="toctext">Script</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Code"><span class="tocnumber">5.1</span> <span class="toctext">Code</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Téléchargement"><span class="tocnumber">5.1.1</span> <span class="toctext">Téléchargement</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p><b>Contactez-moi si quelque chose ne va pas.</b>
</p><p>Macro qui, par un simple clic sur une cellule du tableur, ajoute une contrainte de longueur à une ligne ou entre 2 points en utilisant un alias ou une adresse de cellule du tableur (ex. C2). Les modifications ultérieures de la feuille de calcul mettront à jour la contrainte. La macro peut créer des alias pour vous.
</p><p>Il suffit de sélectionner 1 ligne, 2 points ou une contrainte, de cliquer sur une cellule du tableur et d'exécuter la macro. Vous pouvez sélectionner des polylignes, des points aux extrémités d'une ligne, des points, des cercles ou des arcs de cercle.
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet1.gif"><img decoding="async" height="566" src="../File/SketchConstraintFromSpreadsheet1.gif" width="1059"/></a></span>
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a class="external text" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" rel="nofollow">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a class="external free" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" rel="nofollow">https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro</a>"&gt;raw code&lt;/a&gt;</div>
<p><br/>
<span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<p><span id="Automatic_Object_creation"></span>
</p>
<h3><span id="Cr.C3.A9ation_automatique_d.27objets"></span><span class="mw-headline" id="Création_automatique_d'objets">Création automatique d'objets</span></h3>
<p>Si vous exécutez la macro et que vous n'avez pas encore créé de feuille de calcul, de corps ou d'esquisse, la macro vous propose de les créer et ouvre ensuite l'esquisse en mode édition et la feuille de calcul afin que vous puissiez commencer à la remplir.
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet7.gif"><img decoding="async" height="673" src="../File/SketchConstraintFromSpreadsheet7.gif" width="1093"/></a></span>
</p><p><span id="Automatic_Alias_creation"></span>
</p>
<h3><span id="Cr.C3.A9ation_automatique_d.27alias"></span><span class="mw-headline" id="Création_automatique_d'alias">Création automatique d'alias</span></h3>
<p>Ce n'est pas obligatoire, mais il est préférable d'utiliser des alias dans votre feuille de calcul. La macro peut créer des alias à partir des textes contenus dans les cellules.<br/>
Deux modes : 
</p>
<ul><li>un mode manuel où vous sélectionnez vous-même les cellules contenant du texte pour l'alias et un mode automatique.</li>
<li>et un mode automatique :</li></ul>
<p><span id="Automatic_mode"></span>
</p>
<h4><span class="mw-headline" id="Mode_automatique">Mode automatique</span></h4>
<p>Un mode automatique où les alias sont automatiquement créés en utilisant une zone de texte définie par une cellule. La zone comprend la cellule et celles qui se trouvent en dessous. Ces textes correspondent au nom de l'alias. L'alias est créé à droite de son texte." La cellule désignée (ici A3) est éditable dans ces boîtes de dialogue :
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet2302.png" title="Alias automatic creation"><img alt="Alias automatic creation" decoding="async" height="312" src="../File/SketchConstraintFromSpreadsheet2302.png" width="502"/></a></span>
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet2303.png" title="Alias automatic creation"><img alt="Alias automatic creation" decoding="async" height="190" src="../File/SketchConstraintFromSpreadsheet2303.png" width="438"/></a></span>
<span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet2304.gif" title="Alias automatic creation"><img alt="Alias automatic creation" decoding="async" height="683" src="../File/SketchConstraintFromSpreadsheet2304.gif" width="1122"/></a></span>
<br/>
</p><p><br/>
<span id="Manual_mode"></span>
</p>
<h4><span class="mw-headline" id="Mode_manuel">Mode manuel</span></h4>
<p>Pour utiliser le mode manuel, ne cochez pas l'option "Automatic alias".
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet2301.png" title="Alias creation"><img alt="Alias creation" decoding="async" height="170" src="../File/SketchConstraintFromSpreadsheet2301.png" width="407"/></a></span>
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet8.gif" title="Alias creation"><img alt="Alias creation" decoding="async" height="531" src="../File/SketchConstraintFromSpreadsheet8.gif" width="958"/></a></span>
</p><p><span id="Constraints_creation"></span>
</p>
<h3><span id="Cr.C3.A9ation_de_contraintes"></span><span class="mw-headline" id="Création_de_contraintes">Création de contraintes</span></h3>
<p>1) Sélectionnez :
</p>
<ul><li>une ligne,</li>
<li>deux points (extrémité d'une ligne, centre d'un cercle, etc.)</li>
<li>ou une contrainte de longueur.</li></ul>
<p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SelectPoints.png"><img decoding="async" height="266" src="../File/SelectPoints.png" width="817"/></a></span>
</p><p>2) Cliquez sur une cellule de la feuille de calcul, avec ou sans alias, qui contient une valeur numérique :
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Capture1.png"><img decoding="async" height="265" src="../File/Capture1.png" width="339"/></a></span>
</p><p>3) Lancez la macro.
</p><p>4) Sélectionnez le type de contrainte souhaité :
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Choose_type_of_constraint.png"><img decoding="async" height="135" src="../File/Choose_type_of_constraint.png" width="168"/></a></span>
</p><p>Si la cellule a un alias, la propriété de longueur de la contrainte sera quelque chose comme "Spreadsheet.alias". Dans le cas contraire, il s'agira de quelque chose comme "Spreadsheet.D4".
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/If_the_spreadsheet_has_an_alias.png"><img decoding="async" height="486" src="../File/If_the_spreadsheet_has_an_alias.png" width="679"/></a></span>
</p><p>5) Si la contrainte provoque un conflit dans l'esquisse et que la case "conflict detection" est cochée, la macro propose de supprimer la nouvelle contrainte :
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet3.gif"><img decoding="async" height="566" src="../File/SketchConstraintFromSpreadsheet3.gif" width="1059"/></a></span>
</p><p>Si vous sélectionnez une contrainte existante, vous pouvez remplacer sa valeur par une valeur provenant d'une feuille de calcul :
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet2.gif"><img decoding="async" height="566" src="../File/SketchConstraintFromSpreadsheet2.gif" width="1059"/></a></span>
<span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet4.gif"><img decoding="async" height="473" src="../File/SketchConstraintFromSpreadsheet4.gif" width="1092"/></a></span>
</p><p>La macro peut également gérer une géométrie externe provenant d'une autre esquisse :
<span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet9.gif"><img decoding="async" height="771" src="../File/SketchConstraintFromSpreadsheet9.gif" width="1140"/></a></span>
</p><p>Pour être encore plus précis, si, par exemple, une ligne est horizontale plutôt que verticale, à l'ouverture de la boîte de dialogue, le focus sera sur le bouton permettant d'appliquer une contrainte horizontale. Si la ligne est verticale et non horizontale, le focus sera sur le bouton permettant d'appliquer une contrainte verticale. Dans les deux cas, il vous suffit d'appuyer sur la touche Entrée si vous êtes satisfait de votre choix.
</p><p><br/>
<span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet5.gif"><img decoding="async" height="418" src="../File/SketchConstraintFromSpreadsheet5.gif" width="933"/></a></span>
</p><p>La macro fonctionne également pour les protusions (propriété Length), les poches (propriété Length), les filets (propriété Radius), les chanfreins (propriété Size) et les épaisseurs (propriété Value). Si vous cliquez sur un protusion, par exemple, puis sur une cellule avec la valeur souhaitée, la propriété Length de la protusion est automatiquement modifiée.
<br/>
</p><p><span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/SketchConstraintFromSpreadsheet20240801.gif"><img decoding="async" height="683" src="../File/SketchConstraintFromSpreadsheet20240801.gif" width="1122"/></a></span>
</p><p><span id="Links"></span>
</p>
<h2><span class="mw-headline" id="Liens">Liens</span></h2>
<ul><li><a class="external text" href="https://forum.freecad.org/viewtopic.php?t=75972" rel="nofollow">Forum de discussion (français)</a></li>
<li><a class="external text" href="https://forum.freecad.org/viewtopic.php?style=5&amp;t=76990" rel="nofollow">Forum discussion (English)</a></li>
<li><a href="../fr\Macros_recipes.html" title="Macros recipes/fr">Liste des macros</a></li>
<li><a href="../fr\How_to_install_macros.html" title="How to install macros/fr">Comment installer des macros</a></li>
<li><a href="../fr\Customize_Toolbars.html" title="Customize Toolbars/fr">Personnaliser la barre d'outils</a></li></ul>
<p><span id="Credits"></span>
</p>
<h2><span id="Cr.C3.A9dits"></span><span class="mw-headline" id="Crédits">Crédits</span></h2>
<p>Merci à openBrain, mario52 et onekk pour leur aide sur le code!<br/>
Merci à Syres pour les tests et pour l'aide sur le format dans le code.<br/>
Merci à Roy043 et David69 pour les diverses révisions et améliorations du wiki.<br/>
Merci à L'ami René pour les tests et les idées.
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>Icône de la barre d'outils <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg"><img decoding="async" height="61" src="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg" width="61"/></a></span>
</p>
<h3><span class="mw-headline" id="Code">Code</span></h3>
<p>ver 01.04 2024/11/25 by 2cv001 <b>Macro_Sketch_Constraint_From_Spreadsheet.FCMacro</b>
<span id="Download"></span>
</p>
<h4><span id="T.C3.A9l.C3.A9chargement"></span><span class="mw-headline" id="Téléchargement">Téléchargement</span></h4>
<p><br/>
</p>
<div class="plainlinks" style="width:300px; text-align:center; margin:10px auto;">
<div style="border:1px outset #9eb4b5; background:#f0fdf8; margin:5px; padding:5px; white-space:nowrap; -webkit-border-radius: 5px; -moz-border-radius: 5px;">
<p><span typeof="mw:File"><a href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" rel="nofollow"><img decoding="async" height="35" src="../File/Nuvola_apps_download_manager.png" width="35"/></a></span>
</p><p><span class="CodeDownload" style="font-weight:bold"><a class="external text" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" rel="nofollow">Download latest version of the macro</a></span>
</p>
</div>
</div>
<!-- 
NewPP limit report
Cached time: 20241214203613
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.074 seconds
Real time usage: 0.141 seconds
Preprocessor visited node count: 159/1000000
Post‐expand include size: 4123/2097152 bytes
Template argument size: 1879/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 1/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 1638/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   10.749      1 -total
 69.41%    7.461      1 Template:Macro/fr
 15.54%    1.670      1 Template:Codeextralink
 12.91%    1.388      1 Template:CodeDownload
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:307752-0!canonical and timestamp 20241214203613 and revision id 1509960. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
