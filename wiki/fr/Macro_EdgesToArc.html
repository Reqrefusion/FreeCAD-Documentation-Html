<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro EdgesToArc/fr</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../de\Macro_EdgesToArc.html" lang="de" title="Macro EdgesToArc (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Macro_EdgesToArc.html" lang="en" title="Macro EdgesToArc (100% translated)">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="fr">français</span></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../it\Macro_EdgesToArc.html" lang="it" title="Macro Da Segmento a Arco (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../pl\Macro_EdgesToArc.html" lang="pl" title="Makrodefinicja: Krawędzie na łuk (14% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--med" dir="ltr" href="../cs\Macro_EdgesToArc.html" lang="cs" title="Makro EdgesToArc (Hrany do oblouku) (57% translated)">čeština</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_EdgesToArc.png"><img decoding="async" height="32" src="../File/Macro_EdgesToArc.png" width="32"/></a></span><span> </span>
EdgesToArc
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Transforme les arêtes sélectionnées si possible en un Arc circulaire. Utile pour restaurer des arcs discrétisés.<br/><br/>Version macro : 1.0<br/>Date dernière modification : 2014-01-02<br/>Version FreeCAD : Toutes versions<br/>Téléchargement : <a class="external text" href="https://www.freecadweb.org/wiki/images/6/65/Macro_EdgesToArc.png" rel="nofollow">Icône pour votre barre d'outils</a><br/>Auteur: Jreinhardt<br/>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a class="new" href="../index.php?title=User;Jreinhardt&amp;action=edit&amp;redlink=1.html" title="User:Jreinhardt (page does not exist)">Jreinhardt</a>
</td></tr>
<tr>
<th class="ctOdd">Téléchargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://www.freecadweb.org/wiki/images/6/65/Macro_EdgesToArc.png" rel="nofollow">Icône pour votre barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr\Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br/><a href="../fr\How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br/><a href="../fr\Customize_Toolbars.html" title="Customize Toolbars/fr">Comment créer une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Dernière modification
</th></tr>
<tr>
<td class="ctEven macro-date">2014-01-02
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes versions
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><a href="../fr\Macro_SuperWire.html" title="Macro SuperWire/fr">Macro SuperWire</a>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Script"><span class="tocnumber">2</span> <span class="toctext">Script</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Parfois, on rencontre des fils qui contiennent des arcs composés de petits segments de droites. Cela se produit souvent lorsque vous travaillez avec des fichiers provenant d'autres programmes. Cette macro permet de reconvertir relativement facilement ces arcs "discrétisés" en arcs circulaires. Cela réduit la taille du fichier et rend sa gestion plus facile.
</p><p>Pour utiliser cette macro, vous devez briser le fil en bords individuels à l'aide de la fonction <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Draft_Downgrade.svg"><img decoding="async" height="16" src="../File/Draft_Downgrade.svg" width="16"/></a></span> <a href="../fr\Draft_Downgrade.html" title="Draft Downgrade/fr">Draft Downgrade</a></span>. Ensuite il suffit de sélectionner les segments que vous voulez convertir en arc circulaire et exécuter la macro. Vous avez besoin d'au moins deux segments pour exécuter la fonction.
</p><p>La macro va vérifier si les segments se situent tous sur un cercle commun (segments contigus) et s'arrêtera si ce n'est pas le cas. Sinon, un arc sera créé et les segments enlevés.
</p><p>En raison de petites erreurs dans les calculs, de la fonction <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Draft_Upgrade.svg"><img decoding="async" height="16" src="../File/Draft_Upgrade.svg" width="16"/></a></span> <a href="../fr\Draft_Upgrade.html" title="Draft Upgrade/fr">Draft Upgrade</a></span> la macro peut parfois ne pas de reconstituer toutes les arêtes et arcs. Dans ce cas, la macro <a href="../fr\Macro_SuperWire.html" title="Macro SuperWire/fr">Macro_SuperWire</a> offre un moyen plus robuste pour le faire.
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Macro_EdgesToArc.png"><img decoding="async" height="64" src="../File/Macro_EdgesToArc.png" width="64"/></a></span>
</p><p><b>Macro_EdgesToArc.FCMacro</b>
</p>
<pre>import Draft
import FreeCADGui, FreeCAD
from FreeCAD import Base, Console
from math import atan2, pi, fabs

#This macro replaces a number of edges approximating a circular arc by a proper circular arc.
#It might be necessary to use the superwire macro to recombine the edges back to a wire, because of small errors in the calculations.

sel = FreeCADGui.Selection.getSelection()
if len(sel) &lt; 2:
    Console.PrintError("Too few edges are selected\n")
edges = [s.Shape for s in sel]

start_vertices = []
end_vertices = []
for edge in edges:
    start_vertices.append(edge.Vertexes[0].Point)
    end_vertices.append(edge.Vertexes[1].Point)
vertices = start_vertices + end_vertices

start,end,middle = None,None,None

#find start and end points
for edge in edges:
    is_start = True
    is_end = True
    for point in end_vertices:
        if edge.Vertexes[0].Point.distanceToPoint(point) &lt; 1e-8:
            is_start = False

    for point in start_vertices:
        if edge.Vertexes[1].Point.distanceToPoint(point) &lt; 1e-8:
            is_end = False
    if is_start:
        start = edge.Vertexes[0].Point
    if is_end:
        end = edge.Vertexes[1].Point

#find middle point, at least not too far away from the middle

for v in vertices:
    ratio = v.distanceToPoint(start)/v.distanceToPoint(end)
    if ratio &gt; 0.5 and ratio &lt; 2.:
        middle = v
        break

if middle is None:
    Console.PrintError("Could not find suitable middle point\n")

arc = Part.ArcOfCircle(start,middle,end)

#Check circularity
circular = True
for v in vertices:
    if fabs(v.distanceToPoint(arc.Center) - arc.Radius) &gt; 1e-6:
        Console.PrintError("Edges do not approximate a circular arc\n")
        circular = False
        break

if circular:
        Part.show(arc.toShape())
        for shape in sel:
            FreeCAD.ActiveDocument.removeObject(shape.Name)</pre>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241214203934
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.055 seconds
Real time usage: 0.107 seconds
Preprocessor visited node count: 100/1000000
Post‐expand include size: 2907/2097152 bytes
Template argument size: 2624/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 3036/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.493      1 -total
 32.67%    1.468      1 Template:Macro/fr
 26.06%    1.171      1 Template:MacroCode
 19.94%    0.896      1 Template:Clear
 12.87%    0.578      2 Template:KEY
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:19324-0!canonical and timestamp 20241214203934 and revision id 693063. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
