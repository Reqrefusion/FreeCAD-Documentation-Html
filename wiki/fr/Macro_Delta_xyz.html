<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro Delta xyz/fr</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Delta_xyz.html" lang="de" title="Macro Delta xyz (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Delta_xyz.html" lang="en" title="Macro Delta xyz (100% translated)">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="fr">français</span></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Macro_Delta_xyz.html" lang="hr" title="Macro Delta xyz/hr (15% translated)">hrvatski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Delta_xyz.html" lang="it" title="Macro Delta xyz (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Macro_Delta_xyz.html" lang="pl" title="Makrodefinicja: Delta XYZ (5% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_Delta_xyz.html" lang="cs" title="Makro Delta xyz (100% translated)">čeština</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Delta_xyz.png"><img decoding="async" height="32" src="../File/Macro_Delta_xyz.png" srcset="/images/thumb/f/f4/Macro_Delta_xyz.png/48px-Macro_Delta_xyz.png 1.5x, /images/f/f4/Macro_Delta_xyz.png 2x" width="32"/></a></span><span> </span>
Macro Delta xyz
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Donne les valeurs Delta xyz de 2 points et donne la distance entre ces points.<br/> Si la touche "SHIFT" est enfoncée, la valeur Delta commence sur la coordonnée 0,0,0 jusqu'au point cliqué (la coordonnée 0,0,0 est affichée en rouge). <br/> Une option est possible pour que la macro reste résidente (continue) puis appuyez sur la touche "Q" pour quitter la macro, et l'option pour imposer le nombre de décimales ou utiliser le nombre de décimale(s) dans l'option des préférence.<br/><br/>Version macro : 0.2<br/>Date dernière modification : 2020-10-23<br/>Version FreeCAD : Toutes versions<br/>Téléchargement : <a class="external text" href="https://www.freecadweb.org/wiki/images/f/f4/Macro_Delta_xyz.png" rel="nofollow">Icône pour votre barre d'outils</a><br/>Auteur: Mario52<br/>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="User;Mario52.html" title="User:Mario52">Mario52</a>
</td></tr>
<tr>
<th class="ctOdd">Téléchargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://www.freecadweb.org/wiki/images/f/f4/Macro_Delta_xyz.png" rel="nofollow">Icône pour votre barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br/><a href="How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br/><a href="Customize_Toolbars.html" title="Customize Toolbars/fr">Comment créer une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">0.2
</td></tr>
<tr>
<th class="ctOdd">Dernière modification
</th></tr>
<tr>
<td class="ctEven macro-date">2020-10-23
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes versions
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">SHIFT</span>, <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Q</span>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><a href="Part_Measure_Linear.html" title="Part Measure Linear/fr">Part Measure Linear</a> <span typeof="mw:File"><a class="mw-file-description" href="../File/Part_Measure_Linear.svg"><img decoding="async" height="24" src="../File/Part_Measure_Linear.svg" width="24"/></a></span>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Utilisation"><span class="tocnumber">2</span> <span class="toctext">Utilisation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Script"><span class="tocnumber">4</span> <span class="toctext">Script</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Version"><span class="tocnumber">5</span> <span class="toctext">Version</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Donne la valeur Delta de la ligne située entre 2 points et la longueur de la distance entre ces points.
</p><p>Si la touche "SHIFT" est enfoncée, la valeur Delta commence sur la coordonnée 0,0,0 au point cliqué (la coordonnée 0,0,0 est affichée en rouge).
</p><p>Une option est possible pour la macro reste résidente (continue) puis appuyez sur la touche "Q" pour quitter la macro, et l'option pour imposer le nombre de décimales ou utiliser la décimale dans l'option de préférence.
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<ol><li>Démarrez la macro</li>
<li>Sélectionnez du premier point dans la vue 3D</li>
<li>Sélectionnez le second point dans la vue 3D et le informations sont affichée dans la vue rapport</li></ol>
<p>Si la touche <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">SHIFT</span> est enfoncée, la valeur Delta commence sur la coordonnée 0,0,0 au point cliqué (la coordonnée 0,0,0 est affichée en rouge)
</p><p>Si la macro reste résidente (continue) appuyez sur la touche <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Q</span> pour quitter la macro.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Pour modifier la valeur: allez dans : FreeCAD → Menu → Tools → Edit parameters... → BaseApp/Preferences/Macros/FCMmacros/Delta_XYZ.
</p><p><b>_____switchDecimalsPref_____</b>
</p>
<ul><li><code>true</code>  1 : la valeur arrondie prend la valeur des préférences globales</li>
<li><code>false</code> 0 : la valeur ronde prend votre choix</li></ul>
<p><b>_____setArrondi_____</b>
</p>
<ul><li>défini la valeur de l'arrondie à votre choix</li>
<li>si votre choix = 0: la valeur arrondie est 3 par défaut</li></ul>
<p><b>_____switchResident_____</b>
</p>
<ul><li><code>true</code>  1 : la macro reste résidente (Tapez <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Q</span> pour quitter)</li>
<li><code>false</code> 0 : la macro est utilisée lors de l'exécution et se ferme après utilisation</li></ul>
<p><br/>
<span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/DeltaXYZ.png"><img decoding="async" height="229" src="../File/DeltaXYZ.png" width="505"/></a></span>
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Delta_xyz.png"><img decoding="async" height="64" src="../File/Macro_Delta_xyz.png" width="64"/></a></span>
</p><p><b>Macro_Delta_xyz.FCMacro</b>
</p>
<pre># -*- coding: utf-8 -*-
#Delta x y z Click Q to quit
#
#OS: Windows 10 (10.0)
#Word size of OS: 64-bit
#Word size of FreeCAD: 64-bit
#Version: 0.19.22808 (Git)
#Build type: Release
#Branch: master
#Hash: 72eb41b24f12b572d55081042160954b93f4614c
#Python version: 3.6.8
#Qt version: 5.12.1
#Coin version: 4.0.0a
#OCC version: 7.3.0
#Locale: French/Mars(fr_Ma)
#
__title__   = "Delta_XYZ"
__author__  = "Mario52"
__url__     = "https://www.freecadweb.org/wiki/Main_Page"
__Wiki__    = "https://wiki.freecadweb.org/Macro_Delta_xyz"
__version__ = "00.02"
__date__    = "2020/10/23"    #YYYY/MM/DD

import Draft, Part
import math
from FreeCAD import Base
import FreeCAD, FreeCADGui
App = FreeCAD
Gui = FreeCADGui

global positionX1 ;positionX1 = 0.0
global positionY1 ;positionY1 = 0.0
global positionZ1 ;positionZ1 = 0.0
global positionX2 ;positionX2 = 0.0
global positionY2 ;positionY2 = 0.0
global positionZ2 ;positionZ2 = 0.0
global pas        ;pas        = 0

global setArrondi                    # round value
global switchResident                # switch resident 0=not resident, 1=stay resident
global switchDecimalsPref            # switch unit preference or not

#### Configuration begin      #### 
#### NOT MODIFY THE CODE HERE ####
#### for modify : go to : FreeCAD &gt;Menu &gt;Tools &gt;Edit parameters... &gt;BaseApp/Preferences/Macros/FCMmacros/Delta_XYZ ####
##
FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).SetString("Version", __version__ + " (" + __date__ + ")")
##
switchResident = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).GetBool("switchResident")   # switch Resident or not
if switchResident == False:
    FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).SetBool("switchResident", switchResident)# switch Resident or not : 0 = Not Resident 1 = Resident
##
switchDecimalsPref = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).GetBool("switchDecimalsPref")   # switch unit preference or not
if switchDecimalsPref == True:
    setArrondi = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Units").GetInt("Decimals")    # unit in preferences
else:
    FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).SetBool("switchDecimalsPref", switchDecimalsPref)# 
    setArrondi = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).GetInt("setArrondi")
    if setArrondi &lt; 1:
        FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).SetInt("setArrondi", 3) # setArrondi
        setArrondi = FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macros/FCMmacros/" + __title__).GetInt("setArrondi")

##
####Configuration###################################################################################################################

## Tool Draft def : sub, length, dist
def sub(first, other): 
	"sub(Vector,Vector) - subtracts second vector from first one"
	if isinstance(first,FreeCAD.Vector) and isinstance(other,FreeCAD.Vector):
		return FreeCAD.Vector(first.x-other.x, first.y-other.y, first.z-other.z)
def length(first):
	"lengh(Vector) - gives vector length"
	if isinstance(first,FreeCAD.Vector):
		return math.sqrt(first.x*first.x + first.y*first.y + first.z*first.z)
def dist(first, other):
	"dist(Vector,Vector) - returns the distance between both points/vectors"
	if isinstance(first,FreeCAD.Vector) and isinstance(other,FreeCAD.Vector):
		return length(sub(first,other))

import FreeCAD, FreeCADGui 

#########
doc = FreeCAD.ActiveDocument
if doc == None:
    doc = FreeCAD.newDocument("Delta x y z")
#########

##key
global i     ; i = 0   
global c     ; c = ""
global d     ; d = ""
global v     ; v = Gui.activeDocument().activeView()
global o     ; o = ""
global s     ; s = ""
global SHIFT ; SHIFT = ""
global DOWN  ; DOWN = ""
##

class ViewObserver:
    def keyPosition(self, info):
#        global i
#        global c
        global SHIFT
        global DOWN
        global s 
        global d 
        global v
        global o

        SHIFT = ""
        key = info["Key"]

        if (key.upper() == "SHIFT") and (info["ShiftDown"] == False):  #
            SHIFT = "SHIFT"
            DOWN  = "DOWN"
            key   = ""

        if key.upper() == "Q":
            FreeCADGui.Selection.removeObserver(s)                     # Uninstalls the resident function
            v.removeEventCallback("SoKeyboardEvent",d)
            App.Console.PrintMessage("____End Delta_XYZ____" + "\n")
        xx = info["Key"]

class SelObserver:
    def addSelection(self,document, object, element, position):  # Selection
        global pas
        global positionX1
        global positionY1
        global positionZ1
        global positionX2
        global positionY2
        global positionZ2
        global SHIFT
        global DOWN
        global s 
        global d 
        global v

        pas+=1
        if (SHIFT == "SHIFT") and (DOWN == "DOWN"):
            positionX1 = 0.0
            positionY1 = 0.0
            positionZ1 = 0.0
            App.Console.PrintError("Begin    : X1 "+str(positionX1)+" Y1: "+str(positionY1)+" Z1: "+str(positionZ1)+"\n")    
            pas = 2
            SHIFT = DOWN  = ""

        if pas==1:
            positionX1 = round(position[0],setArrondi)
            positionY1 = round(position[1],setArrondi)
            positionZ1 = round(position[2],setArrondi)
            App.Console.PrintMessage("Begin    : X1 "+str(positionX1)+" Y1: "+str(positionY1)+" Z1: "+str(positionZ1)+"\n")    
        else:
            positionX2 = round(position[0],setArrondi)
            positionY2 = round(position[1],setArrondi)
            positionZ2 = round(position[2],setArrondi)
            App.Console.PrintMessage("End      : X2 "+str(positionX2)+" Y2: "+str(positionY2)+" Z2: "+str(positionZ2)+"\n")    
            App.Console.PrintMessage("Delta X  : "+str(round(abs(positionX1-positionX2),setArrondi))+"\n")    
            App.Console.PrintMessage("Delta Y  : "+str(round(abs(positionY1-positionY2),setArrondi))+"\n")    
            App.Console.PrintMessage("Delta Z  : "+str(round(abs(positionZ1-positionZ2),setArrondi))+"\n")    
            v1=FreeCAD.Vector(positionX1,positionY1,positionZ1)
            v2=FreeCAD.Vector(positionX2,positionY2,positionZ2)
            distance = dist(v1,v2)
            App.Console.PrintMessage("Distance : "+ str(round(distance,setArrondi))+"\n")
            App.Console.PrintMessage("__________________________________"+"\n")
            pas=0
            if switchResident == False:
                FreeCADGui.Selection.removeObserver(s)                     # Uninstalls the resident function
                v.removeEventCallback("SoKeyboardEvent",d)                 # Uninstalls the resident function


pas = 0
s=SelObserver()
FreeCADGui.Selection.addObserver(s)          # install the function mode resident 
## key
o = ViewObserver()                           # install the function mode resident 
d = v.addEventCallback("SoKeyboardEvent",o.keyPosition)
App.Console.PrintMessage("____Begin Delta_XYZ____" + "\n")
##
FreeCAD.Console.PrintMessage("\n"+"####Configure################################################################################################" + "\n\n")
FreeCAD.Console.PrintMessage("For modify the value : go to : FreeCAD &gt;Menu &gt;Tools &gt;Edit parameters... &gt;BaseApp/Preferences/Macros/FCMmacros/Delta_XYZ"+"\n\n")
FreeCAD.Console.PrintMessage("_____switchDecimalsPref_____  ")
FreeCAD.Console.PrintError("Actual " + str(switchDecimalsPref)+"\n")
FreeCAD.Console.PrintMessage("switchDecimalsPref : True  1 : the round value takes the global preferences value "+"\n")
FreeCAD.Console.PrintMessage("                   : False 0 : the round value takes your choice "+"\n\n")
FreeCAD.Console.PrintMessage("_____setArrondi_____  ")
FreeCAD.Console.PrintError("Actual " + str(setArrondi)+"\n")
FreeCAD.Console.PrintMessage("setArrondi         : set your choice round value"+"\n")
FreeCAD.Console.PrintMessage("                   : if your choice = 0 : the round value is 3 by default "+"\n\n")
FreeCAD.Console.PrintMessage("_____switchResident_____  ")
FreeCAD.Console.PrintError("Actual " + str(switchResident)+"\n")
FreeCAD.Console.PrintMessage("switchResident     : True  1 : the macro stay resident (Type Q to quit)"+"\n")
FreeCAD.Console.PrintMessage("                   : False 0 : the macro is used on run and quit after use"+"\n")
FreeCAD.Console.PrintMessage("\n"+"####Configure end############################################################################################" + "\n")
FreeCAD.Console.PrintMessage("\n"+"####Use######################################################################################################" + "\n")
FreeCAD.Console.PrintMessage("Use : click the first point, click the second point, the data is diplayed"+"\n")
FreeCAD.Console.PrintMessage("    : press the SHIFT button click the point, the Delta is displayed with the coordinate X=0,Y=0,Z=0 to point clicked X, Y, Z"+"\n")
FreeCAD.Console.PrintMessage("    : the first coordinate X=0, Y=0, Z=0 is displayed in red"+"\n")
FreeCAD.Console.PrintMessage("####Use end#######################################################################################################" + "\n\n")
##</pre>
<div style="clear:both"></div>
<h2><span class="mw-headline" id="Version">Version</span></h2>
<p>Version 0.2 2020-10-23 : ajout appuyez sur la touche <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">SHIFT</span>, cliquez sur un point et la valeur delta commence 0,0,0 au point cliqué, <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Q</span> pour quitter la macro <br/> Ajout d'options configurables dans les préférence de FC
</p><p>Version 0.1 2013-11-29 : <a class="external text" href="https://forum.freecadweb.org/viewtopic.php?f=3&amp;t=5036" rel="nofollow">view toolbar : measure distance tool</a>
</p>
<!-- 
NewPP limit report
Cached time: 20241129212931
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.058 seconds
Real time usage: 0.072 seconds
Preprocessor visited node count: 160/1000000
Post‐expand include size: 5164/2097152 bytes
Template argument size: 10945/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 10650/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    5.708      1 -total
 41.13%    2.348      1 Template:Macro/fr
 17.43%    0.995      1 Template:MacroCode
 13.39%    0.764      7 Template:KEY
 10.16%    0.580      2 Template:True
  8.92%    0.509      1 Template:Clear
  8.60%    0.491      2 Template:False
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:12111-0!canonical and timestamp 20241129212931 and revision id 787757. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
