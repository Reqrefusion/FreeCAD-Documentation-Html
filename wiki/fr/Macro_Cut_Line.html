<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro Cut Line/fr</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../de\Macro_Cut_Line.html" lang="de" title="Makro Linie Schneiden (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Macro_Cut_Line.html" lang="en" title="Macro Cut Line (100% translated)">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="fr">français</span></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../it\Macro_Cut_Line.html" lang="it" title="Macro Taglia linea (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../pl\Macro_Cut_Line.html" lang="pl" title="Makrodefinicja: cięcie linią (7% translated)">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Cut_Line.png"><img decoding="async" height="32" src="../File/Macro_Cut_Line.png" width="32"/></a></span><span> </span>
Macro Cut Line
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Coupe une ligne en donnant comme argument le nombre de coupures, création de lignes ou non, biscolor, points. La nouvelle ligne est créée dans les coordonnées réelles de l'objet et non dans celles du corps.<br/><span style="background-color: #ffeeee">(Ligne de commande, collez cette macro complète dans la console Python)</span>.<br/><br/>Version macro : 2.0<br/>Date dernière modification : 2019/06/17<br/>Version FreeCAD : All<br/>Téléchargement : <a class="external text" href="https://www.freecadweb.org/wiki/images/3/35/Macro_Cut_Line.png" rel="nofollow">ToolBar Icon</a><br/>Auteur: mario52<br/>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Mario52.html" title="User:Mario52">mario52</a>
</td></tr>
<tr>
<th class="ctOdd">Téléchargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://www.freecadweb.org/wiki/images/3/35/Macro_Cut_Line.png" rel="nofollow">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr\Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br/><a href="../fr\How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br/><a href="../fr\Customize_Toolbars.html" title="Customize Toolbars/fr">Comment créer une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">2.0
</td></tr>
<tr>
<th class="ctOdd">Dernière modification
</th></tr>
<tr>
<td class="ctEven macro-date">2019/06/17
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Utilisation"><span class="tocnumber">2</span> <span class="toctext">Utilisation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Script"><span class="tocnumber">3</span> <span class="toctext">Script</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Exemple"><span class="tocnumber">4</span> <span class="toctext">Exemple</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Liens"><span class="tocnumber">5</span> <span class="toctext">Liens</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Cette petite macro coupe une ligne en plusieurs lignes en donnant comme arguments le nombre de coupures, avec création de lignes ou non, colorer les lignes coupées par alternativement rouge puis blanche, création de points à l'endroit de la coupure ou non.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_cutLine_00.png"><img decoding="async" height="300" src="../File/Macro_cutLine_00.png" width="400"/></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">cutLine</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<p>Vous pouvez l'utiliser dans une macro.
</p>
<ul><li><b>4 :</b> nombre de coupures</li>
<li><b>createPoint</b> : crée un point si (&gt;0) ou non (0) (Défaut 1)</li>
<li><b>createLine</b> : crée les coupures de lignes (&gt;0) ou non (0) (Défaut 0)</li>
<li><b>biColor</b> : crée les lignes biColor (alternativement rouge puis blanche) (&gt;0) ou non (0) (Défaut 0)</li></ul>
<p><br/>
Vous pouvez changer la valeur de la couleur des lignes par défaut dans la macro.
</p><p>Avec l'option bisColor les lignes sont créées de couleurs rouge et blanche, la couleur par défaut est modifiable dans le code aux lignes 20 et 23.
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="../File/Macro_Cut_Line.png"><img decoding="async" height="64" src="../File/Macro_Cut_Line.png" width="64"/></a></span>
</p><p><b>Macro_cutLine.FCMacro</b>
</p>
<pre>#################################################################
# http://forum.freecadweb.org/viewtopic.php?f=3&amp;t=4217&amp;hilit=discretize
# 08/03/2015 2019/06/17

__title__   = "cutLine"
__author__  = "Mario52"
__version__ = "00.02"
__date__    = "2019/06/17"

import Draft, Part
def cutLine(numberOfPoints = 2, createPoint = 1, createLine = 0, biColor = 0):           # create a points of forme

    def createLines(numberOfPoints, points, biColor):                                        # create line
        biscolor = 0
        for lin in range(numberOfPoints-1):
            creaLine = [FreeCAD.Vector(points[lin]),FreeCAD.Vector(points[lin+1])]
            wire = Draft.makeWire(creaLine,closed=False,face=False,support=None)
            if biColor != 0:                                                                 # biColor 
                if biscolor == 0:
                    FreeCADGui.ActiveDocument.getObject(wire.Name).LineColor = (1.0,0.0,0.0) # 255 = 1 (10 = (1/255 * 10 ))
                    biscolor = 1
                else:
                    FreeCADGui.ActiveDocument.getObject(wire.Name).LineColor = (1.0,1.0,1.0) # 255 = 1 (10 = (1/255 * 10 ))
                    biscolor = 0
    try:
        points = []
        points[:] = []
        selectionObjects = FreeCADGui.Selection.getSelectionEx()         # getSelectionEx
        numberOfPoints += 1
        for selection in selectionObjects:
            compteur = pas = 0
            for selectedEdge in selection.SubObjects:
                    FreeCAD.Console.PrintMessage(selectionObjects[0].SubElementNames[compteur] + "\n")                   
#                    print( selectionObjects[0].SubElementNames[compteur])# getSelectionEx
                    compteur += 1                                              
                    points = selectedEdge.discretize(numberOfPoints)   
                    if createLine != 0:
                        createLines(numberOfPoints, points, biColor)
                    for p in points:
                        if createPoint != 0:
                            Draft.makePoint( p.x, p.y, p.z)
                        FreeCAD.Console.PrintMessage(str(compteur)+" X"+ str(p.x)+" Y"+ str(p.y)+ " Z"+ str(p.z) + "\n")
#                        print( compteur," X", p.x, " Y", p.y, " Z", p.z)
                    pas = 1                                              #

            if pas == 0:                                                 # the not SubObjects
                selectionObjects = FreeCADGui.Selection.getSelection()   # select all elements
                FreeCAD.Console.PrintMessage(selectionObjects[0].Name + "\n")
#                print( selectionObjects[0].Name)                         # getSelection()
                compteur = 0
                for ii in enumerate(selectionObjects[0].Shape.Edges): 
                    compteur += 1
                    points = ii[1].discretize(numberOfPoints)            # discretize the element
                    for p in points:
                        if createPoint != 0:
                            Draft.makePoint( p.x, p.y, p.z)              # create points
                        FreeCAD.Console.PrintMessage(str(compteur)+" X"+ str(p.x)+" Y"+ str(p.y)+ " Z"+ str(p.z) + "\n")
#                         print( compteur, " X", p.x, " Y", p.y, " Z", p.z)  # list and display the coordinates
                    if createLine != 0:
                        createLines(numberOfPoints, points, biColor)
    except:
        FreeCAD.Console.PrintError("Error" + "\n" + "Give : cutLine(numberOfPoints = 2, createPoint = 1, createLine = 0, biColor = 0)"+"\n")
        FreeCAD.Console.PrintError("Select the complete shape or separate wire(s) line, circle ..."+"\n")

#        print( "Error : Give cutLine(numberOfPoints = 2, createPoint = 1, createLine = 0, biColor = 0)")

# Example in command line (paste the macro in FC Python console) and write:
#cutLine(2, createLine = 1, biColor = 1, createPoint = 0)</pre>
<h2><span class="mw-headline" id="Exemple">Exemple</span></h2>
<p>Peut être utilisée dans l'éditeur de macro de FreeCAD.
</p><p>Si la macro complète est collée dans l'éditeur Python de FreeCAD utilisez la commande suivante :
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">cutLine</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">createLine</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">biColor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">createPoint</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
<h2><span class="mw-headline" id="Liens">Liens</span></h2>
<p>Cette macro utilise la fonction discretize <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=3&amp;t=4217&amp;hilit=discretize" rel="nofollow">voir le code original</a>
</p>
<!-- 
NewPP limit report
Cached time: 20241214203527
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.053 seconds
Real time usage: 0.211 seconds
Preprocessor visited node count: 127/1000000
Post‐expand include size: 2927/2097152 bytes
Template argument size: 4823/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 1/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 5544/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  160.337      1 -total
 97.45%  156.241      1 Template:Code
  1.44%    2.302      1 Template:Macro/fr
  0.58%    0.928      1 Template:ColoredText
  0.54%    0.858      1 Template:MacroCode
  0.43%    0.688      1 Template:Caption
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:58418-0!canonical and timestamp 20241214203527 and revision id 693036. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
