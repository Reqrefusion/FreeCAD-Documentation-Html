<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro 3d Printer Slicer Individual Parts/pl</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_3d_Printer_Slicer_Individual_Parts.html" lang="en" title="Macro 3d Printer Slicer Individual Parts (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_3d_Printer_Slicer_Individual_Parts.html" lang="fr" title="Macro 3d Printer Slicer Individual Parts (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Macro_3d_Printer_Slicer_Individual_Parts.html" lang="it" title="Macro 3d Printer Slicer Individual Parts (100% translated)">italiano</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--stub" dir="ltr" lang="pl">polski</span></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg"><img decoding="async" height="32" src="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg" width="32"/></a></span><span> </span>
Macro 3d Printer Slicer Individual Parts
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Export to slicing software for 3D printers based on a similar macro by cae2100. Exports a single stl file for each visible part in the same directory as original design file, then opens it in slicing software.<br/>This code, when run, will export the currently open design to several STL files, named after the labels of the parts, and open it in the slicing software that you use. The macro is searching for <b><a class="external text" href="http://wiki.ultimaker.com/Cura" rel="nofollow">Cura</a></b> in the path but you can add any other slicing by changing the string in the macro.<br/><br/>Macro version: 1.1<br/>Last modified: 2020-10-30<br/>FreeCAD version: All<br/>Download: <a class="external text" href="https://wiki.freecadweb.org/images/3/3d/Macro_3d_Printer_Slicer_Individual_Parts.svg" rel="nofollow">ToolBar Icon</a><br/>Author: WayofWood<br/>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a class="new" href="index.php?title=User;WayofWood&amp;action=edit&amp;redlink=1.html" title="User:WayofWood (page does not exist)">WayofWood</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://wiki.freecadweb.org/images/3/3d/Macro_3d_Printer_Slicer_Individual_Parts.svg" rel="nofollow">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes">Macros recipes</a><br/><a href="How_to_install_macros.html" title="How to install macros">How to install macros</a><br/><a href="Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.1
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2020-10-30
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><a href="Macro_3d_Printer_Slicer.html" title="Macro 3d Printer Slicer">Macro 3d Printer Slicer</a> <span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_3d_Printer_Slicer.png"><img decoding="async" height="24" src="../File/Macro_3d_Printer_Slicer.png" srcset="/images/thumb/9/96/Macro_3d_Printer_Slicer.png/36px-Macro_3d_Printer_Slicer.png 1.5x, /images/thumb/9/96/Macro_3d_Printer_Slicer.png/48px-Macro_3d_Printer_Slicer.png 2x" width="24"/></a></span>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Script"><span class="tocnumber">2</span> <span class="toctext">Script</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Credits"><span class="tocnumber">3</span> <span class="toctext">Credits</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<p><br/>
</p>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>This code, when run, will export the visible bodies at the top level (bodies deeper in the tree will be ignored) of the currently open design to individual STL files, and open them it in the slicing software that you use. This macro will look for <b><a class="external text" href="http://wiki.ultimaker.com/Cura" rel="nofollow">Cura</a></b> as the default but you can change it to any other slider by changing the SLICERAPP variable in the source code. 
</p><p>It is best used by creating a link to the macro on the toolbar, and when your ready to slice the object, just click it and your objects, as they appear on the screen in FreeCAD will appear on your slicing software's interface, ready to slice. It will also create several STL files with the same filename as the design file and the part label in the same directory as the design file.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="../File/Screenshot_Cura_Example.png"><img decoding="async" height="349" src="../File/Screenshot_Cura_Example.png" srcset="/images/thumb/e/ee/Screenshot_Cura_Example.png/720px-Screenshot_Cura_Example.png 1.5x, /images/thumb/e/ee/Screenshot_Cura_Example.png/960px-Screenshot_Cura_Example.png 2x" width="480"/></a></span>
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>The SLICERAPP variable can be changed to any slicing software of your choosing. If a specific object is not exported you might have to add the respective type to the doexport array.
</p><p>ToolBar Icon <span typeof="mw:File"><a class="mw-file-description" href="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg"><img decoding="async" height="64" src="../File/Macro_3d_Printer_Slicer_Individual_Parts.svg" width="64"/></a></span>
</p><p><b>Macro_3d_Printer_Slicer_Individual_Parts.py</b>
</p>
<pre>import FreeCAD
import Mesh
import sys
import math
import os
import subprocess

SLICERAPP= "cura"		 			# Put your Slicer program here

# some fuctions
def getPlacement(quat,vect,obj):
  if quat[3] &gt; -1  and quat[3] &lt; 1:
    delta = math.acos(quat[3])*2.0
    scale = math.sin(delta/2)
    rx = quat[0]/scale
    ry = quat[1]/scale
    rz = quat[2]/scale
  else:
    delta = 0
    rx = 0
    ry = 0
    rz = 1
  info0 = "translation "+str(vect.x)+" "+str(vect.y)+" "+str(vect.z)
  info1 = "rotation "+str(rx)+" "+str(ry)+" "+str(rz)+" "+str(delta)
  return info0+" "+info1
# some definitions
placement = App.Placement(App.Vector(0,0,0),App.Rotation(0,0,0,1))
# user need to set this directory where slicing software is located
OutDir = FreeCAD.ActiveDocument.FileName.replace(".FCStd", "--")
visible_objs = []
# Get Objects in document
doc = App.ActiveDocument
objs = doc.Objects
stlFile = ""
stlFiles = [ SLICERAPP ]
# hide all
for obj in objs:
   print(obj.Label + "//" + obj.TypeId)
   print(len(obj.InList))
   if obj.ViewObject.isVisible() and hasattr(obj, 'Shape') and (len(obj.InList) &lt;= 1):
      visible_objs.append(obj)
for obj in visible_objs:
  stlFile = OutDir+str(obj.Label)+".stl"
  Mesh.export([obj],stlFile)
  stlFiles.append(stlFile)
  print ("Exporting " + stlFile + "\n")
print ("Calling subprocess: " + str(stlFiles)+"\n")
subprocess.Popen(stlFiles)</pre>
<h2><span class="mw-headline" id="Credits">Credits</span></h2>
<p>Thanks to cae2100 for developing the original macro code - <a href="Macro_3d_Printer_Slicer.html" title="Macro 3d Printer Slicer">also available here</a>.<br/> 
Thanks to <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686" rel="nofollow">Wmayer</a> for his help in writing this script.<br/>
Original forum topic: <a class="external free" href="http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686" rel="nofollow">http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686</a>
</p>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241129212517
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.043 seconds
Real time usage: 0.061 seconds
Preprocessor visited node count: 96/1000000
Post‐expand include size: 2706/2097152 bytes
Template argument size: 2506/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2315/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.878      1 -total
 55.44%    3.813      1 Template:Macro
 26.39%    1.815      1 Template:Clear
 14.96%    1.029      1 Template:MacroCode
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:273955-0!canonical and timestamp 20241129212517 and revision id 1079541. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
