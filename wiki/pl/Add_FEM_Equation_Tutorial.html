<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Add FEM Equation Tutorial/pl</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="de" title="Tutorium FEM Gleichung hinzufügen (100% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="en" title="Add FEM Equation Tutorial (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="fr" title="FEM Tutoriel pour ajouter des équations FEM (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="it" title="Tutorial Aggiungere equazione FEM (100% translated)">italiano</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="pl">polski</span></li>
<li><a class="mw-pt-progress mw-pt-progress--med" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="ro" title="Adaugă Ecuația Analiza Elementului Finit Tutorial (54% translated)">română</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="Add_FEM_Equation_Tutorial.html" lang="ru" title="Руководство по добавлению уравнений в верстак FEM (3% translated)">русский</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img decoding="async" height="32" src="../File/Freecad.svg" width="32"/></span></span> Ćwiczenie
</td></tr>
<tr>
<th class="ctOdd">Temat
</th></tr>
<tr>
<td class="ctEven">Dodawanie równań MES
</td></tr>
<tr>
<th class="ctOdd">Poziom trudności
</th></tr>
<tr>
<td class="ctEven">Zaawansowany
</td></tr>
<tr>
<th class="ctOdd">Czas wykonania
</th></tr>
<tr>
<td class="ctEven">1 dzień
</td></tr>
<tr>
<th class="ctOdd">Autorzy
</th></tr>
<tr>
<td class="ctEven"><a class="new" href="index.php?title=User;JohnWang&amp;action=edit&amp;redlink=1.html" title="User:JohnWang (page does not exist)">JohnWang</a>
</td></tr>
<tr>
<th class="ctOdd">Wersja FreeCAD
</th></tr>
<tr>
<td class="ctEven">0.19
</td></tr>
<tr>
<th class="ctOdd">Pliki z przykładami
</th></tr>
<tr>
<td class="ctEven"><i>Nie dołączono</i>
</td></tr>
<tr>
<th class="ctOdd">Zobacz również
</th></tr>
<tr>
<td class="ctEven"><i>-</i>
</td></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Wprowadzenie"><span class="tocnumber">1</span> <span class="toctext">Wprowadzenie</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Nowy_typ_równania"><span class="tocnumber">2</span> <span class="toctext">Nowy typ równania</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Nowy_obiekt_równania_solvera_Elmer"><span class="tocnumber">3</span> <span class="toctext">Nowy obiekt równania solvera Elmer</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Słowa_kluczowe"><span class="tocnumber">3.1</span> <span class="toctext">Słowa kluczowe</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Edycja_plików"><span class="tocnumber">3.2</span> <span class="toctext">Edycja plików</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Rozszerz_obiekt_solvera"><span class="tocnumber">4</span> <span class="toctext">Rozszerz obiekt solvera</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Rozszerz_obiekt_zapisujący_równania"><span class="tocnumber">5</span> <span class="toctext">Rozszerz obiekt zapisujący równania</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Narzędzie_w_GUI_do_tworzenia_równania"><span class="tocnumber">6</span> <span class="toctext">Narzędzie w GUI do tworzenia równania</span></a></li>
</ul>
</div>
</td></tr></tbody></table>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Wprowadzenie">Wprowadzenie</span></h2>
<p>W tym poradniku dodamy równanie <b>Flow</b> (przepływu) do FreeCAD i zaimplementujemy wsparcie dla solvera Elmer. Upewnij się, że przeczytałeś i zrozumiałeś stronę <a href="Extend_FEM_Module.html" title="Extend FEM Module/pl">Rozszerzenie modułu MES</a> przed przejściem do tego poradnika.
</p><p>Zadanie można podzielić na pięć części:
</p>
<ul><li><b>Nowy typ równania</b>. Ten krok musi być wykonany tylko jeśli równanie nie istnieje jeszcze we FreeCAD (w przeciwieństwie do równania, które jest już we FreeCAD, ale nie jest wspierane przez docelowy solver).</li>
<li><b>Nowy obiekt równania</b>. Dodawanie konkretnego obiektu dokumentu reprezentującego konkretne równanie solvera Elmer.</li>
<li><b>Rozszerz obiekt solvera</b>. Dodawanie wsparcia dla nowego równania do obiektu solvera Elmer.</li>
<li><b>Rozszerz obiekt zapisujący równania</b>. Rozszerzenie eksportu do solvera Elmer o wsparcie dla nowego typu równania.</li>
<li><b>Narzędzie w GUI do tworzenia równania</b>. Dostęp do funkcji nowego równania z poziomu GUI środowiska pracy MES.</li></ul>
<p><span id="New_equation_type"></span>
</p>
<h2><span id="Nowy_typ_r.C3.B3wnania"></span><span class="mw-headline" id="Nowy_typ_równania">Nowy typ równania</span></h2>
<p>W tym kroku zmodyfikujemy następujący plik:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/equationbase.py</span></li></ul>
<p>Typ równania jest dzielony przez wszystkie obiekty równań różnych solverów. Każdy typ ma ciąg określający (np. "Heat" - ciepło) i dedykowane polecenie dodające równanie do wybranego solvera. To upraszcza GUI, ponieważ mamy tylko jeden przycisk dla równania ciepła, z którego korzystają wszystkie wspierane solvery.
</p><p>Najpierw dodaj nowe równanie do modułu <code>equationbase.py</code>. Każde równanie wymaga dwóch klas. Proxy dokumentu i proxy widoku. Te dwie klasy będą później używane jako klasy bazowe dla konkretnych klas równania Elmer. Po prostu skopiuj i wklej je z istniejącego typu równania i dostosuj ścieżkę ikony w <code>getIcon(self)</code> proxy widoku.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">FlowProxy</span><span class="p">(</span><span class="n">BaseProxy</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">FlowViewProxy</span><span class="p">(</span><span class="n">BaseViewProxy</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">":/icons/FEM_EquationFlow.svg"</span>
</pre></div>
<p><span id="New_Elmer's_equation_object"></span>
</p>
<h2><span id="Nowy_obiekt_r.C3.B3wnania_solvera_Elmer"></span><span class="mw-headline" id="Nowy_obiekt_równania_solvera_Elmer">Nowy obiekt równania solvera Elmer</span></h2>
<p>W tym kroku zaimplementujemy obiekt dokumentu. Musimy dodać nowy plik <code>flow.py</code> w:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/elmer/equations/flow.py</span></li></ul>
<p>i zmodyfikować następujące pliki:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/ObjectsFem.py</span></li>
<li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/CMakeLists.txt</span></li></ul>
<p>Zacznijmy od dodania nowego pliku <code>flow.py</code>. Ten plik można skopiować z istniejącego równania.
</p><p><span id="Keywords"></span>
</p>
<h3><span id="S.C5.82owa_kluczowe"></span><span class="mw-headline" id="Słowa_kluczowe">Słowa kluczowe</span></h3>
<ul><li>Jeśli nowe równanie wspiera tylko słowa kluczowe dla układów liniowych (<b>linear</b>) to skopiuj moduł <code>femsolver/elmer/equations/elasticity.py</code>.</li>
<li>Jeśli nowe równanie wspiera słowa kluczowe dla układów liniowych (<b>linear</b>) i nieliniowych (<b>non-linear</b>) to skopiuj <code>femsolver/elmer/equations/heat.py</code>.</li></ul>
<p>Równanie przepływu w Elmer jest potencjalnie nieliniowym równanie. Oznacza to, że oprzemy naszą pracę na <code>heat.py</code>.
</p><p><span id="Editing_files"></span>
</p>
<h3><span id="Edycja_plik.C3.B3w"></span><span class="mw-headline" id="Edycja_plików">Edycja plików</span></h3>
<p>Po skopiowaniu <code>heat.py</code> do <code>flow.py</code>, dostosuj <code>flow.py</code> w tych lokalizacjach:
</p>
<ul><li>argument name (nazwa) funkcji modułu <code>create</code>,</li>
<li>klasy bazowe klasy <code>Proxy</code>,</li>
<li>cechę <code>Type</code> klasy <code>Proxy</code>,</li>
<li>klasy <code>ViewProxy</code>.</li></ul>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"'''Flow'''"</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">femutils</span><span class="o">.</span><span class="n">createObject</span><span class="p">(</span>
        <span class="n">doc</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Proxy</span><span class="p">,</span> <span class="n">ViewProxy</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Proxy</span><span class="p">(</span><span class="n">nonlinear</span><span class="o">.</span><span class="n">Proxy</span><span class="p">,</span> <span class="n">equationbase</span><span class="o">.</span><span class="s1">'''Flow'''</span><span class="n">Proxy</span><span class="p">):</span>

    <span class="n">Type</span> <span class="o">=</span> <span class="s2">"Fem::EquationElmer'''Flow'''"</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Proxy</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Priority</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">class</span> <span class="nc">ViewProxy</span><span class="p">(</span><span class="n">nonlinear</span><span class="o">.</span><span class="n">ViewProxy</span><span class="p">,</span> <span class="n">equationbase</span><span class="o">.</span><span class="s1">'''Flow'''</span><span class="n">ViewProxy</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Następnie musisz zmienić właściwości dodane przez funkcję <code>obj.addProperty(..)</code> na te wymagane przez równanie.
</p><p>W momencie pisania tego poradnika równanie przepływu solvera Elmer nie miało żadnych specjalnych właściwości. Zobacz równanie elastyczności solvera Elmer jeśli potrzebujesz przykładu z właściwościami.
</p><p>Wreszcie, należy zarejestrować definicję <b>makeEquationFlow</b> w <code>src/Mod/Fem/ObjectsFem.py</code> poprzez zduplikowanie dostępnego wpisu.
</p><p>FreeCAD korzysta z <b>make</b> do budowania programu. Więc musimy zarejestrować plik nowego modułu (<code>flow.py</code>) w <code>src/Mod/Fem/CMakeLists.txt</code> w sposób opisany na stronie <a class="external text" href="https://www.freecadweb.org/wiki/Extend_FEM_Module/pl" rel="nofollow">Rozszerzenie modułu MES</a>. Odpowiednie listy można łatwo znaleźć szukając plików modułów istniejących równań solvera Elmer.
</p><p><span id="Extend_Solver_Object"></span>
</p>
<h2><span class="mw-headline" id="Rozszerz_obiekt_solvera">Rozszerz obiekt solvera</span></h2>
<p>W tym kroku zmodyfikujemy następujący plik:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/elmer/solver.py</span></li></ul>
<p>Teraz sprawiliśmy, że FreeCAD rozpoznaje nowy typ równania a nawet dodaliśmy polecenie, które wstawia to równanie do obiektu wybranego solvera. Zaimplementowaliśmy też konkretny obiekt równania dla solvera Elmer. Pozostało utworzenie połączenia między solverem Elmer i równaniem przepływu. Należy to zrobić bezpośrednio w obiekcie solvera Elmer.
</p><p>Zarejestruj moduł, w którym właśnie zaimplementowaliśmy obiekt naszego nowego równania (<code>flow.py</code>) z określnikiem równania z kroku 1 ("Flow") na liście <code>_EQUATIONS</code> w <code>elmer/solver.py</code>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">.equations</span> <span class="kn">import</span> <span class="n">electrostatic</span>
<span class="o">+</span><span class="kn">from</span> <span class="nn">.equations</span> <span class="kn">import</span> <span class="n">flow</span>

<span class="o">...</span>

<span class="n">_EQUATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Heat"</span><span class="p">:</span> <span class="n">heat</span><span class="p">,</span>
    <span class="s2">"Elasticity"</span><span class="p">:</span> <span class="n">elasticity</span><span class="p">,</span>
<span class="o">+</span>    <span class="s2">"Flow"</span><span class="p">:</span> <span class="n">flow</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
<p><span id="Extend_writer_object"></span>
</p>
<h2><span id="Rozszerz_obiekt_zapisuj.C4.85cy_r.C3.B3wnania"></span><span class="mw-headline" id="Rozszerz_obiekt_zapisujący_równania">Rozszerz obiekt zapisujący równania</span></h2>
<p>W tym kroku zmodyfikujemy następujący plik:
</p>
<ul><li><span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">src/Mod/Fem/femsolver/elmer/writer.py</span></li></ul>
<p>Ten plik zawiera klasę <code>Writer</code>, która eksportuje analizę do formatu SIF solvera Elmer.
</p><p>Dla każdego wspieranego równania są dwie główne metody eksportu. Po prostu skopiuj je wszystkie z istniejącego równania i dostosuj je do swoich potrzeb.
</p>
<ul><li><code>_getFlowSolver</code></li>
<li><code>_handleFlow</code></li></ul>
<p>Musisz zarejestrować metodę <code>_handleFlow</code> w klasie <code>Writer</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">Writer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handleFlow</span><span class="p">()</span>

<span class="o">...</span>
</pre></div>
<p><code>_handleFlow</code> może kontrolować serię innych złożonych metod. Nasze równanie przepływu korzysta z następujących złożonych metod:
</p>
<ul><li><code>_handleFlowConstants</code></li>
<li><code>_handleFlowMaterial</code></li>
<li><code>_handleFlowInitialVelocity</code></li>
<li><code>_handleFlowBndConditions</code></li>
<li><code>_handleFlowEquation</code></li></ul>
<p>Zakończyliśmy teraz część funkcji nowego równania. Następnie połączymy nowe równanie poprzez GUI.
</p><p><span id="Gui_tool_to_create_an_equation"></span>
</p>
<h2><span id="Narz.C4.99dzie_w_GUI_do_tworzenia_r.C3.B3wnania"></span><span class="mw-headline" id="Narzędzie_w_GUI_do_tworzenia_równania">Narzędzie w GUI do tworzenia równania</span></h2>
<p>Właśnie utworzyliśmy klasę nowego równania. Aby mieć do niej dostęp z GUI środowiska pracy MES, musimy utworzyć przycisk i podłączyć go do klasy nowego równania. Tu znajduje się poradnik: <a href="Add_Button_to_FEM_Toolbar_Tutorial.html" title="Add Button to FEM Toolbar Tutorial/pl">Poradnik: Dodaj przycisk do paska narzędzi MES</a>.
</p>
<!-- 
NewPP limit report
Cached time: 20241129212322
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.063 seconds
Real time usage: 0.236 seconds
Preprocessor visited node count: 353/1000000
Post‐expand include size: 2804/2097152 bytes
Template argument size: 1494/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 4/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 6187/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  162.702      1 -total
 96.76%  157.436      4 Template:Code
  0.82%    1.334     33 Template:Incode
  0.69%    1.124      1 Template:TutorialInfo/pl
  0.41%    0.661      6 Template:FileName
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:258397-0!canonical and timestamp 20241129212322 and revision id 1354352. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
