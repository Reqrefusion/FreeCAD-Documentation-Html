<link href="../site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Create a FeaturePython object part I/pl</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../de\Create_a_FeaturePython_object_part_I.html" lang="de" title="Ein FeaturePython-Objekt erstellen Teil I (32% translated)">Deutsch</a></li>
<li><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../Create_a_FeaturePython_object_part_I.html" lang="en" title="Create a FeaturePython object part I (100% translated)">English</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="../fr\Create_a_FeaturePython_object_part_I.html" lang="fr" title="Créer un objet FeaturePython partie I (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--stub" dir="ltr" href="../it\Create_a_FeaturePython_object_part_I.html" lang="it" title="Oggetti FeaturePython (3% translated)">italiano</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="pl">polski</span></li>
<li><a class="mw-pt-progress mw-pt-progress--low" dir="ltr" href="../ru\Create_a_FeaturePython_object_part_I.html" lang="ru" title="Create a FeaturePython object part I/ru (21% translated)">русский</a></li></ul></div>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
<div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Freecad.svg" width="16"/></span></span></div>
<div style="margin: 4px 0; float: right;"><a href="../pl\Create_a_FeaturePython_object_part_II.html" title="Create a FeaturePython object part II/pl">Tworzenie obiektów FeaturePython część II</a>
<span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Arrow-right.svg" width="16"/></span></span></div>
<div style="text-align:center"><a href="../pl\Online_Help_Toc.html" title="Online Help Toc/pl">Spis treści</a> <span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="24" src="../File/Online_Help_Toc.svg" width="24"/></span></span></div>
</div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Wprowadzenie"><span class="tocnumber">1</span> <span class="toctext">Wprowadzenie</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#How_does_it_work?"><span class="tocnumber">2</span> <span class="toctext">How does it work?</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Konfiguracja"><span class="tocnumber">2.1</span> <span class="toctext">Konfiguracja</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Obiekt_FeaturePython"><span class="tocnumber">3</span> <span class="toctext">Obiekt FeaturePython</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Testowanie_kodu"><span class="tocnumber">3.1</span> <span class="toctext">Testowanie kodu</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Dodanie_właściwości"><span class="tocnumber">3.2</span> <span class="toctext">Dodanie właściwości</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Zdarzenia_związane_z_łapaniem"><span class="tocnumber">3.3</span> <span class="toctext">Zdarzenia związane z łapaniem</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Kompletny_kod"><span class="tocnumber">3.4</span> <span class="toctext">Kompletny kod</span></a></li>
</ul>
</li>
</ul>
</div>
</div>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Wprowadzenie">Wprowadzenie</span></h2>
<p>Obiekty FeaturePython <i>(zwane również <a href="../pl\Scripted_objects.html" title="Scripted objects/pl">obiektami tworzonymi przez skrypty</a>)</i> zapewniają możliwość rozszerzenia FreeCAD o obiekty, które płynnie integrują się z frameworkiem FreeCAD.
</p><p>Zachęca to do:
</p>
<ul><li>Szybkie prototypowanie nowych obiektów i narzędzi za pomocą niestandardowych klas środowiska Pyton.</li>
<li>Zapisywanie i przywracanie danych <i>(znane również jako serializacja)</i> za pomocą obiektów <code>App::Property</code>, bez osadzania jakiegokolwiek skryptu w pliku dokumentu FreeCAD.</li>
<li>Swoboda twórcza umożliwiająca dostosowanie FreeCAD do dowolnego zadania.</li></ul>
<p>Na tej stronie skonstruujemy działający przykład niestandardowej klasy FeaturePython, identyfikując wszystkie główne komponenty i rozumiejąc, jak wszystko działa.
</p>
<h2><span id="How_does_it_work.3F"></span><span class="mw-headline" id="How_does_it_work?">How does it work?</span></h2>
<p>FreeCAD zawiera szereg domyślnych typów obiektów do zarządzania różnymi rodzajami geometrii. Niektóre z nich mają alternatywy "FeaturePython", które pozwalają na dostosowanie za pomocą zdefiniowanej przez użytkownika klasy Python.
</p><p>Ta niestandardowa klasa Python pobiera odniesienie do jednego z tych obiektów i modyfikuje go. Na przykład, klasa Python może dodawać właściwości do obiektu lub łączyć go z innymi obiektami. Ponadto klasa Python może implementować pewne metody, aby umożliwić obiektowi reagowanie na zdarzenia dokumentu, umożliwiając przechwytywanie zmian właściwości obiektu i ponowne obliczanie dokumentu.
</p><p>Podczas pracy z klasami niestandardowymi i obiektami FeaturePython ważne jest, aby wiedzieć, że klasa niestandardowa i jej stan nie są zapisywane w dokumencie, ponieważ wymagałoby to osadzenia skryptu w pliku dokumentu FreeCAD, co stanowiłoby poważne zagrożenie dla bezpieczeństwa. Zapisywany <i>(serializowany)</i> jest tylko sam obiekt FeaturePython. Ale ponieważ ścieżka modułu skryptu jest przechowywana w dokumencie, użytkownik musi tylko zainstalować niestandardowy kod klasy Python jako moduł do zaimportowania, zgodnie z tą samą strukturą folderów, aby odzyskać utraconą funkcjonalność.
</p><p><a href="#top">na początek strony</a>
</p><p><span id="Setting_things_up"></span>
</p>
<h3><span class="mw-headline" id="Konfiguracja">Konfiguracja</span></h3>
<p>Klasy obiektów FeaturePython muszą działać jako moduły importowalne w FreeCAD. Oznacza to, że należy umieścić je w ścieżce, która istnieje w środowisku Python <i>(lub dodać ją specjalnie)</i>. Na potrzeby tego samouczka użyjemy folderu Macro użytkownika FreeCAD. Ale jeśli masz inny pomysł, możesz go użyć zamiast tego.
</p><p>Jeśli nie wiesz, gdzie znajduje się folder FreeCAD Macro, w <a href="../pl\Python_console.html" title="Python console/pl">konsoli Python</a> programu FreeCAD wpisz polecenie <code>FreeCAD.getUserMacroDir(True)</code> :
</p>
<ul><li>W systemie Linux jest to zazwyczaj <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">/home/&lt;nazwa użytkownika&gt;/.local/share/FreeCAD/Macro/</span> <i>(<span style="font-size:small;color:green;">wersja 0.20 i powyżej</span>)</i> lub <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">/home/&lt;username&gt;/.FreeCAD/Macro/</span> <i>(<span style="font-size:small;color:blue;">wersja 0.19 i poniżej</span>)</i>.</li>
<li>Na macOS jest to zazwyczaj <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">/Users/&lt;username&gt;/Library/Application Support/FreeCAD/Macro/</span>.</li>
<li>W systemie Windows jest to <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">%APPDATA%\FreeCAD\Macro\</span>, który zwykle jest <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">C:\Users\&lt;username&gt;\Appdata\Roaming\FreeCAD\Macro\</span>.</li></ul>
<p>Teraz musimy utworzyć kilka folderów i plików:
</p>
<ul><li>W folderze <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">Macro</span> utwórz nowy folder o nazwie <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">fpo</span>.</li>
<li>W folderze <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">fpo</span> utwórz pusty plik: <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">__init__.py</span>.</li>
<li>W folderze <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">fpo</span> utwórz nowy folder o nazwie <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box</span>.</li>
<li>W folderze <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box</span> utwórz dwa pliki: <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">__init__.py</span> i <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> <i>(na razie pozostaw oba puste)</i>.</li></ul>
<p>Struktura folderów powinna wyglądać następująco:
</p>
<pre>Macro/
    |--&gt; fpo/
        |--&gt; __init__.py
        |--&gt; box/
            |--&gt; __init__.py
            |--&gt; box.py
</pre>
<p>Folder <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">fpo</span> zapewnia przyjemne miejsce do zabawy z nowymi obiektami FeaturePython, a folder <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box</span> jest modułem, w którym będziemy pracować. <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">__init__.py</span> informuje środowisko Python, że w folderze znajduje się możliwy do zaimportowania moduł, a <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> będzie plikiem klasy dla naszego nowego obiektu FeaturePython.
</p><p>Po utworzeniu ścieżek modułów i plików, upewnijmy się, że FreeCAD jest poprawnie skonfigurowany:
</p>
<ul><li>Uruchom FreeCAD <i>(jeśli jeszcze tego nie zrobiłeś)</i>.</li>
<li>Włącz <a href="../pl\Report_view.html" title="Report view/pl">Widok raportu</a> <i>(<b>Widok → Panele → Widok raportu</b>)</i>.</li>
<li>Włącz <a href="../pl\Python_console.html" title="Python console/pl">konsole Python</a> <i>(<b>Widok → Panele → Konsola Python</b>)</i> zapoznaj sie z informacjami na stronie  <a href="../pl\FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/pl">Podstawy tworzenia skryptów FreeCAD</a>.</li></ul>
<p>Na koniec przejdź do folderu <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">Macro/fpo/box</span> i otwórz <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> w swoim ulubionym edytorze kodu. Będziemy edytować tylko ten plik.
</p><p><a href="#top">na początek strony</a>
</p><p><span id="A_FeaturePython_object"></span>
</p>
<h2><span class="mw-headline" id="Obiekt_FeaturePython">Obiekt FeaturePython</span></h2>
<p>Zacznijmy od napisania naszej klasy i jej konstruktora:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">box</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Default constructor</span>
<span class="sd">        """</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">'box'</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>
</pre></div>
<p><b>Podział metody <code>__init__()</code>:</b>
</p>
<table cellpadding="5px" class="wikitable" width="100%">
<tbody><tr>
<td style="width:25%"><code>def __init__(self, obj):</code>
</td>
<td style="width:75%">Parametry odnoszą się do samej klasy Python i obiektu FeaturePython, do którego jest ona dołączona.
</td></tr>
<tr>
<td><code>self.Type = 'box'</code>
</td>
<td>Definicja niestandardowego typu Python w postaci ciągu znaków.
</td></tr>
<tr>
<td><code>obj.Proxy = self</code>
</td>
<td>Przechowuje odniesienie do instancji Python w obiekcie FeaturePython.
</td></tr></tbody></table>
<p>Dodaj następujący kod na początku pliku:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>

<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">obj_name</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Object creation method</span>
<span class="sd">    """</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'App::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>

    <span class="n">box</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">obj</span>
</pre></div>
<p><b>Podział metody <code>create()</code>:</b>
</p>
<table cellpadding="5px" class="wikitable" width="100%">
<tbody><tr>
<td style="width:25%"><code>import FreeCAD as App</code>
</td>
<td style="width:75%">Standardowy import dla większości skryptów Python, alias App nie jest wymagany.
</td></tr>
<tr>
<td><code>obj = ... addObject(...)</code>
</td>
<td>Tworzy nowy obiekt FreeCAD FeaturePython o nazwie przekazanej do metody. Jeśli nie ma kolizji nazw, będzie to etykieta i nazwa utworzonego obiektu. W przeciwnym razie zostanie utworzona unikalna nazwa i etykieta na podstawie "obj_name".
</td></tr>
<tr>
<td><code>box(obj)</code>
</td>
<td>Tworzy instancję naszej niestandardowej klasy.
</td></tr>
<tr>
<td><code>return obj</code>
</td>
<td>Zwraca obiekt FeaturePython.
</td></tr></tbody></table>
<p>Metoda <code>create()</code> nie jest wymagana, ale zapewnia przyjemny sposób enkapsulacji kodu tworzenia obiektu.
</p><p><a href="#top">na początek strony</a>
</p><p><span id="Testing_the_code"></span>
</p>
<h3><span class="mw-headline" id="Testowanie_kodu">Testowanie kodu</span></h3>
<p>Teraz możemy przetestować nasz nowy obiekt. Zapisz kod i wróć do FreeCAD. Upewnij się, że otworzyłeś nowy dokument, możesz to zrobić naciskając <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">Ctrl</span> + <span style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px;">N</span> lub wybierając <b>Plik → Nowy</b>.
</p><p>W konsoli Python wpisz następujące polecenie:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">fpo.box</span> <span class="kn">import</span> <span class="n">box</span>
</pre></div>
<p>Teraz musimy stworzyć nasz obiekt:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">mybox</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">'my_box'</span><span class="p">)</span>
</pre></div>
<figure class="mw-default-size mw-halign-right" typeof="mw:File"><a class="mw-file-description" href="../File/Fpo_treeview.png"><img decoding="async" height="180" src="../File/Fpo_treeview.png" width="205"/></a><figcaption></figcaption></figure>
<p>W <a href="../pl\Tree_view.html" title="Tree view/pl">widoku drzewa</a> powinien pojawić się nowy obiekt oznaczony jako "my_box".
</p><p>Zauważ, że ikona jest szara. FreeCAD mówi nam, że obiekt nie jest w stanie wyświetlić niczego w <a href="../pl\3D_view.html" title="3D view/pl">widoku 3D</a>. Kliknij na obiekt i spójrz na jego właściwości w <a href="../pl\Property_editor.html" title="Property editor/pl">Edytorze właściwości</a>. Nie ma tam zbyt wiele, tylko nazwa obiektu.
</p><p>Zwróć też uwagę, że obok obiektu FeaturePython w widoku drzewa znajduje się mały niebieski znacznik wyboru. Dzieje się tak, ponieważ gdy obiekt jest tworzony lub zmieniany, jest "dotykany" i musi zostać ponownie przeliczony. Naciśnięcie przycisku <span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;"><span typeof="mw:File"><a class="mw-file-description" href="../File/Std_Refresh.svg"><img decoding="async" height="16" src="../File/Std_Refresh.svg" width="16"/></a></span> <a href="../pl\Std_Refresh.html" title="Std Refresh/pl">Odśwież</a></span> pozwoli to osiągnąć. Później dodamy trochę kodu, aby to zautomatyzować.
</p>
<div style="clear:both"></div>
<p>Przyjrzyjmy się atrybutom naszego obiektu:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">mybox</span><span class="p">)</span>
</pre></div>
<p>To zwróci:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="p">[</span><span class="s1">'Content'</span><span class="p">,</span> <span class="s1">'Document'</span><span class="p">,</span> <span class="s1">'ExpressionEngine'</span><span class="p">,</span> <span class="s1">'FullName'</span><span class="p">,</span> <span class="s1">'ID'</span><span class="p">,</span> <span class="s1">'InList'</span><span class="p">,</span>
<span class="o">...</span>
<span class="s1">'setPropertyStatus'</span><span class="p">,</span> <span class="s1">'supportedProperties'</span><span class="p">,</span> <span class="s1">'touch'</span><span class="p">]</span>
</pre></div>
<p>Istnieje wiele atrybutów, ponieważ uzyskujemy dostęp do natywnego obiektu FreeCAD FeaturePyton utworzonego w pierwszej linii naszej metody <code>create()</code>. Jest tam również właściwość <code>Proxy</code>, którą dodaliśmy w naszej metodzie <code>__init__()</code>.
</p><p>Sprawdźmy to za pomocą metody <code>dir()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">mybox</span><span class="o">.</span><span class="n">Proxy</span><span class="p">)</span>
</pre></div>
<p>To zwróci:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="p">[</span><span class="s1">'Type'</span><span class="p">,</span> <span class="s1">'__class__'</span><span class="p">,</span> <span class="s1">'__delattr__'</span><span class="p">,</span> <span class="s1">'__dict__'</span><span class="p">,</span> <span class="s1">'__dir__'</span><span class="p">,</span> <span class="s1">'__doc__'</span><span class="p">,</span>
<span class="o">...</span>
<span class="s1">'__str__'</span><span class="p">,</span> <span class="s1">'__subclasshook__'</span><span class="p">,</span> <span class="s1">'__weakref__'</span><span class="p">]</span>
</pre></div>
<p>Możemy zobaczyć naszą właściwość <code>Type</code>. Sprawdźmy ją:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">mybox</span><span class="o">.</span><span class="n">Proxy</span><span class="o">.</span><span class="n">Type</span>
</pre></div>
<p>To zwróci:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="s1">'box'</span>
</pre></div>
<p>Jest to rzeczywiście przypisana wartość, więc wiemy, że uzyskujemy dostęp do klasy niestandardowej za pośrednictwem obiektu FeaturePython.
</p><p>Zobaczmy teraz, czy możemy uczynić naszą klasę nieco bardziej interesującą, a może także bardziej użyteczną.
</p><p><a href="#top">na początek strony</a>
</p><p><span id="Adding_properties"></span>
</p>
<h3><span id="Dodanie_w.C5.82a.C5.9Bciwo.C5.9Bci"></span><span class="mw-headline" id="Dodanie_właściwości">Dodanie właściwości</span></h3>
<p>Właściwości są siłą napędową klasy FeaturePython. Na szczęście FreeCAD obsługuje <a href="../pl\FeaturePython_Custom_Properties.html" title="FeaturePython Custom Properties/pl">wiele typów właściwości</a> dla klas FeaturePython. Właściwości te są dołączane bezpośrednio do obiektu FeaturePython i są w pełni serializowane podczas zapisywania pliku. Aby uniknąć konieczności samodzielnej serializacji danych, zaleca się używanie tylko tych typów właściwości.
</p><p>Dodawanie właściwości odbywa się za pomocą metody <code>add_property()</code>. Składnia tej metody to:
</p>
<pre>add_property(type, name, section, description)
</pre>
<p>Listę obsługiwanych właściwości można wyświetlić, wpisując:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">mybox</span><span class="o">.</span><span class="n">supportedProperties</span><span class="p">()</span>
</pre></div>
<p>Spróbujmy dodać właściwość do naszej klasy box. Przełącz się do edytora kodu, przejdź do metody <code>__init__()</code> i na końcu metody dodaj:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyString'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">,</span> <span class="s1">'Base'</span><span class="p">,</span> <span class="s1">'Box description'</span><span class="p">)</span><span class="o">.</span><span class="n">Description</span> <span class="o">=</span> <span class="s2">""</span>
</pre></div>
<p>Zauważ, że używamy odniesienia do <i>(serializowalnego)</i> obiektu FeaturePython <code>obj</code>, a nie <i>(nieserializowalnej)</i> instancji klasy Python <code>self</code>.
</p><p>Po zakończeniu zapisz zmiany i przełącz się z powrotem do FreeCAD. Zanim będziemy mogli zaobserwować zmiany wprowadzone w naszym kodzie, musimy ponownie załadować moduł. Można to osiągnąć poprzez ponowne uruchomienie FreeCAD, ale ponowne uruchamianie FreeCAD za każdym razem, gdy edytujemy kod, byłoby niewygodne. Aby to ułatwić, wpisz następujące polecenie w konsoli Python:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>
<span class="n">reload</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
</pre></div>
<p>Po przeładowaniu modułu zobaczmy, co otrzymamy po utworzeniu obiektu:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">box</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">'box_property_test'</span><span class="p">)</span>
</pre></div>
<p>W widoku drzewa powinien pojawić się nowy obiekt box:
</p>
<ul><li>Wybierz go i spójrz na edytor właściwości. Tam powinieneś zobaczyć właściwość <i>Description</i>.</li>
<li>Najedź kursorem na nazwę właściwości po lewej stronie, a pojawi się podpowiedź z opisem, który podałeś.</li>
<li>Wybierz pole i wpisz dowolny tekst. Zauważysz, że polecenia aktualizacji Pythona są wykonywane i wyświetlane w konsoli podczas wpisywania liter i zmian właściwości.</li></ul>
<p><a href="#top">na początek strony</a>
</p><p>Dodajmy jeszcze kilka właściwości. Wróć do kodu źródłowego i dodaj następujące właściwości do metody <code>__init__()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box length'</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Width'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box width'</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="s1">'10 mm'</span>
<span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box height'</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="s1">'1 cm'</span>
</pre></div>
<p>Dodajmy też trochę kodu, aby automatycznie przekompilować dokument. Dodajmy następującą linię nad instrukcją <code>return()</code> w metodzie <code>create()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><b>Uważaj, gdzie rekompilujesz obiekt FeaturePython. Ponowne obliczanie powinno być obsługiwane przez metodę zewnętrzną w stosunku do jego klasy.</b>
</p>
<figure class="mw-default-size mw-halign-right" typeof="mw:File"><a class="mw-file-description" href="../File/Fpo_box_properties.png"><img decoding="async" height="198" src="../File/Fpo_box_properties.png" width="260"/></a><figcaption></figcaption></figure>
<p>Teraz przetestuj zmiany w następujący sposób:
</p>
<ul><li>Zapisz zmiany i przeładuj moduł.</li>
<li>Usuń wszystkie obiekty w widoku drzewa.</li>
<li>Utwórz nowy obiekt box z konsoli Python, wywołując <code>box.create('myBox')</code>.</li></ul>
<p>Po utworzeniu pola i sprawdzeniu, czy zostało ono ponownie obliczone, wybierz obiekt i sprawdź jego właściwości. Powinieneś zauważyć dwie rzeczy:
</p>
<ul><li>Nową grupę właściwości: <i>Dimensions</i>.</li>
<li>Trzy nowe właściwości: <i>Height</i>, <i>Length</i> and <i>Width</i>.</li></ul>
<p>Zauważ również, że właściwości mają jednostki. Dokładniej mówiąc, przyjęły one jednostki liniowe ustawione w preferencjach użytkownika (<b>Edycja → Preferencje ... → Ogólne → Jednostki</b>).
</p>
<div style="clear:both"></div>
<p>Bez wątpienia zauważyłeś, że wprowadzono trzy różne wartości dla wymiarów: wartość zmiennoprzecinkową (<code>10.0</code>) i dwa różne ciągi znaków (<code>'10 mm'</code> i <code>'1 cm'</code>). Typ <code>App::PropertyLength</code> zakłada, że wartości zmiennoprzecinkowe są w milimetrach, wartości łańcuchowe są analizowane zgodnie z określonymi jednostkami, a w GUI wszystkie wartości są konwertowane na jednostki określone w preferencjach użytkownika <i>(<code>mm</code> na obrazku)</i>. To wbudowane zachowanie sprawia, że typ <code>App::PropertyLength</code> jest idealny dla wymiarów.
</p><p><a href="#top">na początek strony</a>
</p><p><span id="Trapping_events"></span>
</p>
<h3><span id="Zdarzenia_zwi.C4.85zane_z_.C5.82apaniem"></span><span class="mw-headline" id="Zdarzenia_związane_z_łapaniem">Zdarzenia związane z łapaniem</span></h3>
<p>Ostatnim elementem wymaganym dla podstawowego obiektu FeaturePython jest przechwytywanie zdarzeń. Obiekt FeaturePython może reagować na zdarzenia za pomocą funkcji zwrotnych. W naszym przypadku chcemy, aby obiekt reagował za każdym razem, gdy zostanie ponownie przeliczony. Innymi słowy, chcemy przechwytywać ponowne obliczenia. Aby to osiągnąć, musimy dodać do klasy obiektu funkcję o określonej nazwie <code>execute()</code>. Istnieje kilka innych zdarzeń, które można przechwycić, zarówno w samym obiekcie FeaturePython, jak i w <a href="../pl\Viewprovider.html" title="Viewprovider/pl">Dostawcay widoku
</a>, które omówimy w poradniku <a href="../pl\Create_a_FeaturePython_object_part_II.html" title="Create a FeaturePython object part II/pl">Tworzenie obiektów FeaturePython - część II</a>.
</p><p>Aby uzyskać pełną listę metod dostępnych do zaimplementowania w klasach FeautrePython, zapoznaj sie z informacjami na stronie <a href="../pl\FeaturePython_methods.html" title="FeaturePython methods/pl">Metody FeaturePython</a>.
</p><p>Dodaj następujące elementy po funkcji <code>__init__()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Called on document recompute</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Recomputing </span><span class="si">{0:s}</span><span class="s1"> (</span><span class="si">{1:s}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">))</span>
</pre></div>
<p>Przetestuj kod, ponownie wykonując następujące kroki:
</p>
<ul><li>Zapisz i ponownie załaduj moduł.</li>
<li>Usuń wszystkie obiekty.</li>
<li>Utwórz nowy obiekt box.</li></ul>
<p>Powinieneś zobaczyć wyniki drukowania w konsoli Python, dzięki wywołaniu <code>recompute()</code>, które dodaliśmy do metody <code>create()</code>. Oczywiście metoda <code>execute()</code> nie robi tutaj nic poza poinformowaniem nas, że została wywołana, ale jest ona kluczem do magii obiektów FeaturePython.
</p><p>To wszystko, wiesz już jak zbudować podstawowy, funkcjonalny obiekt FeaturePython!
</p><p><a href="#top">na początek strony</a>
</p><p><span id="Complete_code"></span>
</p>
<h3><span class="mw-headline" id="Kompletny_kod">Kompletny kod</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>

<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">obj_name</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Object creation method</span>
<span class="sd">    """</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'App::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>

    <span class="n">box</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">obj</span>

<span class="k">class</span> <span class="nc">box</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Default constructor</span>
<span class="sd">        """</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">'box'</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyString'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">,</span> <span class="s1">'Base'</span><span class="p">,</span> <span class="s1">'Box description'</span><span class="p">)</span><span class="o">.</span><span class="n">Description</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box length'</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Width'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box width'</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="s1">'10 mm'</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box height'</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="s1">'1 cm'</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Called on document recompute</span>
<span class="sd">        """</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">'Recomputing </span><span class="si">{0:s}</span><span class="s1"> (</span><span class="si">{1:s}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">))</span>
</pre></div>
<p><a href="#top">na początek strony</a>
</p>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
<div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Freecad.svg" width="16"/></span></span></div>
<div style="margin: 4px 0; float: right;"><a href="../pl\Create_a_FeaturePython_object_part_II.html" title="Create a FeaturePython object part II/pl">Tworzenie obiektów FeaturePython część II</a>
<span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="16" src="../File/Arrow-right.svg" width="16"/></span></span></div>
<div style="text-align:center"><a href="../pl\Online_Help_Toc.html" title="Online Help Toc/pl">Spis treści</a> <span class="mw-default-size" typeof="mw:File"><span><img decoding="async" height="24" src="../File/Online_Help_Toc.svg" width="24"/></span></span></div>
</div>
<p><br/>
</p>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
<div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><a href="../pl\Power_users_hub.html" title="Power users hub/pl">Centrum Power użytkowników</a> <span typeof="mw:File"><a class="mw-file-description" href="../File/Power_user_hub.png"><img decoding="async" height="24" src="../File/Power_user_hub.png" width="24"/></a></span>
<div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>Tworzenie skryptów FreeCAD:</b> <a href="../pl\Python.html" title="Python/pl">Python</a>, <a href="../pl\Introduction_to_Python.html" title="Introduction to Python/pl">Wprowadzenie do środowiska Python</a>, <a href="../pl\Python_scripting_tutorial.html" title="Python scripting tutorial/pl">Poradnik: Tworzenie skryptów Python</a>, <a href="../pl\FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/pl">Podstawy tworzenia skryptów FreeCAD</a></li></ul>
<hr/>
<ul><li><b>Moduły:</b> <a href="../pl\Builtin_modules.html" title="Builtin modules/pl">Moduły wbudowane</a>, <a href="../pl\Units.html" title="Units/pl">Jednostki miar</a>, <a href="../Quantity.html" title="Quantity">Ilość</a></li>
<li><b>Środowiska pracy:</b> <a href="../pl\Workbench_creation.html" title="Workbench creation/pl">Tworzenie Środowiska pracy</a>, <a href="../pl\Gui_Command.html" title="Gui Command/pl">Polecenia Gui</a>, <a href="../Command.html" title="Command">Polecenia</a>, <a href="../pl\Installing_more_workbenches.html" title="Installing more workbenches/pl">Instalacja większej liczby Środowisk pracy</a></li>
<li><b>Siatki i elementy:</b> <a href="../pl\Mesh_Scripting.html" title="Mesh Scripting/pl">Skrytpy w Środowisku Siatek</a>, <a href="../pl\Topological_data_scripting.html" title="Topological data scripting/pl">v</a>, <a href="../pl\Mesh_to_Part.html" title="Mesh to Part/pl">Konwerska Mesh na Part</a>, <a href="../pl\PythonOCC.html" title="PythonOCC/pl">PythonOCC</a></li></ul>
<hr/>
<ul><li><b>Obiekty parametryczne:</b> <a href="../pl\Scripted_objects.html" title="Scripted objects/pl">Obiekty tworzone skryptami</a>, <a href="../Viewprovider.html" title="Viewprovider">Obsługa obrazu</a> <small>(<a href="../Custom_icon_in_tree_view.html" title="Custom icon in tree view">Ikonka niestandardowa w widoku drzewa</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../pl\Scenegraph.html" title="Scenegraph/pl">Coin (Inventor) scenegraph</a>, <a href="../pl\Pivy.html" title="Pivy/pl">Pivy</a></li>
<li><b>Interfejs graficzny:</b> <a href="../Interface_creation.html" title="Interface creation">Stworzenie interfejsu</a>, <a href="../pl\Dialog_creation.html" title="Dialog creation/pl">Kompletne stworzenie interfejsu w środowisku Python</a> <small>(<a href="../Dialog_creation_with_various_widgets.html" title="Dialog creation with various widgets">1</a>, <a href="../Dialog_creation_reading_and_writing_files.html" title="Dialog creation reading and writing files">2</a>, <a href="../Dialog_creation_setting_colors.html" title="Dialog creation setting colors">3</a>, <a href="../Dialog_creation_image_and_animated_GIF.html" title="Dialog creation image and animated GIF">4</a>, <a href="../PySide_usage_snippets.html" title="PySide usage snippets">5</a>)</small>, <a href="../pl\PySide.html" title="PySide/pl">PySide</a>, PySide examples <a href="../PySide_Beginner_Examples.html" title="PySide Beginner Examples">początkujący</a>, <a href="../PySide_Intermediate_Examples.html" title="PySide Intermediate Examples">średniozaawansowany</a>, <a href="../PySide_Advanced_Examples.html" title="PySide Advanced Examples">zaawansowany</a></li>
<li><b>Makrodefinicje:</b> <a href="../pl\Macros.html" title="Macros/pl">Makrodefinicje</a>, <a href="../pl\How_to_install_macros.html" title="How to install macros/pl">Instalacja makrodefinicji</a></li>
<li><b>Osadzanie programu:</b> <a href="../pl\Embedding_FreeCAD.html" title="Embedding FreeCAD/pl">Osadzanie programu FreeCAD</a>, <a href="../pl\Embedding_FreeCADGui.html" title="Embedding FreeCADGui/pl">Osadzanie GUI FreeCAD</a></li></ul>
<hr/>
<ul><li><b>Pozostałe:</b> <a href="../pl\Expressions.html" title="Expressions/pl">Wyrażenia</a>, <a href="../pl\Code_snippets.html" title="Code snippets/pl">Wycinki kodu</a>, <a href="../pl\Line_drawing_function.html" title="Line drawing function/pl">Funkcja kreślenia linii</a>, <a href="../pl\FreeCAD_vector_math_library.html" title="FreeCAD vector math library/pl">Biblioteka matematyczna FreeCAD dla wektorów</a> <small>(deprecated)</small></li></ul>
<hr/>
<ul><li><b>Węzły użytkowników:</b> <a href="../pl\User_hub.html" title="User hub/pl">Centrum użytkownika</a>, <a href="../pl\Power_users_hub.html" title="Power users hub/pl">Centrum Power użytkowników</a>, <a href="../pl\Developer_hub.html" title="Developer hub/pl">Centrum programisty</a></li></ul></div>
</div></div>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241214202717
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.124 seconds
Real time usage: 1.393 seconds
Preprocessor visited node count: 796/1000000
Post‐expand include size: 14204/2097152 bytes
Template argument size: 6027/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 18/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 16108/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 1280.474      1 -total
 98.02% 1255.060     18 Template:Code
  0.27%    3.431      1 Template:Powerdocnavi/pl
  0.25%    3.196      2 Template:Docnav/pl
  0.21%    2.709     20 Template:FileName
  0.21%    2.651      1 Template:VersionPlus/pl
  0.20%    2.542     36 Template:Incode
  0.10%    1.294      1 Template:TOCright
  0.07%    0.888      2 Template:KEY
  0.07%    0.885      1 Template:VersionMinus/pl
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:239645-0!canonical and timestamp 20241214202716 and revision id 1417937. Rendering was triggered because: api-parse
 -->
</div></div><script src="../script.js"></script>
