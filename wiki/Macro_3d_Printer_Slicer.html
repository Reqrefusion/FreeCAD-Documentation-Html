<link href="site.css" rel="stylesheet" type="text/css"/>
<div class="mw-page-container"><h1 class="firstHeading mw-first-heading" id="firstHeading"><span class="mw-page-title-main">Macro 3d Printer Slicer</span></h1><div class="mw-parser-output"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="de\Macro_3d_Printer_Slicer.html" lang="de" title="Macro 3d Printer Slicer (100% translated)">Deutsch</a></li>
<li><span class="mw-pt-languages-ui mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" dir="ltr" lang="en">English</span></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="fr\Macro_3d_Printer_Slicer.html" lang="fr" title="Macro 3d Printer Slicer (100% translated)">français</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="it\Macro_3d_Printer_Slicer.html" lang="it" title="Macro Slicer per stampanti 3D (100% translated)">italiano</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="pl\Macro_3d_Printer_Slicer.html" lang="pl" title="Makrodefinicja: Slicer druku 3D (100% translated)">polski</a></li>
<li><a class="mw-pt-progress mw-pt-progress--complete" dir="ltr" href="cs\Macro_3d_Printer_Slicer.html" lang="cs" title="Macro 3d Printer Slicer (86% translated)">čeština</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="float: right; width: 230px; margin-left: 10px;" width="100%">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a class="mw-file-description" href="File/Macro_3d_Printer_Slicer.png"><img decoding="async" height="32" src="File/Macro_3d_Printer_Slicer.png" width="32"/></a></span><span> </span>
Macro_3d_Printer_Slicer
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Export to slicing software for 3D printers. Exports stl file in the same directory as original design file, then opens it in slicing software.<br/>This code, when run, will export the currently open design to STL file, and open it in the slicing software that you use. This example is for <b><a class="external text" href="http://kisslicer.com/" rel="nofollow">KISSlicer</a></b>, but can be modified to use <b><a class="external text" href="http://slic3r.org/" rel="nofollow">Slic3r</a></b>, <b><a class="external text" href="http://wiki.ultimaker.com/Cura" rel="nofollow">Cura</a></b>, or any other 3d printer software. It can also be modified slightly to open up CAM software for CNC machines.<br/><br/>Macro version: 1.0<br/>Last modified: 2013-10-10<br/>FreeCAD version: All<br/>Download: <a class="external text" href="https://www.freecadweb.org/wiki/images/9/96/Macro_3d_Printer_Slicer.png" rel="nofollow">ToolBar Icon</a><br/>Author: cae2100<br/>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a class="new" href="index.php?title=User;Cae2100&amp;action=edit&amp;redlink=1.html" title="User:Cae2100 (page does not exist)">cae2100</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a class="external text" href="https://www.freecadweb.org/wiki/images/9/96/Macro_3d_Printer_Slicer.png" rel="nofollow">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes">Macros recipes</a><br/><a href="How_to_install_macros.html" title="How to install macros">How to install macros</a><br/><a href="Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2013-10-10
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><a href="Macro_3d_Printer_Slicer_Individual_Parts.html" title="Macro 3d Printer Slicer Individual Parts">Macro 3d Printer Slicer Individual Parts</a> <span typeof="mw:File"><a class="mw-file-description" href="File/Macro_3d_Printer_Slicer_Individual_Parts.svg"><img decoding="async" height="24" src="File/Macro_3d_Printer_Slicer_Individual_Parts.svg" width="24"/></a></span>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br/><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Script"><span class="tocnumber">2</span> <span class="toctext">Script</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Credits"><span class="tocnumber">3</span> <span class="toctext">Credits</span></a></li>
</ul>
</div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>This code, when run, will export the currently open design to STL file, and open it in the slicing software that you use. This example is for <b><a class="external text" href="http://kisslicer.com/" rel="nofollow">KISSlicer</a></b>, but can be modified to use <b><a class="external text" href="http://slic3r.org/" rel="nofollow">Slic3r</a></b>, <b><a class="external text" href="http://wiki.ultimaker.com/Cura" rel="nofollow">Cura</a></b>, or any other 3d printer software. It can also be modified slightly to open up CAM software for CNC machines. 
</p><p>It is best used by creating a link to the macro on the toolbar, and when your ready to slice the object, just click it and your object, as it appears on the screen in FreeCAD will appear on your slicing software's interface, ready to slice. It will also create an STL file with the same filename as the design file in the same directory as the design file as a backup.
</p><p><span typeof="mw:File"><a class="mw-file-description" href="File/Macro_3d_Printer_Slicer_00.png"><img decoding="async" height="303" src="File/Macro_3d_Printer_Slicer_00.png" width="480"/></a></span>
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>The SLICER variable can be changed to any slicing software of your choosing, just make sure to set it before you try running it or it'll flag an error with the script.
</p><p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a class="mw-file-description" href="File/Macro_3d_Printer_Slicer.png"><img decoding="async" height="64" src="File/Macro_3d_Printer_Slicer.png" width="64"/></a></span>
</p><p><b>Macro_3d_Printer_Slicer.py</b>
</p>
<pre>import FreeCAD
import Mesh
import sys
import math
import os
import subprocess
# some fuctions
def getPlacement(quat,vect,obj):
  if quat[3] &gt; -1  and quat[3] &lt; 1:
    delta = math.acos(quat[3])*2.0
    scale = math.sin(delta/2)
    rx = quat[0]/scale
    ry = quat[1]/scale
    rz = quat[2]/scale
  else:
    delta = 0
    rx = 0
    ry = 0
    rz = 1
  info0 = "translation "+str(vect.x)+" "+str(vect.y)+" "+str(vect.z)
  info1 = "rotation "+str(rx)+" "+str(ry)+" "+str(rz)+" "+str(delta)
  return info0+" "+info1
# some definitions
placement = App.Placement(App.Vector(0,0,0),App.Rotation(0,0,0,1))
# user need to set this directory where slicing software is located
OutDir = FreeCAD.ActiveDocument.FileName.replace(FreeCAD.ActiveDocument.Label + ".fcstd", "")
visible_objs = []
SLICER = "/kisslicer location/"                          # Put your Slicer program location here
os.chdir(SLICER)
# Get Objects in document
doc = App.ActiveDocument
objs = doc.Objects
# hide all
for obj in objs:
   if obj.ViewObject.isVisible():
      visible_objs.append(obj)
for obj in visible_objs:
  # get volume
  volume = obj.Shape.Volume
  # get Rotation and translation of volume
  quat = obj.Placement.Rotation.Q
  vect = obj.Placement.Base
  pinfo = getPlacement(quat,vect,obj)
  # reset placement, export it and set at original placement
  oldPlacement = obj.Placement
  obj.Placement = placement
  obj.Placement = oldPlacement   
stlFile = OutDir+str(doc.Label)+".stl"
Mesh.export(visible_objs,stlFile)
subprocess.Popen([SLICER + "KISSlicer", stlFile])</pre>
<h2><span class="mw-headline" id="Credits">Credits</span></h2>
<p>Thanks to <a class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686" rel="nofollow">Wmayer</a> for his help in writing this script.<br/>
Original forum topic: <a class="external free" href="http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686" rel="nofollow">http://forum.freecadweb.org/viewtopic.php?f=10&amp;t=4686</a>
</p>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20241214202739
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc, no‐toc‐conversion]
CPU time usage: 0.047 seconds
Real time usage: 0.054 seconds
Preprocessor visited node count: 98/1000000
Post‐expand include size: 2623/2097152 bytes
Template argument size: 2646/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2763/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.324      1 -total
 50.24%    1.670      1 Template:Macro
 29.00%    0.964      1 Template:MacroCode
 16.60%    0.552      1 Template:Clear
-->
<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:11023-0!canonical and timestamp 20241214202739 and revision id 790944. Rendering was triggered because: api-parse
 -->
</div></div><script src="script.js"></script>
